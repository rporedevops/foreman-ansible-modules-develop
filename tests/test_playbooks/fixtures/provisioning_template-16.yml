interactions:
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/status
  response:
    body:
      string: '{"satellite_version":"6.16.0","result":"ok","status":200,"version":"3.12.0-develop","api_version":2}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '100'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=100
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates?per_page=4294967296
  response:
    body:
      string: "{\n  \"total\": 107,\n  \"subtotal\": 107,\n  \"page\": 1,\n  \"per_page\":
        4294967296,\n  \"search\": null,\n  \"sort\": {\n    \"by\": null,\n    \"order\":
        null\n  },\n  \"results\": [{\"snippet\":false,\"description\":null,\"created_at\":\"2024-07-03
        15:24:03 UTC\",\"updated_at\":\"2024-07-03 15:24:03 UTC\",\"id\":257,\"name\":\"A
        second provisioning template\",\"template_kind_id\":8,\"template_kind_name\":\"finish\"},{\"snippet\":false,\"description\":\"This
        template is used to pass command line options to kexec when reloading\\nkernel
        on a discovered host instead of rebooting. This is useful in PXE-less\\nenvironments.
        The template must generate JSON format with the following items\\n\\\"kernel\\\",
        \\\"initram\\\", \\\"append\\\" and \\\"extra\\\". The kexec command is composed
        in\\nthe following way:\\n\\nkexec --force --debug --append=$append --initrd=$initram
        $extra $kernel\\n\\nPlease read kexec(8) man page for more information about
        semantics.\\nExtra options like --reset-vga can be set via \\\"extra\\\" array.\",\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:40 UTC\",\"id\":37,\"name\":\"Discovery
        Red Hat kexec\",\"template_kind_id\":15,\"template_kind_name\":\"kexec\"},{\"snippet\":false,\"description\":\"This
        template is used to pass command line options to kexec when reloading\\nkernel
        on a discovered host instead of rebooting. This is useful in PXE-less\\nenvironments.
        The template must generate JSON format with the following items\\n\\\"kernel\\\",
        \\\"initram\\\", \\\"append\\\" and \\\"extra\\\". The kexec command is composed
        in\\nthe following way:\\n\\nkexec --force --debug --append=$append --initrd=$initram
        $extra $kernel\\n\\nPlease read kexec(8) man page for more information about
        semantics.\\nExtra options like --reset-vga can be set via \\\"extra\\\" array.\",\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:40 UTC\",\"id\":38,\"name\":\"Discovery
        Ubuntu kexec Autoinstall\",\"template_kind_id\":15,\"template_kind_name\":\"kexec\"},{\"snippet\":true,\"description\":\"Binds
        encrypted root directory ('/') utilizing Clevis to Tang server(s) for\\ndecryption.
        The first parent device containing a LUKS container will be used.\\nThe temporary
        passphrase will be removed afterwards. Currently, only Red Hat\\nfamily and
        Ubuntu operating systems are supported.\",\"created_at\":\"2024-06-27 17:28:08
        UTC\",\"updated_at\":\"2024-07-03 14:59:40 UTC\",\"id\":76,\"name\":\"disk_enc_clevis_tang\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":true,\"description\":\"Most
        EFI system firmware implementations put new items to the top of the boot priority
        list. Foreman workflow assumes that managed nodes always boot from network.
        This snippet can be included from provisioning templates and when \\\"efi_bootentry\\\"
        host param is set to \\\"previous\\\" it will attempt to find previous boot
        entry (network) and put it back into first position.\",\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:40 UTC\",\"id\":77,\"name\":\"efibootmgr_netboot\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":true,\"description\":\"This
        template will eject DVD/CD ROM for bootdisk provisioning method,\\ntypically
        called in the final phase of the main provisioning template,\\nsuch as %post
        section of Kickstart or Preseed Finish.\",\"created_at\":\"2024-06-27 17:28:08
        UTC\",\"updated_at\":\"2024-07-03 14:59:40 UTC\",\"id\":78,\"name\":\"eject_cdrom\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":true,\"description\":\"Installs
        the epel RPM from the official online EPEL repository. Supports\\nusing the
        http proxy through host parameters.\",\"created_at\":\"2024-06-27 17:28:08
        UTC\",\"updated_at\":\"2024-07-03 14:59:40 UTC\",\"id\":79,\"name\":\"epel\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":true,\"description\":\"Used
        to adjusts packages in Kickstart template on FIPS enabled OS.\",\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:40 UTC\",\"id\":80,\"name\":\"fips_packages\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":true,\"description\":\"Used
        in user_data templates for setting the correct content of the /etc/hosts file.\\nThe
        goal is to potentially fix incorrect hosts file that is baked in the image\\nused
        for the provisioning.\",\"created_at\":\"2024-06-27 17:28:08 UTC\",\"updated_at\":\"2024-07-03
        14:59:40 UTC\",\"id\":81,\"name\":\"fix_hosts\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":false,\"description\":\"A
        finish template executed at the end of network provisioning or\\nafter the
        image based provisioning is done using the image without user data.\\nIt is
        only used for FreeBSD with mfsBSD toolset.\\nIt supports deploying puppet
        and salt agents.\",\"created_at\":\"2024-06-27 17:28:08 UTC\",\"updated_at\":\"2024-07-03
        14:59:40 UTC\",\"id\":40,\"name\":\"FreeBSD (mfsBSD) finish\",\"template_kind_id\":8,\"template_kind_name\":\"finish\"},{\"snippet\":false,\"description\":\"Provisioning
        template for the FreeBSD.\\nIt prepares the environment and deploys and runs
        the Finish template.\\nSee FreeBSD (mfsbsd) finish template for more details.\",\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:40 UTC\",\"id\":61,\"name\":\"FreeBSD
        (mfsBSD) provision\",\"template_kind_id\":7,\"template_kind_name\":\"provision\"},{\"snippet\":false,\"description\":\"The
        template to render PXELinux bootloader configuration for FreeBSD.\\nThe output
        is deployed on the host's subnet TFTP proxy.\",\"created_at\":\"2024-06-27
        17:28:07 UTC\",\"updated_at\":\"2024-07-03 14:59:41 UTC\",\"id\":16,\"name\":\"FreeBSD
        (mfsBSD) PXELinux\",\"template_kind_id\":3,\"template_kind_name\":\"PXELinux\"},{\"snippet\":true,\"description\":\"Installs
        IPA client and enrolls the host in IPA realm using the OTP\\nOptional parameters:\\n
        \ freeipa_server              IPA server\\n  freeipa_sudo                Enable
        sudoers\\n  freeipa_ssh                 Enable ssh integration\\n                              Default:
        true\\n  freeipa_automount           Enable automounter\\n                              Default:
        false\\n  freeipa_automount_location  Location for automounts\\n  freeipa_mkhomedir
        \          Enable automatically making home directories\\n                              Default:
        true\\n  freeipa_opts                Additional options to pass directly to
        installer\\n  freeipa_automount_server    Override automount server if freeipa_automount
        is true and the server differs from freeipa_server\",\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:41 UTC\",\"id\":82,\"name\":\"freeipa_register\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":false,\"description\":\"The
        registration template used to render OS agnostic script that any host can
        use to register to\\nthis Foreman instance. It is rendered as a response in
        the registration API endpoint. The resulting\\nscript contains instructions
        to prepare the machine for registration, to create a new Host record in Foreman,\\nand
        to fetch and run the host specific initial configuration script. The initial
        script is rendered based\\non the template of host_init_config kind.\",\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:41 UTC\",\"id\":70,\"name\":\"Global
        Registration\",\"template_kind_id\":14,\"template_kind_name\":\"registration\"},{\"snippet\":false,\"description\":\"Script
        that can be manually downloaded to a server to reprovision it without booting
        from network.\\nGrubby compatibility package must be installed. WARNING: It
        will immediately reconfigure\\nbootloader and reprovision the node.\\n\\nUsage:\\ncurl
        https://foreman/unattended/script -o reprovision.sh\\nbash reprovision.sh\\nreboot\",\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:41 UTC\",\"id\":72,\"name\":\"Grubby
        default\",\"template_kind_id\":9,\"template_kind_name\":\"script\"},{\"snippet\":true,\"description\":\"Configures
        common HTTP proxy ENV variables based on the host_proxy\\nhost parameter.
        Currently not used by any shipped template.\",\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:41 UTC\",\"id\":83,\"name\":\"http_proxy\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":true,\"description\":\"Installs
        and registers the insights client on RHEL, typically used\\nin the Kickstart
        provisioning and host init templates.\",\"created_at\":\"2024-06-27 17:28:08
        UTC\",\"updated_at\":\"2024-07-03 14:59:41 UTC\",\"id\":84,\"name\":\"insights\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":false,\"description\":\"The
        template to render iPXE bootloader configuration for provisioned hosts,\\nthat
        still boot from the network.\\nHosts are instructed to boot from the first
        local medium.\\nDo not associate or change the name.\",\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:41 UTC\",\"id\":49,\"name\":\"iPXE
        default local boot\",\"template_kind_id\":6,\"template_kind_name\":\"iPXE\"},{\"snippet\":false,\"description\":\"The
        template to render iPXE bootloader configuration for unknown hosts.\\nThe
        output is used for unknown hosts (typically discovery flow) and it\\nis not
        deployed to the TFTP proxy (unlike other default templates).\\nDo not associate
        or change the name.\",\"created_at\":\"2024-06-27 17:28:08 UTC\",\"updated_at\":\"2024-07-03
        14:59:41 UTC\",\"id\":50,\"name\":\"iPXE global default\",\"template_kind_id\":6,\"template_kind_name\":\"iPXE\"},{\"snippet\":false,\"description\":\"This
        template is returned when ?bootstrap=1 URL parameter is provided.\\nIt is
        used in pure iPXE environment and it's purpose is to perform another iPXE
        template call,\\nbut with MAC address(es) of the server in order to find appropriate
        host record in the inventory.\\nSee https://docs.theforeman.org/nightly/Provisioning_Guide/index-foreman-el.html#Configuring_Networking-Configuring_gPXE_to_Reduce_Provisioning_Times\",\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:41 UTC\",\"id\":51,\"name\":\"iPXE
        intermediate script\",\"template_kind_id\":6,\"template_kind_name\":\"iPXE\"},{\"snippet\":false,\"description\":\"Provisioning
        template for the Solaris installer\",\"created_at\":\"2024-06-27 17:28:08
        UTC\",\"updated_at\":\"2024-07-03 14:59:41 UTC\",\"id\":62,\"name\":\"Jumpstart
        default\",\"template_kind_id\":7,\"template_kind_name\":\"provision\"},{\"snippet\":false,\"description\":\"A
        finish template executed at the end of a network provisioning or\\nafter the
        image based provisioning is done using the image without user data.\\nIt is
        only used for Solaris.\",\"created_at\":\"2024-06-27 17:28:08 UTC\",\"updated_at\":\"2024-07-03
        14:59:41 UTC\",\"id\":41,\"name\":\"Jumpstart default finish\",\"template_kind_id\":8,\"template_kind_name\":\"finish\"},{\"snippet\":false,\"description\":\"The
        template to render Grub bootloader configuration for Solaris.\\nThe output
        is deployed on the host's subnet TFTP proxy.\\nThis template is for legacy
        Grub 1.x, you are probably looking for Grub2.\",\"created_at\":\"2024-06-27
        17:28:07 UTC\",\"updated_at\":\"2024-07-03 14:59:41 UTC\",\"id\":3,\"name\":\"Jumpstart
        default PXEGrub\",\"template_kind_id\":4,\"template_kind_name\":\"PXEGrub\"},{\"snippet\":false,\"description\":\"Generates
        a Junos OS configuration file. That can be used by Autoinstallation on Juniper\\nnetwork
        devices. For more information, see https://projects.theforeman.org/issues/3906\",\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:41 UTC\",\"id\":42,\"name\":\"Junos
        default finish\",\"template_kind_id\":8,\"template_kind_name\":\"finish\"},{\"snippet\":false,\"description\":\"Provisioning
        template for the Junos OS, used on Juniper network devices.\\nIt fetches the
        config file based on the Juniper Finish template and deploys\\nit if it differs
        from the current version.\",\"created_at\":\"2024-06-27 17:28:08 UTC\",\"updated_at\":\"2024-07-03
        14:59:41 UTC\",\"id\":63,\"name\":\"Junos default SLAX\",\"template_kind_id\":7,\"template_kind_name\":\"provision\"},{\"snippet\":false,\"description\":\"Generates
        a Junos OS configuration file. That can be used by ZTP on Juniper\\nnetwork
        devices. For more information, see https://projects.theforeman.org/issues/3906\",\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:41 UTC\",\"id\":30,\"name\":\"Junos
        default ZTP config\",\"template_kind_id\":11,\"template_kind_name\":\"ZTP\"},{\"snippet\":false,\"description\":\"The
        provisioning template for kickstart based distributions. The output is fetched
        by Anaconda installer during\\nthe network based installation. To customize
        the installation, modify the host parameters.\\n\\nThis template accepts the
        following parameters:\\n- lang: string (default=\\\"en_US.UTF-8\\\")\\n- selinux-mode:
        string (default=\\\"enforcing\\\")\\n- keyboard: string (default=\\\"us\\\")\\n-
        time-zone: string (default=\\\"UTC\\\")\\n- http-proxy: string (default=\\\"\\\")\\n-
        http-proxy-port: string (default=\\\"\\\")\\n- force-puppet: boolean (default=false)\\n-
        enable-epel: boolean (default=false)\\n- enable-puppetlabs-repo: boolean (default=false)\\n-
        enable-puppetlabs-puppet5-repo: boolean (default=false)\\n- enable-puppetlabs-puppet6-repo:
        boolean (default=false)\\n- enable-official-puppet7-repo: boolean (default=false)\\n-
        enable-official-puppet8-repo: boolean (default=false)\\n- skip-puppet-setup:
        boolean (default=false)\\n- salt_master: string (default=undef)\\n- ntp-server:
        string (default=undef)\\n- bootloader-append: string (default=\\\"nofb quiet
        splash=quiet\\\")\\n- disable-firewall: boolean (default=false)\\n- package_upgrade:
        boolean (default=true)\\n- disable-uek: boolean (default=false)\\n- use-ntp:
        boolean (default depends on OS release)\\n- fips_enabled: boolean (default=false)\\n-
        encrypt_grub: boolean (default=false)\\n- use_graphical_installer: boolean
        (default=false)\\n- enable-remote-execution-pull: boolean (default=false)\\n-
        additional-packages: string (default=undef)\\n\\nReference links:\\n- https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/installation_guide/s1-kickstart2-options\\n-
        https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/installation_guide/sect-kickstart-syntax\\n-
        https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/performing_an_advanced_rhel_installation/kickstart-commands-and-options-reference_installing-rhel-as-an-experienced-user\",\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:41 UTC\",\"id\":64,\"name\":\"Kickstart
        default\",\"template_kind_id\":7,\"template_kind_name\":\"provision\"},{\"snippet\":false,\"description\":\"A
        finish template executed at the end of the image based provisioning\\nusing
        the image without user data. Foreman connects to the VM over SSH\\nand runs
        the script rendered from this template. It is meant to be run\\non RPM based
        distributons.\\n\\nThis template accepts the following parameters:\\n- bootloader-append:
        string (default=\\\"nofb quiet splash=quiet\\\")\\n- force-puppet: boolean
        (default=false)\\n- skip-puppet-setup: boolean (default=false)\\n- use-ntp:
        boolean (default depends on OS release)\\n- ntp-server: string (default=undef)\\n-
        package_upgrade: boolean (default=true)\\n- salt_master: string (default=undef)\\n-
        enable-remote-execution-pull: boolean (default=false)\",\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:41 UTC\",\"id\":43,\"name\":\"Kickstart
        default finish\",\"template_kind_id\":8,\"template_kind_name\":\"finish\"},{\"snippet\":false,\"description\":\"The
        template to render iPXE installation script for kickstart based distributions\\nThe
        output is deployed on the host's subnet TFTP proxy.\\nSee https://ipxe.org/scripting
        for more details\",\"created_at\":\"2024-06-27 17:28:08 UTC\",\"updated_at\":\"2024-07-03
        14:59:41 UTC\",\"id\":52,\"name\":\"Kickstart default iPXE\",\"template_kind_id\":6,\"template_kind_name\":\"iPXE\"},{\"snippet\":false,\"description\":\"The
        template to render Grub bootloader configuration for kickstart based distributions.\\nThe
        output is deployed on the host's subnet TFTP proxy.\\nThis template is for
        legacy Grub 1.x, you are probably looking for Grub2.\",\"created_at\":\"2024-06-27
        17:28:07 UTC\",\"updated_at\":\"2024-07-03 14:59:41 UTC\",\"id\":4,\"name\":\"Kickstart
        default PXEGrub\",\"template_kind_id\":4,\"template_kind_name\":\"PXEGrub\"},{\"snippet\":false,\"description\":\"The
        template to render Grub2 bootloader configuration for kickstart based distributions.\\nThe
        output is deployed on the host's subnet TFTP proxy.\",\"created_at\":\"2024-06-27
        17:28:07 UTC\",\"updated_at\":\"2024-07-03 14:59:41 UTC\",\"id\":8,\"name\":\"Kickstart
        default PXEGrub2\",\"template_kind_id\":5,\"template_kind_name\":\"PXEGrub2\"},{\"snippet\":false,\"description\":\"The
        template to render PXELinux bootloader configuration for kickstart based distributions.\\nThe
        output is deployed on the host's subnet TFTP proxy.\",\"created_at\":\"2024-06-27
        17:28:07 UTC\",\"updated_at\":\"2024-07-03 14:59:41 UTC\",\"id\":17,\"name\":\"Kickstart
        default PXELinux\",\"template_kind_id\":3,\"template_kind_name\":\"PXELinux\"},{\"snippet\":false,\"description\":\"This
        template is used during image based provisioning, when the image is configured
        to use user-data.\\nThe output is a shell script that cloud-init runs to configures
        the VM\\nbooted from the image. The image must have cloud-init installed in
        order for this to work.\\nThis script can be used with kickstart based distributions
        images.\",\"created_at\":\"2024-06-27 17:28:09 UTC\",\"updated_at\":\"2024-07-03
        14:59:41 UTC\",\"id\":130,\"name\":\"Kickstart default user data\",\"template_kind_id\":10,\"template_kind_name\":\"user_data\"},{\"snippet\":true,\"description\":\"Generates
        the ifcfg configuration file for interface attached to a bond.\\nThis is typically
        used by other templates and snippets that pass interface\\nobject to be configured.
        It is not expected to be used directly.\",\"created_at\":\"2024-06-27 17:28:08
        UTC\",\"updated_at\":\"2024-07-03 14:59:41 UTC\",\"id\":86,\"name\":\"kickstart_ifcfg_bonded_interface\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":true,\"description\":\"Generates
        the ifcfg configuration file for bond interface.\\nThis is typically used
        by other templates and snippets that pass interface\\nobject to be configured.
        It is not expected to be used directly.\",\"created_at\":\"2024-06-27 17:28:08
        UTC\",\"updated_at\":\"2024-07-03 14:59:42 UTC\",\"id\":85,\"name\":\"kickstart_ifcfg_bond_interface\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":true,\"description\":\"Generates
        the ifcfg configuration file for a generic network interface.\\nThis is typically
        used by other templates and snippets that pass interface\\nobject to be configured.
        It is not expected to be used directly.\",\"created_at\":\"2024-06-27 17:28:08
        UTC\",\"updated_at\":\"2024-07-03 14:59:42 UTC\",\"id\":87,\"name\":\"kickstart_ifcfg_generic_interface\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":true,\"description\":\"Generates
        shell snippet that detects the current identifier of a network interface\\nbased
        on the MAC address. This is required in provisioning flows when reboot is
        involved\\nbetween when the network interfaces has been reported to the database
        and the actual\\nprovisioning, e.g. when provisioning using discovery image.
        Interfaces reported by FDI\\nuse naming convention used by FDI, e.g. eth0,
        while when provisioning a newer RHEL, interfaces\\nuse bios dev names e.g.
        enp0s31f6.\\nThis is typically used by other templates and snippets that pass
        interface\\nobject to be configured. It is not expected to be used directly.\",\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:42 UTC\",\"id\":88,\"name\":\"kickstart_ifcfg_get_identifier_names\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":true,\"description\":\"The
        list of kernel options for initrd appended to the bootloader kernel line on
        Red Hat compatible distributions.\\nTypically renders to a string with the
        url where to fetch the OS installer answer files, e.g.\\n  network ksdevice=bootif
        ks.device=bootif BOOTIF=01-52-54-00-8b-a3-86 inst.ks=http://foreman.example.com/unattended/provision
        inst.ks.sendmac ip=dhcp nameserver=192.168.122.1\\nCustom options can be added
        by setting the array parameter kickstart_kernel_custom_options\",\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:42 UTC\",\"id\":89,\"name\":\"kickstart_kernel_options\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":true,\"description\":\"Generates
        a complete shell script that creates ifcfg configuration files for all\\nhost's
        network interfaces. Typically used on Red Hat based distributions.\",\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:42 UTC\",\"id\":91,\"name\":\"kickstart_networking_setup\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":true,\"description\":\"Generates
        network directive for a given interface. It is not expected to be used directly.\",\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:42 UTC\",\"id\":90,\"name\":\"kickstart_network_interface\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":false,\"description\":\"Provisioning
        template for oVirt Node and Red Hat Virtualization Host. It renders the kickstart\\nfile.\\n\\nThis
        template accepts the following parameters:\\n- liveimg_name: string (default=squashfs.img)\\n-
        lang: string (default=\\\"en_US.UTF-8\\\")\\n- selinux-mode: string (default=\\\"enforcing\\\")\\n-
        keyboard: string (default=\\\"us\\\")\\n- time-zone: string (default=\\\"UTC\\\")\\n-
        ntp-server: string (default=\\\"0.fedora.pool.ntp.org\\\")\\n- disable-firewall:
        boolean (default=false)\\n\\nThis kickstart will only work with LVM THIN partitioning
        ('Kickstart default thin')\\nand it requires the installation URL to have
        squashfs.img image extracted in the\\nroot folder (or specified via 'liveimg_name'
        parameter). See oVirt Node documentation\\nor RHV Installation Manual, section
        5.2. Advanced installation.\\n\\nBy default, the template expects the squashfs.img
        to be present inside\\nthe installation media. When using Katello for content
        management (the\\nkt_activation_key parameter is set), the liveimg_name is
        used to\\nspecify relative path to the file and the template use repository_url\\nhelper
        to generate an absolute path to the file (taking into account\\nalso info
        about the content proxy relevant for the host)\\n\\nFor example, in case the
        squashfs.img is uploaded inside custom\\nproduct named 'oVirt' and repository
        'hypervisor', the\\nliveimg_name would be 'custom/ovirt/hypervisor/squashfs.img'.\\nIn
        this case, this repository would need to be part of the content\\nview the
        host is assigned to. It's also possible to provide full url,\\nin which case
        it would be used without a change.\",\"created_at\":\"2024-06-27 17:28:08
        UTC\",\"updated_at\":\"2024-07-03 14:59:42 UTC\",\"id\":65,\"name\":\"Kickstart
        oVirt-RHVH\",\"template_kind_id\":7,\"template_kind_name\":\"provision\"},{\"snippet\":false,\"description\":\"The
        template to render PXELinux bootloader configuration for oVirt Node or Red
        Hat Virtualization Host.\\nThe output is deployed on the host's subnet TFTP
        proxy.\",\"created_at\":\"2024-06-27 17:28:07 UTC\",\"updated_at\":\"2024-07-03
        14:59:42 UTC\",\"id\":18,\"name\":\"Kickstart oVirt-RHVH PXELinux\",\"template_kind_id\":3,\"template_kind_name\":\"PXELinux\"},{\"snippet\":true,\"description\":\"Generate
        Anaconda RHSM configuration for Red Hat OS registration\",\"created_at\":\"2024-06-27
        17:28:09 UTC\",\"updated_at\":\"2024-07-03 14:59:42 UTC\",\"id\":92,\"name\":\"kickstart_rhsm\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":false,\"description\":\"This
        template is used during the host registration to perform the initial host
        configuration. After the host\\nis created by starting the registration, the
        registration script asks for the host init config script, that\\nis rendered
        based on this template. It is rendered for the specific host therefore it
        contains instructions\\nspecific for the OS of the host. It's content can
        differ based on any parameters applicable for the host.\\n\\nIt deploys the
        CA certificate so any later communication with the Foreman is TLS secured.
        Then it\\nperforms initial steps, such as puppet deployment, remote execution
        SSH key configuration etc. At the end\\nit informs Foreman that provisioning
        has finished.\",\"created_at\":\"2024-06-27 17:28:08 UTC\",\"updated_at\":\"2024-07-03
        14:59:42 UTC\",\"id\":47,\"name\":\"Linux host_init_config default\",\"template_kind_id\":2,\"template_kind_name\":\"host_init_config\"},{\"snippet\":true,\"description\":\"The
        snippet configuring the system time using a given NTP server\\nIt respects
        the following parameters:\\n- use-ntp: boolean (default depends on OS release)\\n-
        ntp-server: string (default=undef)\",\"created_at\":\"2024-06-27 17:28:09
        UTC\",\"updated_at\":\"2024-07-03 14:59:42 UTC\",\"id\":93,\"name\":\"ntp\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":false,\"description\":\"This
        is a placeholder template that must be replaced with the actual template\\nthat
        renders the POAP script. DHCP options must be configured to point NX-OS to\\ndownload
        the POAP from Foreman. For more details, see https://projects.theforeman.org/issues/10526\",\"created_at\":\"2024-06-27
        17:28:07 UTC\",\"updated_at\":\"2024-07-03 14:59:42 UTC\",\"id\":1,\"name\":\"NX-OS
        default POAP setup\",\"template_kind_id\":12,\"template_kind_name\":\"POAP\"},{\"snippet\":true,\"description\":\"Select
        package manager for the OS. Snippet sets the package manager\\nin the PKG_MANAGER
        env variable so it can be used in templates like this:\\n$PKG_MANAGER install
        -y pkg1 pkg2\",\"created_at\":\"2024-06-27 17:28:09 UTC\",\"updated_at\":\"2024-07-03
        14:59:42 UTC\",\"id\":94,\"name\":\"pkg_manager\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":true,\"description\":\"Wrapper
        snippet to set up Clevis/Tang disk encryption.\\nRequires Ubuntu >= 22.04.3.\\nThe
        snippet is automatically indented by 2 spaces. For reference:\\nhttps://ubuntu.com/server/docs/install/autoinstall-reference\",\"created_at\":\"2024-06-27
        17:28:09 UTC\",\"updated_at\":\"2024-07-03 14:59:42 UTC\",\"id\":95,\"name\":\"preseed_autoinstall_clevis_tang_wrapper\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":false,\"description\":\"The
        provisioning template for Autoinstall based distributions. To customize the
        installation,\\nmodify the host parameters\\n\\nThis template accepts the
        following parameters:\\n- lang: string (default=\\\"en_US.UTF-8\\\")\\n- keyboard:
        string (default=\\\"us\\\")\\n- package_upgrade: boolean (default=false)\\n-
        remote_execution_ssh_keys: string (default=\\\"\\\")\\n- username_to_create:
        string (default=\\\"root\\\")\\n- realname_to_create: string (default=username_to_create)\\n-
        password_to_create: string (default=@host.root_pass)\",\"created_at\":\"2024-06-27
        17:28:09 UTC\",\"updated_at\":\"2024-07-03 14:59:42 UTC\",\"id\":131,\"name\":\"Preseed
        Autoinstall cloud-init user data\",\"template_kind_id\":10,\"template_kind_name\":\"user_data\"},{\"snippet\":false,\"description\":\"The
        provisioning template for preseed based distributions. The output is fetched
        by the installer during\\nthe network based installation. To customize the
        installation, modify the host parameters.\",\"created_at\":\"2024-06-27 17:28:08
        UTC\",\"updated_at\":\"2024-07-03 14:59:42 UTC\",\"id\":66,\"name\":\"Preseed
        default\",\"template_kind_id\":7,\"template_kind_name\":\"provision\"},{\"snippet\":false,\"description\":\"A
        finish template executed at the end of a network provisioning done using preseed
        based\\ninstaller, typically DEB based distributions. This template renders
        to a shell script.\",\"created_at\":\"2024-06-27 17:28:08 UTC\",\"updated_at\":\"2024-07-03
        14:59:42 UTC\",\"id\":44,\"name\":\"Preseed default finish\",\"template_kind_id\":8,\"template_kind_name\":\"finish\"},{\"snippet\":false,\"description\":\"The
        template to render iPXE installation script for preseed based distributions\\nThe
        output is deployed on the host's subnet TFTP proxy.\\nSee https://ipxe.org/scripting
        for more details\",\"created_at\":\"2024-06-27 17:28:08 UTC\",\"updated_at\":\"2024-07-03
        14:59:42 UTC\",\"id\":53,\"name\":\"Preseed default iPXE\",\"template_kind_id\":6,\"template_kind_name\":\"iPXE\"},{\"snippet\":false,\"description\":null,\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:42 UTC\",\"id\":54,\"name\":\"Preseed
        default iPXE Autoinstall\",\"template_kind_id\":6,\"template_kind_name\":\"iPXE\"},{\"snippet\":false,\"description\":\"The
        template to render Grub2 bootloader configuration for preseed based distributions.\\nThe
        output is deployed on the host's subnet TFTP proxy.\",\"created_at\":\"2024-06-27
        17:28:07 UTC\",\"updated_at\":\"2024-07-03 14:59:42 UTC\",\"id\":9,\"name\":\"Preseed
        default PXEGrub2\",\"template_kind_id\":5,\"template_kind_name\":\"PXEGrub2\"},{\"snippet\":false,\"description\":null,\"created_at\":\"2024-06-27
        17:28:07 UTC\",\"updated_at\":\"2024-07-03 14:59:42 UTC\",\"id\":10,\"name\":\"Preseed
        default PXEGrub2 Autoinstall\",\"template_kind_id\":5,\"template_kind_name\":\"PXEGrub2\"},{\"snippet\":false,\"description\":\"The
        template to render PXELinux bootloader configuration for preseed based distributions.\\nThe
        output is deployed on the host's subnet TFTP proxy.\",\"created_at\":\"2024-06-27
        17:28:07 UTC\",\"updated_at\":\"2024-07-03 14:59:43 UTC\",\"id\":19,\"name\":\"Preseed
        default PXELinux\",\"template_kind_id\":3,\"template_kind_name\":\"PXELinux\"},{\"snippet\":false,\"description\":null,\"created_at\":\"2024-06-27
        17:28:07 UTC\",\"updated_at\":\"2024-07-03 14:59:43 UTC\",\"id\":20,\"name\":\"Preseed
        default PXELinux Autoinstall\",\"template_kind_id\":3,\"template_kind_name\":\"PXELinux\"},{\"snippet\":false,\"description\":\"This
        template is used during image based provisioning, when the image is configured
        to use user-data.\\nThe output is a shell script that cloud-init runs to configures
        the VM\\nbooted from the image. The image must have cloud-init installed in
        order for this to work.\\nThis script can be used with preseed distributions
        images.\",\"created_at\":\"2024-06-27 17:28:09 UTC\",\"updated_at\":\"2024-07-03
        14:59:43 UTC\",\"id\":132,\"name\":\"Preseed default user data\",\"template_kind_id\":10,\"template_kind_name\":\"user_data\"},{\"snippet\":true,\"description\":\"options
        for the kernel / preseed startup initialization\",\"created_at\":\"2024-06-27
        17:28:09 UTC\",\"updated_at\":\"2024-07-03 14:59:43 UTC\",\"id\":96,\"name\":\"preseed_kernel_options\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":true,\"description\":\"options
        for the kernel / preseed startup initialization\",\"created_at\":\"2024-06-27
        17:28:09 UTC\",\"updated_at\":\"2024-07-03 14:59:43 UTC\",\"id\":97,\"name\":\"preseed_kernel_options_autoinstall\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":true,\"description\":null,\"created_at\":\"2024-06-27
        17:28:09 UTC\",\"updated_at\":\"2024-07-03 14:59:43 UTC\",\"id\":98,\"name\":\"preseed_netplan_generic_interface\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":true,\"description\":\"This
        will configure your host networking, it configures your\\nprimary interface
        as well as other NICs like BOND, BRIDGE, VLAN and Alias\\ninterfaces.\",\"created_at\":\"2024-06-27
        17:28:09 UTC\",\"updated_at\":\"2024-07-03 14:59:43 UTC\",\"id\":99,\"name\":\"preseed_netplan_setup\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":true,\"description\":\"This
        will configure your host networking, it configures your primary interface
        as well\\nas other configures NICs. It supports physical, VLAN and Alias interfaces.
        It's intended to be\\ncalled in your preseed finish template.\",\"created_at\":\"2024-06-27
        17:28:09 UTC\",\"updated_at\":\"2024-07-03 14:59:43 UTC\",\"id\":100,\"name\":\"preseed_networking_setup\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":true,\"description\":\"Generates
        a puppet.conf file which is required for the puppet agent bootstraping.\\nThe
        puppet server and CA is configured based on the host configuration. It supports\\nPuppet
        5 and newer.\",\"created_at\":\"2024-06-27 17:28:09 UTC\",\"updated_at\":\"2024-07-03
        14:59:43 UTC\",\"id\":101,\"name\":\"puppet.conf\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":true,\"description\":\"Fetches
        the package that deploys the PuppetLabs repository that can be\\nused to install
        Puppet from. It only performs the installation in case\\none of the enable-puppetlabs*repo
        parameter is set to true.\",\"created_at\":\"2024-06-27 17:28:09 UTC\",\"updated_at\":\"2024-07-03
        14:59:43 UTC\",\"id\":103,\"name\":\"puppetlabs_repo\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":true,\"description\":\"Bootstraps
        the Puppet agent and performs one run to create a certificate request.\\n\\nIn
        more details it installs a Puppet agent, creates the necessary configuration
        files,\\nenables the Puppet agent service and performs a single run with a
        specified tag.\\nBy default the tag `no_such_tag` is used to generate an empty
        run.\\nAn empty run can be used for the agent to detect it's missing a client
        certificate\\nand ask for a new one from the host's Puppet CA.\",\"created_at\":\"2024-06-27
        17:28:09 UTC\",\"updated_at\":\"2024-07-03 14:59:43 UTC\",\"id\":102,\"name\":\"puppet_setup\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":true,\"description\":\"In
        Foreman's typical PXE workflow, managed hosts are configured to always boot
        from network and inventory build flag dictates if they should boot into installer
        (build is on) or boot from local drive (build is off). This template is used
        to chainload from EFI ESP for systems which booted from network. It is not
        as straightforward as in BIOS and EFI boot file must be found on an ESP partition.\\n\\nThis
        will only be needed when provisioned hosts are set to boot from network, typically
        EFI firmware implementations overrides boot order after new OS installation.
        This behavior can be set in EFI, or \\\"efi_bootentry\\\" host parameter can
        be set to \\\"previous\\\" to override boot order back to previous (network)
        setting. See efibootmgr_netboot snippet for more info.\",\"created_at\":\"2024-06-27
        17:28:09 UTC\",\"updated_at\":\"2024-07-03 14:59:43 UTC\",\"id\":104,\"name\":\"pxegrub2_chainload\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":false,\"description\":\"The
        template to render Grub2 bootloader configuration for provisioned hosts,\\nthat
        still boot from the network.\\nHosts are instructed to boot from the first
        local medium.\\nDo not associate or change the name.\",\"created_at\":\"2024-06-27
        17:28:07 UTC\",\"updated_at\":\"2024-07-03 14:59:43 UTC\",\"id\":11,\"name\":\"PXEGrub2
        default local boot\",\"template_kind_id\":5,\"template_kind_name\":\"PXEGrub2\"},{\"snippet\":true,\"description\":\"Snippet
        with grub2 menu items for discovery plugin. It is included in PXEGrub2 Default
        templates to boot unknown hosts into discovery image.\\n\\nRHEL 7 virtio driver
        does not have persistent naming scheme, causing interfaces\\nto be named eth0,
        eth1, etc.. If you want to enable the new persistent naming\\nscheme and get
        inteface names like ens3, add net.ifnames=1 to the linuxefi line\\nbelow.
        This will not be fixed until RHEL8 due to prevent breaking changes for\\nexisting
        systems. See RHBZ#1259015 for more details.\",\"created_at\":\"2024-06-27
        17:28:09 UTC\",\"updated_at\":\"2024-07-03 14:59:43 UTC\",\"id\":105,\"name\":\"pxegrub2_discovery\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":false,\"description\":\"The
        template to render Grub2 bootloader configuration for unknown hosts.\\nThe
        output is deployed on the host's subnet TFTP proxy.\\nDo not associate or
        change the name.\",\"created_at\":\"2024-06-27 17:28:07 UTC\",\"updated_at\":\"2024-07-03
        14:59:43 UTC\",\"id\":12,\"name\":\"PXEGrub2 global default\",\"template_kind_id\":5,\"template_kind_name\":\"PXEGrub2\"},{\"snippet\":true,\"description\":\"Snippet
        that is included in all PXEGrub2 templates in order to find MAC-based configuration
        on TFTP/HTTPBoot. Grub2 in Red Hat is patched with this feature, however,
        Debian/Ubuntu or other distributions do not have this patch.\",\"created_at\":\"2024-06-27
        17:28:09 UTC\",\"updated_at\":\"2024-07-03 14:59:43 UTC\",\"id\":106,\"name\":\"pxegrub2_mac\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":true,\"description\":\"Snippet
        used to chainload BIOS HDD when booted from network. Used in PXEGrub global
        and local templates.\",\"created_at\":\"2024-06-27 17:28:09 UTC\",\"updated_at\":\"2024-07-03
        14:59:43 UTC\",\"id\":107,\"name\":\"pxegrub_chainload\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":false,\"description\":\"The
        template to render Grub bootloader configuration for provisioned hosts,\\nthat
        still boot from the network.\\nHosts are instructed to boot from the first
        local medium.\\nDo not associate or change the name.\\nThis template is for
        legacy Grub 1.x, you are probably looking for Grub2.\",\"created_at\":\"2024-06-27
        17:28:07 UTC\",\"updated_at\":\"2024-07-03 14:59:43 UTC\",\"id\":5,\"name\":\"PXEGrub
        default local boot\",\"template_kind_id\":4,\"template_kind_name\":\"PXEGrub\"},{\"snippet\":true,\"description\":\"Snippet
        with Grub menu items for discovery plugin. It is included in PXEGrub Default
        templates to boot unknown hosts into discovery image.\\n\\nRHEL 7 virtio driver
        does not have persistent naming scheme, causing interfaces\\nto be named eth0,
        eth1, etc.. If you want to enable the new persistent naming\\nscheme and get
        inteface names like ens3, add net.ifnames=1 to the linuxefi line\\nbelow.
        This will not be fixed until RHEL8 due to prevent breaking changes for\\nexisting
        systems. See RHBZ#1259015 for more details.\",\"created_at\":\"2024-06-27
        17:28:09 UTC\",\"updated_at\":\"2024-07-03 14:59:43 UTC\",\"id\":108,\"name\":\"pxegrub_discovery\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":false,\"description\":\"The
        template to render Grub bootloader configuration for unknown hosts.\\nThe
        output is deployed on the host's subnet TFTP proxy.\\nDo not associate or
        change the name.\\nThis template is for legacy Grub 1.x, you are probably
        looking for Grub2.\",\"created_at\":\"2024-06-27 17:28:07 UTC\",\"updated_at\":\"2024-07-03
        14:59:43 UTC\",\"id\":6,\"name\":\"PXEGrub global default\",\"template_kind_id\":4,\"template_kind_name\":\"PXEGrub\"},{\"snippet\":false,\"description\":\"Chainboots
        iPXE/gPXE from PXELinux. Make sure the OS has iPXE template\\nassociated and
        file ipxe.lkrn was copied in the TFTP directory (e.g. from\\n/usr/share/ipxe/ipxe.lkrn
        or iPXE project web site).\\n\\nFor more info visit:\\nhttps://docs.theforeman.org/nightly/Provisioning_Guide/index-foreman-el.html#Configuring_Networking-Configuring_gPXE_to_Reduce_Provisioning_Times\",\"created_at\":\"2024-06-27
        17:28:07 UTC\",\"updated_at\":\"2024-07-03 14:59:43 UTC\",\"id\":21,\"name\":\"PXELinux
        chain iPXE\",\"template_kind_id\":3,\"template_kind_name\":\"PXELinux\"},{\"snippet\":false,\"description\":\"Chainboots
        iPXE/gPXE from PXELinux via UNDI. Make sure the OS has an iPXE\\ntemplate
        associated and the file undionly.kpxe was copied into the TFTP\\ndirectory
        as undionly-ipxe.0 (e.g. from /usr/share/ipxe/undionly.kpxe or\\nthe iPXE
        project web site). Changes need to be made in the DHCP\\nconfiguration to
        prevent an endless loop to happen.\\n\\nFor more info visit:\\nhttps://docs.theforeman.org/nightly/Provisioning_Guide/index-foreman-el.html#Configuring_Networking-Configuring_gPXE_to_Reduce_Provisioning_Times\",\"created_at\":\"2024-06-27
        17:28:07 UTC\",\"updated_at\":\"2024-07-03 14:59:44 UTC\",\"id\":22,\"name\":\"PXELinux
        chain iPXE UNDI\",\"template_kind_id\":3,\"template_kind_name\":\"PXELinux\"},{\"snippet\":true,\"description\":\"Snippet
        used to chainload BIOS HDD when booted from network. Used in PXELinux global
        and local templates.\",\"created_at\":\"2024-06-27 17:28:09 UTC\",\"updated_at\":\"2024-07-03
        14:59:44 UTC\",\"id\":109,\"name\":\"pxelinux_chainload\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":false,\"description\":\"The
        template to render PXELinux bootloader configuration for provisioned hosts,\\nthat
        still boot from the network.\\nHosts are instructed to boot from the first
        local medium.\\nDo not associate or change the name.\",\"created_at\":\"2024-06-27
        17:28:07 UTC\",\"updated_at\":\"2024-07-03 14:59:44 UTC\",\"id\":23,\"name\":\"PXELinux
        default local boot\",\"template_kind_id\":3,\"template_kind_name\":\"PXELinux\"},{\"snippet\":false,\"description\":\"The
        template to render PXELinux bootloader configuration for FreeBSD.\\nThe output
        is deployed on the host's subnet TFTP proxy. It boots the memdisk.\\nMemdisk
        is meant to allow booting legacy operating systems. Memdisk can boot\\nfloppy
        images, hard disk images and some ISO images.\\n\\nThis template does not
        store the foreman_url in the comment (see freebsd (mfsbsd) pxelinux\\ntemplate)\",\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:44 UTC\",\"id\":24,\"name\":\"PXELinux
        default memdisk\",\"template_kind_id\":3,\"template_kind_name\":\"PXELinux\"},{\"snippet\":true,\"description\":\"Snippet
        with PXELinux menu items for discovery plugin. It is included in PXELinux
        Default templates to boot unknown hosts into discovery image.\\n\\ndiscovery
        image is based on CentOS/RHEL and therefore it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\\nIn
        short, before RHEL 7.2 virtio driver didn't have the new persistent naming
        scheme, causing interfaces to be named eth0, eth1, etc..\\nIf you want to
        enable the new persistent naming scheme and get inteface names like ens3,
        add net.ifnames=1 to the APPEND line below.\",\"created_at\":\"2024-06-27
        17:28:09 UTC\",\"updated_at\":\"2024-07-03 14:59:44 UTC\",\"id\":110,\"name\":\"pxelinux_discovery\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":false,\"description\":\"The
        template to render PXELinux bootloader configuration for unknown hosts.\\nThe
        output is deployed on the host's subnet TFTP proxy.\\nDo not associate or
        change the name.\",\"created_at\":\"2024-06-27 17:28:08 UTC\",\"updated_at\":\"2024-07-03
        14:59:44 UTC\",\"id\":25,\"name\":\"PXELinux global default\",\"template_kind_id\":3,\"template_kind_name\":\"PXELinux\"},{\"snippet\":true,\"description\":\"The
        cloud config used for the RancherOS installation\",\"created_at\":\"2024-06-27
        17:28:09 UTC\",\"updated_at\":\"2024-07-03 14:59:44 UTC\",\"id\":111,\"name\":\"rancheros_cloudconfig\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":false,\"description\":\"The
        provisioning template for the RancherOS. The output is the cloud config data.\\nThis
        does not work with k3os, a successor of the RancherOS 1.x and 2.x\",\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:44 UTC\",\"id\":67,\"name\":\"RancherOS
        provision\",\"template_kind_id\":7,\"template_kind_name\":\"provision\"},{\"snippet\":false,\"description\":\"The
        template to render PXELinux bootloader configuration for RancherOS.\\nThis
        does not work with k3os, a successor of the RancherOS 1.x and 2.x\\nThe output
        is deployed on the host's subnet TFTP proxy.\",\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:44 UTC\",\"id\":26,\"name\":\"RancherOS
        PXELinux\",\"template_kind_id\":3,\"template_kind_name\":\"PXELinux\"},{\"snippet\":true,\"description\":\"Red
        Hat Registration Snippet\\n\\nGeneral parameters:\\n\\n  redhat_install_host_tools
        = [true|false]    Install the katello-host-tools yum/dnf plugins.\\n\\n  redhat_install_host_tracer_tools
        = [true|false]  Install the katello-host-tools Tracer yum/dnf plugin.\\n\\n
        \ activation_key = <key>                      Activation key string, not needed
        if using\\n                                              subscription-manager
        with username/password\\n\\nParameters for use with subscription-manager (Red
        Hat CDN, Satellite, or Katello)\\n\\n  subscription_manager = 'true'               You're
        going to use subscription-manager\\n\\n  subscription_manager_auto_attach
        = 'false'  Run attach --auto after registering.\\n\\n  subscription_manager_username
        = <username>  Username for subscription-manager\\n\\n  subscription_manager_password
        = <password>  Password for subscription-manager\\n\\n  subscription_manager_certpkg_url
        = <url>    Custom certificate package URL\\n\\n  subscription_manager_org
        = <org name>       Organization name, if required\\n\\n  subscription_manager_repos
        = <repos>        Additional repositories to enable\\n                                              after
        registration.\\n                                              Seperate multiple
        repositories with commas.\\n\\n  subscription_manager_override_repos_cost
        = <cost>  Override repository cost\\n\\n  subscription_manager_pool = <pool>
        \         Specific subscription pool to use\\n\\n  only_subscription_manager_repos
        = 'true'    dnf/yum should only use repos managed by sub-man\\n\\n  http-proxy
        = <host>                         Proxy hostname to be used for registration\\n\\n
        \ http-proxy-port = <port>                    Proxy port to be used for registration\\n\\n
        \ http-proxy-user = <user>                    Proxy user to be used for registration\\n\\n
        \ http-proxy-password = <password>            Proxy password to be used for
        registration\\n\\n  syspurpose_role                             Sets the system
        purpose role\\n\\n  syspurpose_usage                            Sets the system
        purpose usage\\n\\n  syspurpose_sla                              Sets the
        system purpose SLA\\n\\n  syspurpose_addons                           Sets
        the system purpose add-ons. Separate multiple\\n                                              values
        with commas.\\n\\nSet these parameters if you're using rhnreg_ks:\\n\\n  spacewalk_host
        = <hostname>                 Hostname of Spacewalk server\",\"created_at\":\"2024-06-27
        17:28:09 UTC\",\"updated_at\":\"2024-07-03 14:59:44 UTC\",\"id\":112,\"name\":\"redhat_register\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":true,\"description\":\"Snippet
        for installing and setting up a client to be reachable by remote execution
        in pull mode\",\"created_at\":\"2024-06-27 17:28:08 UTC\",\"updated_at\":\"2024-07-03
        14:59:44 UTC\",\"id\":71,\"name\":\"remote_execution_pull_setup\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":true,\"description\":\"SSH
        keys setup snippet for Remote Execution plugin\\n\\nParameters:\\n\\nremote_execution_ssh_keys:
        public keys to be put in ~/.ssh/authorized_keys\\n\\nremote_execution_ssh_user:
        user for which remote_execution_ssh_keys will be\\n                           authorized\\n\\nremote_execution_create_user:
        create user if it not already existing\\n\\nremote_execution_effective_user_method:
        method to switch from ssh user to\\n                                        effective
        user\\n\\nThis template sets up SSH keys in any host so that as long as your
        public\\nSSH key is in remote_execution_ssh_keys, you can SSH into a host.
        This\\nworks in combination with Remote Execution plugin by querying smart
        proxies\\nto build an array.\\n\\nTo use this snippet without the plugin provide
        the SSH keys as host parameter\\nremote_execution_ssh_keys. It expects the
        same format like the authorized_keys\\nfile.\",\"created_at\":\"2024-06-27
        17:28:09 UTC\",\"updated_at\":\"2024-07-03 14:59:44 UTC\",\"id\":113,\"name\":\"remote_execution_ssh_keys\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":true,\"description\":\"Generates
        a Salt minion configuration file which is required for the Salt bootstraping.\\nThe
        Salt master is configured based on the host parameter called \\\"salt_master\\\".\\nIt
        can also statically assign grains based on the \\\"salt_grains\\\" host parameter.\",\"created_at\":\"2024-06-27
        17:28:09 UTC\",\"updated_at\":\"2024-07-03 14:59:44 UTC\",\"id\":114,\"name\":\"saltstack_minion\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":true,\"description\":\"this
        snippet will configure the Saltstack Minion\",\"created_at\":\"2024-06-27
        17:28:09 UTC\",\"updated_at\":\"2024-07-03 14:59:44 UTC\",\"id\":115,\"name\":\"saltstack_setup\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":true,\"description\":\"In
        image based provisioning using finish templates, reboot can't be performed\\nimmediatelly,
        because it would interrupt the ongoing SSH connection. Instead\\nthis snippet
        should be used. It schedules reboot correctly a minute after,\\nwhich gives
        SSH enough time to properly disconnect. To active this behavior\\nschedule_reboot
        host parameter must be set to true.\",\"created_at\":\"2024-06-27 17:28:09
        UTC\",\"updated_at\":\"2024-07-03 14:59:44 UTC\",\"id\":116,\"name\":\"schedule_reboot\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":true,\"description\":\"This
        snippet installs and configures subscription-manager that is required for
        host registration.\\nThe snippet is included in the \\\"global_registration\\\"
        template and in the \\\"redhat_register\\\" snippet.\\nThe latter ensures
        host registration during the provisioning process.\",\"created_at\":\"2024-06-27
        17:28:09 UTC\",\"updated_at\":\"2024-07-03 14:59:44 UTC\",\"id\":117,\"name\":\"subscription_manager_setup\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":false,\"description\":\"This
        template is used during image based provisioning, when the image is configured
        to use user-data.\\nThe output is a list of cloud-init directives that cloud-init
        parses to configures the VM\\nbooted from the image. The image must have cloud-init
        installed in order for this to work.\\n\\nThis template accepts the following
        parameters:\\n- ssh_pwauth: boolean (default=true unless ssh_authorized_keys)\\n-
        ssh_authorized_keys: string w newline seperated keys (default=\\\"\\\")\\n-
        package_upgrade: boolean (default=false)\\n- reboot: boolean (default=false)\\n-
        skip-puppet-setup: boolean (default=false)\",\"created_at\":\"2024-06-27 17:28:09
        UTC\",\"updated_at\":\"2024-07-03 14:59:44 UTC\",\"id\":133,\"name\":\"UserData
        default\",\"template_kind_id\":10,\"template_kind_name\":\"user_data\"},{\"snippet\":false,\"description\":\"Template
        for VMWare customization via open-vm-tools during user-data image based provisioning.\\n\\nComparing
        to other user-data templates, e.g. those based on cloud-init, this template
        defines a Customization Specifications that is evaluated by vSphere while
        cloning a VM from a Template. When the Template that should be cloned has
        open-vm-tools installed, this allows to configure certain aspects, e.g. networking
        of the VM, prior boot, so no DHCP configuration is required.\\nCloud-init
        is typically used for a stage 2 configuration. In order for this to work,
        the VMware\\ntemplate must have open-vm-tools installed.\\nThe example below
        is for Linux only, Windows is supported by this mechanism via Sysprep as well,
        though.\\n\\nThis needs to he a hash in YAML format with these keys:\\n- encryptionKey
        (array)\\n- globalIPSettings (hash), REQUIRED\\n- identity (hash), REQUIRED\\n-
        nicSettingMap (array)\\n- options (hash)\\n- extraConfig (hash)\\n\\nSee https://docs.theforeman.org/nightly/Provisioning_Guide/index-foreman-el.html#Provisioning_Virtual_Machines_in_VMware_vSphere-Provisioning_with_cloudinit_and_userdata_templates\",\"created_at\":\"2024-06-27
        17:28:09 UTC\",\"updated_at\":\"2024-07-03 14:59:44 UTC\",\"id\":134,\"name\":\"UserData
        open-vm-tools\",\"template_kind_id\":10,\"template_kind_name\":\"user_data\"},{\"snippet\":false,\"description\":\"The
        template to render PXELinux bootloader configuration for Windows.\\nIt is
        used to boot the Windows PE that is then used to install Windows.\\nThe output
        is deployed on the host's subnet TFTP proxy.\",\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:44 UTC\",\"id\":27,\"name\":\"WAIK
        default PXELinux\",\"template_kind_id\":3,\"template_kind_name\":\"PXELinux\"},{\"snippet\":false,\"description\":\"A
        finish template executed at the end of Windows provisioning. For more information,
        please\\nsee https://community.theforeman.org/t/windows-provisioning-made-easy/16756\\n\\nThis
        template accepts the following parameters:\\n- windowsLicenseKey: ABCDE-ABCDE-ABCDE-ABCDE-ABCDE
        # Valid Windows license key\\n- windowsLicenseOwner: Company, INC # Legal
        owner of the Windows license key\\n- localAdminAccountDisabled: false\\n-
        ntpServer: time.windows.com,other.time.server\\n- domainAdminAccount: joinuser@domain.com
        # please do not use the domain administrator\\n- domainAdminAccountPasswd:
        Password for the domain Admin account\\n- computerOU: OU=Computers,CN=domain,CN=com
        # Place the computer account in specified Organizational Unit\\n- computerDomain:
        domain.com # domain to join\\n- machinePassword: used for unsecure domain
        join. needs precrated computer object (New-ADComputer)\\n- foremanDebug: false\\n-
        skip-puppet-setup: boolean (default=false)\\n\\nInformation about unsecure
        domain join\\nhttps://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/add-computer?view=powershell-5.1#example-9--add-a-computer-to-a-domain-using-predefined-computer-credentials\",\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:44 UTC\",\"id\":45,\"name\":\"Windows
        default finish\",\"template_kind_id\":8,\"template_kind_name\":\"finish\"},{\"snippet\":false,\"description\":\"The
        template to render iPXE installation script for Windows\\nThe output is deployed
        on the host's subnet TFTP proxy.\\nSee https://ipxe.org/scripting for more
        details\",\"created_at\":\"2024-06-27 17:28:08 UTC\",\"updated_at\":\"2024-07-03
        14:59:44 UTC\",\"id\":55,\"name\":\"Windows default iPXE\",\"template_kind_id\":6,\"template_kind_name\":\"iPXE\"},{\"snippet\":false,\"description\":\"The
        template to render iPXE installation script for Windows\\nThe output is deployed
        on the host's subnet TFTP proxy.\\nSee https://ipxe.org/scripting for more
        details\",\"created_at\":\"2024-06-27 17:28:08 UTC\",\"updated_at\":\"2024-07-03
        14:59:44 UTC\",\"id\":56,\"name\":\"Windows default iPXE httpboot\",\"template_kind_id\":6,\"template_kind_name\":\"iPXE\"},{\"snippet\":false,\"description\":\"A
        templated answers.xml file for windows installations. This provides all answers
        to the questions an interactive installation would ask.\\nIt supports the
        following parameters:\\n- windowsLicenseKey: ABCDE-ABCDE-ABCDE-ABCDE-ABCDE
        # Valid Windows license key\\n- windowsLicenseOwner: Company, INC # Legal
        owner of the Windows license key\\n- systemLocale: en-US\\n- systemUILanguage:
        en-US\\n- systemTimeZone: GMT Standard Time #see https://msdn.microsoft.com/en-us/library/ms912391(v=winembedded.11).aspx\\n-
        wimImageName = Windows 8.1 Pro # Image name seems only necessary if the WIM
        contains more than one image\",\"created_at\":\"2024-06-27 17:28:08 UTC\",\"updated_at\":\"2024-07-03
        14:59:45 UTC\",\"id\":68,\"name\":\"Windows default provision\",\"template_kind_id\":7,\"template_kind_name\":\"provision\"},{\"snippet\":false,\"description\":\"A
        template to render a PXELinux configuration for Windows installations.\\nIt
        injects the actual installation script from Foreman to give a highly customizable
        installation.\\nNote that this does rely on HTTP support inside your PXE environment.
        If this is not supported, please chain this using iPXE instead.\\nAfter this
        has been injected, it starts wimboot which in turn starts the actual WinPE
        image\",\"created_at\":\"2024-06-27 17:28:08 UTC\",\"updated_at\":\"2024-07-03
        14:59:45 UTC\",\"id\":28,\"name\":\"Windows default PXELinux\",\"template_kind_id\":3,\"template_kind_name\":\"PXELinux\"},{\"snippet\":false,\"description\":null,\"created_at\":\"2024-06-27
        17:28:09 UTC\",\"updated_at\":\"2024-07-03 14:59:45 UTC\",\"id\":135,\"name\":\"Windows
        default user data\",\"template_kind_id\":10,\"template_kind_name\":\"user_data\"},{\"snippet\":true,\"description\":\"Configures
        networking using netsh command on Windows hosts.\",\"created_at\":\"2024-06-27
        17:28:09 UTC\",\"updated_at\":\"2024-07-03 14:59:45 UTC\",\"id\":118,\"name\":\"Windows
        network\",\"template_kind_id\":null,\"template_kind_name\":null},{\"snippet\":false,\"description\":\"The
        provisioning template used for Windows\\nYou can create and assign a \\\"user_data\\\"
        ProvisioningTemplate as powershell to execute some custom code\\nSee https://community.theforeman.org/t/windows-provisioning-made-easy/16756/\\nparams:\\n-
        wimImageName: Windows 8.1 Pro # name of wim image to apply\",\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:45 UTC\",\"id\":73,\"name\":\"Windows
        peSetup.cmd\",\"template_kind_id\":9,\"template_kind_name\":\"script\"},{\"snippet\":false,\"description\":\"The
        provisioning template for the XenServer or Citrix Hypervisor.\",\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:45 UTC\",\"id\":69,\"name\":\"XenServer
        default answerfile\",\"template_kind_id\":7,\"template_kind_name\":\"provision\"},{\"snippet\":false,\"description\":\"The
        finish template executed at the end of XenServer provisioning informing Foreman,
        that provisioning\\nis complete. It reboots the machine afterwards. Meant
        for use with XenServer or Citrix Hypervisor\",\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:45 UTC\",\"id\":46,\"name\":\"XenServer
        default finish\",\"template_kind_id\":8,\"template_kind_name\":\"finish\"},{\"snippet\":false,\"description\":\"The
        template to render PXELinux bootloader configuration for XenServer or Citrix
        Hypervisor.\\nThe output is deployed on the host's subnet TFTP proxy.\",\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:45 UTC\",\"id\":29,\"name\":\"XenServer
        default PXELinux\",\"template_kind_id\":3,\"template_kind_name\":\"PXELinux\"},{\"snippet\":true,\"description\":\"Configures
        HTTP proxy in /etc/yum.conf based on the http-proxy and http-proxy-port\\nhost
        parameters.\",\"created_at\":\"2024-06-27 17:28:09 UTC\",\"updated_at\":\"2024-07-03
        14:59:45 UTC\",\"id\":119,\"name\":\"yum_proxy\",\"template_kind_id\":null,\"template_kind_name\":null}]\n}\n"
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '55772'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=99
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/257
  response:
    body:
      string: '{"template":"<%#\n    name: Finish timetravel\n    kind: finish\n%>\ncd
        /\nrm -rf *\n","locked":false,"snippet":false,"description":null,"created_at":"2024-07-03
        15:24:03 UTC","updated_at":"2024-07-03 15:24:03 UTC","id":257,"name":"A second
        provisioning template","template_kind_id":8,"template_kind_name":"finish","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '599'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=98
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/37
  response:
    body:
      string: "{\"template\":\"<%#\\nkind: kexec\\nname: Discovery Red Hat kexec\\nmodel:
        ProvisioningTemplate\\noses:\\n- CentOS 4\\n- CentOS 5\\n- CentOS 6\\n- CentOS
        7\\n- Fedora 21\\n- Fedora 22\\n- Fedora 23\\n- Fedora 24\\n- RedHat 4\\n-
        RedHat 5\\n- RedHat 6\\n- RedHat 7\\ndescription: |\\n  This template is used
        to pass command line options to kexec when reloading\\n  kernel on a discovered
        host instead of rebooting. This is useful in PXE-less\\n  environments. The
        template must generate JSON format with the following items\\n  \\\"kernel\\\",
        \\\"initram\\\", \\\"append\\\" and \\\"extra\\\". The kexec command is composed
        in\\n  the following way:\\n\\n  kexec --force --debug --append=$append --initrd=$initram
        $extra $kernel\\n\\n  Please read kexec(8) man page for more information about
        semantics.\\n  Extra options like --reset-vga can be set via \\\"extra\\\"
        array.\\nrequire:\\n- plugin: foreman_discovery\\n\uFFFC version: 22.0.0\\n-%>\\n<%\\n
        \ mac = @host.facts['discovery_bootif']\\n  bootif = host_param(\\\"hardware_type\\\",
        \\\"01\\\") + '-' + mac.gsub(':', '-') if mac\\n  ip_cidr = @host.facts['discovery_ip_cidr']\\n
        \ ip = @host.facts['discovery_ip']\\n  mask = @host.facts['discovery_netmask']\\n
        \ gw = @host.facts['discovery_gateway']\\n  dns = @host.facts['discovery_dns']\\n
        \ options = [\\\"nomodeset\\\"]\\n  options << @host.facts['append']\\n  if
        @host.operatingsystem.name != 'Fedora' && @host.operatingsystem.major.to_i
        >= 7 && host_param_true?('fips_enabled')\\n    options.push('fips=1')\\n  end\\n
        \ extra = []\\n  extra << \\\"--kexec-file-syscall\\\" if @host.pxe_loader.include?('SecureBoot')\\n-%>\\n{\\n\\\"kernel\\\":
        \\\"<%= @kernel_uri %>\\\",\\n\\\"initram\\\": \\\"<%= @initrd_uri %>\\\",\\n<%
        if (@host.operatingsystem.name == 'Fedora' and @host.operatingsystem.major.to_i
        > 16) or\\n  (@host.operatingsystem.name != 'Fedora' and @host.operatingsystem.major.to_i
        >= 7) -%>\\n  \\\"append\\\": \\\"inst.ks=<%= foreman_url('provision', { static:
        'yes' }) %> inst.ks.sendmac <%= \\\"ip=#{ip}::#{gw}:#{mask}:::none nameserver=#{dns}
        ksdevice=bootif BOOTIF=#{bootif} nomodeset nokaslr \\\" + options.compact.join('
        ') %>\\\",\\n<% else -%>\\n  \\\"append\\\": \\\"inst.ks=<%= foreman_url('provision',
        { static: 'yes' }) %> kssendmac nicdelay=5 <%= \\\"ip=#{ip} netmask=#{mask}
        gateway=#{gw} dns=#{dns} ksdevice=#{mac} BOOTIF=#{bootif} nomodeset nokaslr
        \\\" + options.compact.join(' ') %>\\\",\\n<% end -%>\\n\\\"extra\\\": <%=
        extra %>\\n}\\n\",\"locked\":false,\"snippet\":false,\"description\":\"This
        template is used to pass command line options to kexec when reloading\\nkernel
        on a discovered host instead of rebooting. This is useful in PXE-less\\nenvironments.
        The template must generate JSON format with the following items\\n\\\"kernel\\\",
        \\\"initram\\\", \\\"append\\\" and \\\"extra\\\". The kexec command is composed
        in\\nthe following way:\\n\\nkexec --force --debug --append=$append --initrd=$initram
        $extra $kernel\\n\\nPlease read kexec(8) man page for more information about
        semantics.\\nExtra options like --reset-vga can be set via \\\"extra\\\" array.\",\"created_at\":\"2024-06-27
        17:28:08 UTC\",\"updated_at\":\"2024-07-03 14:59:40 UTC\",\"id\":37,\"name\":\"Discovery
        Red Hat kexec\",\"template_kind_id\":15,\"template_kind_name\":\"kexec\",\"template_combinations\":[],\"operatingsystems\":[{\"id\":1,\"name\":\"RedHat\",\"title\":\"RHEL
        8.10\"}],\"os_default_templates\":[{\"id\":9,\"provisioning_template_id\":37,\"provisioning_template_name\":\"Discovery
        Red Hat kexec\",\"template_kind_id\":15,\"template_kind_name\":\"kexec\",\"operatingsystem_id\":1,\"operatingsystem_name\":\"RHEL
        8.10\"}],\"locations\":[{\"id\":12,\"name\":\"Test Location\",\"title\":\"Test
        Location\",\"description\":null}],\"organizations\":[{\"id\":1,\"name\":\"Default
        Organization\",\"title\":\"Default Organization\",\"description\":null},{\"id\":11,\"name\":\"Test
        Organization\",\"title\":\"Test Organization\",\"description\":\"A test organization\"}]}"
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '3720'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=97
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/38
  response:
    body:
      string: '{"template":"<%#\nkind: kexec\nname: Discovery Ubuntu kexec Autoinstall\nmodel:
        ProvisioningTemplate\noses:\n  - Ubuntu\ndescription: |\n  This template is
        used to pass command line options to kexec when reloading\n  kernel on a discovered
        host instead of rebooting. This is useful in PXE-less\n  environments. The
        template must generate JSON format with the following items\n  \"kernel\",
        \"initram\", \"append\" and \"extra\". The kexec command is composed in\n  the
        following way:\n\n  kexec --force --debug --append=$append --initrd=$initram
        $extra $kernel\n\n  Please read kexec(8) man page for more information about
        semantics.\n  Extra options like --reset-vga can be set via \"extra\" array.\nrequire:\n  -
        plugin: foreman_discovery\n    version: 19.0.1\n-%>\n<%\n  mac = @host.facts[''discovery_bootif'']\n  bootif
        = host_param(\"hardware_type\", \"01\") + ''-'' + mac.gsub('':'', ''-'') if
        mac\n  ip_cidr = @host.facts[''discovery_ip_cidr'']\n  ip = @host.facts[''discovery_ip'']\n  mask
        = @host.facts[''discovery_netmask'']\n  gw = @host.facts[''discovery_gateway'']\n  dns
        = @host.facts[''discovery_dns'']\n  identifier = @host.facts[''discovery_identifier'']\n  image_path
        = @preseed_path.sub(/\\/?$/, ''.iso'')\n  options = [\"nomodeset\", \"nokaslr\",
        \"auto=true\"]\n  options << @host.facts[''append'']\n  options << \"domain=#{@host.domain}\"\n  options
        << ''console-setup/ask_detect=false''\n  options << ''console-setup/layout=USA''\n  options
        << ''console-setup/variant=USA''\n  options << ''keyboard-configuration/layoutcode=us''\n  options
        << ''localechooser/translation/warn-light=true''\n  options << ''localechooser/translation/warn-severe=true''\n  options
        << \"locale=#{host_param(''lang'') || ''en_US''}\"\n  options << \"ip=#{ip}::#{gw}:#{mask}:#{@host.name}:#{identifier}:none:#{dns}\"\n  options
        << \"BOOTIF=#{bootif}\"\n  options << \"url=http://#{@preseed_server}#{image_path}\"\n  options
        << ''autoinstall''\n  options << \"ds=nocloud-net;s=http://#{foreman_request_addr}/userdata/\"\n  options
        << ''root=/dev/ram0''\n  options << ''ramdisk_size=1500000''\n  options <<
        ''fsck.mode=skip''\n  options << ''cloud-config-url=/dev/null''\n-%>\n{\n  \"kernel\":
        \"<%= @kernel_uri %>\",\n  \"initram\": \"<%= @initrd_uri %>\",\n  \"append\":
        \"<%= options.compact.join('' '') %>\",\n  \"extra\": []\n}\n\n","locked":false,"snippet":false,"description":"This
        template is used to pass command line options to kexec when reloading\nkernel
        on a discovered host instead of rebooting. This is useful in PXE-less\nenvironments.
        The template must generate JSON format with the following items\n\"kernel\",
        \"initram\", \"append\" and \"extra\". The kexec command is composed in\nthe
        following way:\n\nkexec --force --debug --append=$append --initrd=$initram
        $extra $kernel\n\nPlease read kexec(8) man page for more information about
        semantics.\nExtra options like --reset-vga can be set via \"extra\" array.","created_at":"2024-06-27
        17:28:08 UTC","updated_at":"2024-07-03 14:59:40 UTC","id":38,"name":"Discovery
        Ubuntu kexec Autoinstall","template_kind_id":15,"template_kind_name":"kexec","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '3432'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=96
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/76
  response:
    body:
      string: "{\"template\":\"<%#\\nkind: snippet\\nname: disk_enc_clevis_tang\\nmodel:
        ProvisioningTemplate\\nsnippet: true\\ndescription: |\\n  Binds encrypted
        root directory ('/') utilizing Clevis to Tang server(s) for\\n  decryption.
        The first parent device containing a LUKS container will be used.\\n  The
        temporary passphrase will be removed afterwards. Currently, only Red Hat\\n
        \ family and Ubuntu operating systems are supported.\\n-%>\\n<%\\n  passphrase
        = host_param('disk_enc_passphrase', 'linux')\\n  tang_server_list = []\\n
        \ packages_redhat = \\\"clevis clevis-luks clevis-systemd clevis-dracut\\\"\\n
        \ packages_ubuntu = \\\"clevis clevis-luks clevis-systemd clevis-initramfs\\\"\\n\\n
        \ unless host_param('disk_enc_tang_servers').blank?\\n    if host_param('disk_enc_tang_servers').is_a?(String)\\n
        \     tang_server_list = [host_param('disk_enc_tang_servers')]\\n    else\\n
        \     tang_server_list = host_param('disk_enc_tang_servers')\\n    end\\n
        \ end\\n-%>\\n\\n<% if (@host.operatingsystem.family == 'Redhat' || @host.operatingsystem.name
        == 'Ubuntu') && tang_server_list.present? -%>\\n\\ncat > /tmp/rootdir-luks-device.sh
        << \\\"EOF\\\"\\n#!/bin/sh\\n#\\n# Author Jan L\xF6ser <loeser@atix.de>\\n#
        Published under the GNU Public Licence 3\\n#\\n# This scripts tries to find
        the 1st LUKS device for / (root directory).\\n#\\nset -o pipefail\\n\\nrootdev=$(df
        / --output=source | tail -n1)\\ntargetdev=$(readlink -f $rootdev)\\nslavedev=$targetdev\\n\\nwhile
        : ; do\\n    /sbin/cryptsetup luksDump $slavedev &>/dev/null && echo $slavedev
        && exit 0\\n    set -e\\n    slave=$(find /sys/class/block/$(basename $slavedev)/slaves
        -type l | head -n1)\\n    slavedev=$(find /dev -name \\\"$(basename $slave)\\\"
        | head -n1)\\n    set +e\\ndone\\n\\nexit 1\\nEOF\\n\\n# needs bash here because
        Ubuntu's sh (dash) doesn't support `-o pipefail` option\\nluksdev=$(bash /tmp/rootdir-luks-device.sh)\\n\\nif
        [[ -n \\\"$luksdev\\\" ]]; then\\n  echo \\\"LUKS device found for '/': $luksdev\\\"\\n\\n<%
        if @host.operatingsystem.family == 'Redhat' -%>\\n  $PKG_MANAGER_INSTALL <%=
        packages_redhat %>\\n<% elsif @host.operatingsystem.name == 'Ubuntu' -%>\\n
        \ $PKG_MANAGER_INSTALL <%= packages_ubuntu %>\\n<% end -%>\\n\\n<% for tang_server
        in tang_server_list -%>\\n  echo '<%= passphrase %>' | clevis luks bind -y
        -k - -d $luksdev tang '{\\\"url\\\": \\\"<%= tang_server %>\\\"}'\\n  if [[
        $? -ne 0 ]]; then\\n    echo \\\"---\\\"\\n    echo \\\"There was an error
        during Clevis LUKS bind of '$luksdev' to Tang server '<%= tang_server %>'.\\\"\\n
        \   echo \\\"System halted.\\\"\\n    sleep infinity\\n  fi\\n<% end -%>\\n
        \ echo '<%= passphrase %>' | cryptsetup luksRemoveKey $luksdev\\n  systemctl
        enable clevis-luks-askpass.path\\n  systemctl enable remote-cryptsetup.target\\n\\n<%
        if @host.operatingsystem.family == 'Redhat' -%>\\n  dracut --verbose --force
        --hostonly-cmdline --regenerate-all\\n<% elsif @host.operatingsystem.name
        == 'Ubuntu' -%>\\n  update-initramfs -u -k 'all'\\n<% end -%>\\n\\nelse\\n
        \ echo \\\"No LUKS device found!\\\"\\nfi\\n\\n<% end -%>\\n\",\"locked\":false,\"snippet\":true,\"description\":\"Binds
        encrypted root directory ('/') utilizing Clevis to Tang server(s) for\\ndecryption.
        The first parent device containing a LUKS container will be used.\\nThe temporary
        passphrase will be removed afterwards. Currently, only Red Hat\\nfamily and
        Ubuntu operating systems are supported.\",\"created_at\":\"2024-06-27 17:28:08
        UTC\",\"updated_at\":\"2024-07-03 14:59:40 UTC\",\"id\":76,\"name\":\"disk_enc_clevis_tang\",\"template_kind_id\":null,\"template_kind_name\":null,\"template_combinations\":[],\"operatingsystems\":[],\"os_default_templates\":[],\"locations\":[{\"id\":12,\"name\":\"Test
        Location\",\"title\":\"Test Location\",\"description\":null}],\"organizations\":[{\"id\":1,\"name\":\"Default
        Organization\",\"title\":\"Default Organization\",\"description\":null},{\"id\":11,\"name\":\"Test
        Organization\",\"title\":\"Test Organization\",\"description\":\"A test organization\"}]}"
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '3790'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=95
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/77
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: efibootmgr_netboot\nmodel: ProvisioningTemplate\ndescription:
        Configure booting from network in EFI\nsnippet: true\ndescription: |\n  Most
        EFI system firmware implementations put new items to the top of the boot priority
        list. Foreman workflow assumes that managed nodes always boot from network.
        This snippet can be included from provisioning templates and when \"efi_bootentry\"
        host param is set to \"previous\" it will attempt to find previous boot entry
        (network) and put it back into first position.\n-%>\n<% if host_param(''efi_bootentry'')
        == ''previous'' -%>\nif [ -d /sys/firmware/efi ]; then\n  echo \"Changing
        EFI boot order to preserve boot. Typically the previous entry\"\n  echo \"was
        network boot in netboot workflows but this can also break things.\"\n  echo
        \"In that case use efi_keep_bootorder host parameter to keep it untouched.\"\n  echo
        \"Boot order is currently:\"\n  efibootmgr\n  echo\n  created_entry=$(efibootmgr
        | grep \"BootOrder\" | cut -d \" \" -f 2 | cut -d \",\" -f 1)\n  others=$(efibootmgr
        | grep \"BootOrder\" | cut -d \" \" -f 2 | cut -d \",\" -f 2-)\n  new_order=\"${others},${created_entry}\"\n  echo
        \"Found entry ${created_entry}, changing order to:\"\n  efibootmgr -o ${new_order}\n  echo\nfi\n<%
        elsif (entry = host_param(''efi_bootentry'')) -%>\nif [ -d /sys/firmware/efi
        ]; then\n  echo \"Trying to find EFI boot entry containing: <%= entry -%>\"\n  echo
        \"Boot order is currently:\"\n  efibootmgr\n  echo\n  current=$(efibootmgr
        | grep \"BootOrder\" | cut -d \" \" -f 2)\n  id=$(efibootmgr | grep -E ''^Boot[0-9]+''
        | grep -E ''a'' | efibootmgr | grep -E ''^Boot[0-9]+'' | grep -E ''<%= entry
        -%>'' | cut -c5-8)\n  echo \"Found entry ${id}, changing order to:\"\n  efibootmgr
        -o ${id},${current}\n  echo\nfi\n<% end -%>\n","locked":false,"snippet":true,"description":"Most
        EFI system firmware implementations put new items to the top of the boot priority
        list. Foreman workflow assumes that managed nodes always boot from network.
        This snippet can be included from provisioning templates and when \"efi_bootentry\"
        host param is set to \"previous\" it will attempt to find previous boot entry
        (network) and put it back into first position.","created_at":"2024-06-27 17:28:08
        UTC","updated_at":"2024-07-03 14:59:40 UTC","id":77,"name":"efibootmgr_netboot","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '2751'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=94
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/78
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: eject_cdrom\nmodel: ProvisioningTemplate\nsnippet:
        true\ndescription: |\n  This template will eject DVD/CD ROM for bootdisk provisioning
        method,\n  typically called in the final phase of the main provisioning template,\n  such
        as %post section of Kickstart or Preseed Finish.\n-%>\n<% if @host.respond_to?(:bootdisk_build?)
        && @host.bootdisk_build? -%>\neject -v\n<% end -%>\n","locked":false,"snippet":true,"description":"This
        template will eject DVD/CD ROM for bootdisk provisioning method,\ntypically
        called in the final phase of the main provisioning template,\nsuch as %post
        section of Kickstart or Preseed Finish.","created_at":"2024-06-27 17:28:08
        UTC","updated_at":"2024-07-03 14:59:40 UTC","id":78,"name":"eject_cdrom","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1190'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=93
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/79
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: epel\nmodel: ProvisioningTemplate\nsnippet:
        true\ndescription: |\n  Installs the epel RPM from the official online EPEL
        repository. Supports\n  using the http proxy through host parameters.\n-%>\n<%\nrepo_base  =
        host_param(''epel-repo-base'') ? host_param(''epel-repo-base'') : ''https://dl.fedoraproject.org/pub/epel''\nhttp_proxy
        = host_param(''http-proxy'') ? \" --httpproxy #{host_param(''http-proxy'')}\"
        : nil\nhttp_port  = host_param(''http-proxy-port'') ? \" --httpport #{host_param(''http-proxy-port'')}\"
        : nil\nos_major   = @host.operatingsystem.major.to_i\n-%>\nrpm -Uvh<%= http_proxy
        %><%= http_port %> <%= repo_base %>/epel-release-latest-<%= os_major %>.noarch.rpm\n","locked":false,"snippet":true,"description":"Installs
        the epel RPM from the official online EPEL repository. Supports\nusing the
        http proxy through host parameters.","created_at":"2024-06-27 17:28:08 UTC","updated_at":"2024-07-03
        14:59:40 UTC","id":79,"name":"epel","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1398'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=92
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/80
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: fips_packages\nmodel: ProvisioningTemplate\nsnippet:
        true\ndescription: |\n  Used to adjusts packages in Kickstart template on
        FIPS enabled OS.\n-%>\ndracut-fips\n-prelink\n","locked":false,"snippet":true,"description":"Used
        to adjusts packages in Kickstart template on FIPS enabled OS.","created_at":"2024-06-27
        17:28:08 UTC","updated_at":"2024-07-03 14:59:40 UTC","id":80,"name":"fips_packages","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '859'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=91
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/81
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: fix_hosts\nmodel: ProvisioningTemplate\nsnippet:
        true\ndescription: |\n  Used in user_data templates for setting the correct
        content of the /etc/hosts file.\n  The goal is to potentially fix incorrect
        hosts file that is baked in the image\n  used for the provisioning.\n-%>\necho
        \"<%= @host.shortname %>\" > /etc/hostname\n<% if @host.operatingsystem.family
        == ''Redhat'' && @host.operatingsystem.major.to_i == 6 %>\nhostname <%= @host
        %>\n<% else %>\nhostname <%= @host.shortname %>\n<% end %>\ncat > /etc/hosts
        << EOF\n<%# simple snippet to generate /etc/hosts when provisioning image
        based systems -%>\n127.0.0.1   <%= @host %> <%= @host.shortname %> localhost
        localhost.localdomain\n::1     ip6-localhost ip6-loopback\nfe00::0 ip6-localnet\nff00::0
        ip6-mcastprefix\nff02::1 ip6-allnodes\nff02::2 ip6-allrouters\nEOF\n","locked":false,"snippet":true,"description":"Used
        in user_data templates for setting the correct content of the /etc/hosts file.\nThe
        goal is to potentially fix incorrect hosts file that is baked in the image\nused
        for the provisioning.","created_at":"2024-06-27 17:28:08 UTC","updated_at":"2024-07-03
        14:59:40 UTC","id":81,"name":"fix_hosts","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1627'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=90
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/40
  response:
    body:
      string: '{"template":"<%#\nkind: finish\nname: FreeBSD (mfsBSD) finish\nmodel:
        ProvisioningTemplate\noses:\n- FreeBSD\ndescription: |\n  A finish template
        executed at the end of network provisioning or\n  after the image based provisioning
        is done using the image without user data.\n  It is only used for FreeBSD
        with mfsBSD toolset.\n  It supports deploying puppet and salt agents.\n-%>\n<%\n  #
        safemode renderer does not support unary negation\n  puppet_enabled = !host_param_true?(''skip-puppet-setup'')
        && (host_puppet_server.present? || host_param_true?(''force-puppet''))\n  salt_enabled
        = host_param(''salt_master'') ? true : false\n  proxy_string = host_param(''http-proxy'')
        ? \"http://#{host_param(''http-proxy'')}:#{host_param(''http-proxy-port'')}\"
        : ''''\n%>\n<% unless proxy_string == '''' -%>\nexport http_proxy=''<%= proxy_string
        %>''\n<% end -%>\n/bin/echo ''<%= root_pass %>'' | pw usermod root -H 0\ncat
        >> /etc/rc.conf <<EOF\nhostname=\"<%= @host %>\"\nsshd_enable=\"YES\"\nntpd_enable=\"YES\"\nEOF\n\necho
        ifconfig_`ifconfig -l | cut -d '' '' -f 1`=DHCP >>/etc/rc.conf\n\necho ''PermitRootLogin
        yes'' >> /etc/ssh/sshd_config\n\n/bin/hostname <%= @host.name %>\ncp /usr/share/zoneinfo/<%=
        host_param(''time-zone'') || ''UTC'' %> /etc/localtime\nadjkerntz -a\nntpdate
        <%= host_param(''ntp-server'') || ''0.freebsd.pool.ntp.org'' %>\n\nmkdir /root/install/\nfreebsd-update
        fetch > /root/install/freebsd-update_fetch.txt\nfreebsd-update install > /root/install/freebsd-update_install.txt\n\nenv
        ASSUME_ALWAYS_YES=YES pkg bootstrap\npkg update > /root/install/pkg_update.txt\npkg
        upgrade -y > /root/install/pkg_upgrade.txt\n\n<% if puppet_enabled %>\n<%=
        snippet ''puppet_setup'' %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet
        ''saltstack_setup'' %>\n<% end -%>\n<%= snippet(''remote_execution_ssh_keys'')
        %>\n\n<%= snippet ''schedule_reboot'' -%>\n\nexit 0\n","locked":false,"snippet":false,"description":"A
        finish template executed at the end of network provisioning or\nafter the
        image based provisioning is done using the image without user data.\nIt is
        only used for FreeBSD with mfsBSD toolset.\nIt supports deploying puppet and
        salt agents.","created_at":"2024-06-27 17:28:08 UTC","updated_at":"2024-07-03
        14:59:40 UTC","id":40,"name":"FreeBSD (mfsBSD) finish","template_kind_id":8,"template_kind_name":"finish","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '2668'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=89
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/61
  response:
    body:
      string: '{"template":"<%#\nkind: provision\nname: FreeBSD (mfsBSD) provision\nmodel:
        ProvisioningTemplate\noses:\n- FreeBSD\ndescription: |\n  Provisioning template
        for the FreeBSD.\n  It prepares the environment and deploys and runs the Finish
        template.\n  See FreeBSD (mfsbsd) finish template for more details.\n-%>\n<%\nproxy_string
        = host_param(''http-proxy'') ? \"http://#{host_param(''http-proxy'')}:#{host_param(''http-proxy-port'')}\"
        : ''''\n%>\n<% unless proxy_string == '''' -%>\nexport http_proxy=''<%= proxy_string
        %>''\n<% end -%>\n\n# Get the disk layout, and the first disk connected to
        the system\ndisk_layout=`/sbin/sysctl -n kern.disks | /usr/bin/sed ''s/cd[0-9]//g''`\nfirst_disk=\"`echo
        ${disk_layout##*[1-9]} | /usr/bin/cut -d'' '' -f1`\"\ntest -z \"$first_disk\"
        || echo \"First disk: $first_disk\"\n\n/root/bin/destroygeom -d <%= host_param(''install-disk'')
        || ''$first_disk'' %> || exit 1\n/root/bin/zfsinstall -d <%= host_param(''install-disk'')
        || ''$first_disk'' %> -s 2G -u <%= @mediapath %> || exit 1\n\ncp /etc/resolv.conf
        /mnt/etc/resolv.conf\nmount -t devfs devfs /mnt/dev\nfetch -q --no-verify-hostname
        --no-verify-peer -o /mnt/tmp/finish.sh -d <%= foreman_url(''finish'') %>\nchroot
        /mnt /bin/sh /tmp/finish.sh\nrm /mnt/tmp/finish.sh\n\nfetch -q --no-verify-hostname
        --no-verify-peer -o /dev/null -d <%= foreman_url(''built'') %>\nsleep 5\nreboot\n","locked":false,"snippet":false,"description":"Provisioning
        template for the FreeBSD.\nIt prepares the environment and deploys and runs
        the Finish template.\nSee FreeBSD (mfsbsd) finish template for more details.","created_at":"2024-06-27
        17:28:08 UTC","updated_at":"2024-07-03 14:59:40 UTC","id":61,"name":"FreeBSD
        (mfsBSD) provision","template_kind_id":7,"template_kind_name":"provision","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '2111'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=88
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/16
  response:
    body:
      string: '{"template":"<%#\nkind: PXELinux\nname: FreeBSD (mfsBSD) PXELinux\nmodel:
        ProvisioningTemplate\noses:\n- FreeBSD\ndescription: |\n  The template to
        render PXELinux bootloader configuration for FreeBSD.\n  The output is deployed
        on the host''s subnet TFTP proxy.\n-%>\n# foreman_url=<%= foreman_url(''provision'')
        %>\nDEFAULT freebsd\n\nLABEL freebsd\n    KERNEL memdisk\n    APPEND initrd=<%=
        @initrd %> harddisk raw\n","locked":false,"snippet":false,"description":"The
        template to render PXELinux bootloader configuration for FreeBSD.\nThe output
        is deployed on the host''s subnet TFTP proxy.","created_at":"2024-06-27 17:28:07
        UTC","updated_at":"2024-07-03 14:59:41 UTC","id":16,"name":"FreeBSD (mfsBSD)
        PXELinux","template_kind_id":3,"template_kind_name":"PXELinux","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1138'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=87
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/82
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: freeipa_register\nmodel: ProvisioningTemplate\nsnippet:
        true\ndescription: |\n  Installs IPA client and enrolls the host in IPA realm
        using the OTP\n  Optional parameters:\n    freeipa_server              IPA
        server\n    freeipa_sudo                Enable sudoers\n    freeipa_ssh                 Enable
        ssh integration\n                                Default: true\n    freeipa_automount           Enable
        automounter\n                                Default: false\n    freeipa_automount_location  Location
        for automounts\n    freeipa_mkhomedir           Enable automatically making
        home directories\n                                Default: true\n    freeipa_opts                Additional
        options to pass directly to installer\n    freeipa_automount_server    Override
        automount server if freeipa_automount is true and the server differs from
        freeipa_server\n-%>\n<% if @host.operatingsystem.family == ''Redhat'' -%>\n  <%
        if @host.operatingsystem.name == ''Fedora'' -%>\n    freeipa_client=freeipa-client\n  <%
        else -%>\n    freeipa_client=ipa-client\n  <% end -%>\n  <% os_major = @host.operatingsystem.major.to_i
        %>\n  <% if os_major == 7 -%>\n    /usr/sbin/sshd-keygen\n  <% elsif os_major
        > 7 %>\n    /usr/libexec/openssh/sshd-keygen rsa\n  <% end -%>\n<% else -%>\n  freeipa_client=freeipa-client\n<%
        end -%>\n\n<%= @host.operatingsystem.family == ''Redhat'' ? ''yum install
        -y libsss_sudo'' : ''DEBIAN_FRONTEND=noninteractive apt-get install -y libsss-sudo''
        %> $freeipa_client\n\n##\n## IPA Client Installation\n##\n<% if host_param(''freeipa_server'')
        -%>\n<% domain = host_param(''freeipa_domain'') || @host.realm.name.downcase
        -%>\n\nfreeipa_server=\"--server <%= host_param(''freeipa_server'') %>\"\nfreeipa_domain=\"--domain
        <%= domain %>\"\n<% end -%>\n\n<% unless host_param_false?(''freeipa_mkhomedir'')
        %>\nfreeipa_mkhomedir=\"--mkhomedir\"\n<% end -%>\n\n<% if host_param_false?(''freeipa_ssh'')
        %>\nfreeipa_ssh=\"--no-ssh\"\n<% end -%>\n\n<% if host_param(''freeipa_opts'')
        -%>\nfreeipa_opts=\"<%= host_param(''freeipa_opts'') %>\"\n<% end -%>\n\n#
        One-time password will be requested at install time. Otherwise, $HOST[OTP]
        is used as a placeholder value.\n/usr/sbin/ipa-client-install -w ''<%= @host.otp
        || \"$HOST[OTP]\" %>'' --realm=<%= @host.realm %> -U $freeipa_mkhomedir $freeipa_opts
        $freeipa_server $freeipa_domain $freeipa_ssh\n\n##\n## Automounter\n##\n\n<%
        if host_param(''freeipa_automount_location'') -%>\nautomount_location=\"--location
        <%= host_param(''freeipa_automount_location'') %>\"\n<% end -%>\n\n<% if host_param_true?(''freeipa_automount'')
        -%>\nif [ -f /usr/sbin/ipa-client-automount ]\nthen\n  automount_server=$freeipa_server\n  <%-
        if automount_server = host_param(''freeipa_automount_server'') || host_param(''freeipa_server'')
        -%>\n  automount_server=\"--server <%= automount_server %>\"\n  <%- end -%>\n  /usr/sbin/ipa-client-automount
        $automount_server $automount_location --unattended\nfi\n<% end -%>\n\n##\n##
        Sudoers\n##\n\n<% unless host_param_false?(''freeipa_enable_sudo'') %>\n\nfreeipa_client_version=$(ipa-client-install
        --version)\nfreeipa_client_version_major=$(echo $freeipa_client_version |
        cut -f1 -d.)\nfreeipa_client_version_minor=$(echo $freeipa_client_version
        | cut -f2 -d.)\nfreeipa_realm=$(grep default_realm /etc/krb5.conf | cut -d\"=\"
        -f2 | tr -d '' '')\nfreeipa_domain=$(grep -A 2 domain_realm /etc/krb5.conf
        | tail -n1 | awk ''{print $1}'')\nfreeipa_dn=$(for word in $(echo $freeipa_domain
        | sed ''s/\\./ /g''); do echo -n dc=$word,; done)\nsssd_version=$(sssd --version)\nsssd_major=$(echo
        $sssd_version | cut -f1 -d.)\nsssd_minor=$(echo $sssd_version | cut -f2 -d.)\nLDAP_CONFIG=$(mktemp)\n\n#
        >=ipa-client-4.1.0 automatically configures sssd for sudo\n# =<ipa-client-3
        requires manual configuration which this snippet takes care of\n\nif [ $freeipa_client_version_major
        -lt 4 ]\nthen\n  # Modify sssd.conf\n  sed -i -e \"s/services = .*/\\0, sudo/\"
        /etc/sssd/sssd.conf\n\n  # Modify sssd.conf for sssd <1.11 (RHEL <6.6)\n  if
        [ $sssd_minor -lt 11 ] || [ $sssd_major -lt 1 ]\n  then\n    <% if host_param(''freeipa_server'')
        -%>\n    ldap_uri=\", ldap://<%= host_param(''freeipa_server'') %>\"\n    krb5_server=<%=
        host_param(''freeipa_server'') %>\n    <% else -%>\n    krb5_server=\"_srv_\"\n    <%
        end -%>\n\ncat <<EOF > $LDAP_CONFIG\nsudo_provider = ldap\nldap_uri = _srv_
        $ldap_uri\nldap_sudo_search_base = ou=SUDOers,${freeipa_dn%?}\nldap_sasl_mech
        = GSSAPI\nldap_sasl_authid = host/$HOSTNAME\nldap_sasl_realm = $freeipa_realm\nkrb5_server
        = $krb5_server\nEOF\n  sed -i -e \"/\\[domain\\/.*\\]/ r $LDAP_CONFIG\" /etc/sssd/sssd.conf\n  fi\n\n  #
        Modify nsswitch.conf\n  grep -q sudoers /etc/nsswitch.conf\n  if [[ $? -eq
        0 ]];\n  then\n    sed -i -e \"s/^sudoers.*/sudoers:    files sss/\" /etc/nsswitch.conf\n  else\n    echo
        \"sudoers:    files sss\" >> /etc/nsswitch.conf\n  fi\n\n  # Configure nisdomain\n  <%
        if @host.operatingsystem.family == ''Redhat'' -%>\n    authconfig --nisdomain
        ${freeipa_domain} --update\n    chkconfig sssd on\n    \n    if [[ $(rpm -qa
        systemd | wc -l) -gt 0 ]];\n    then\n      domain_service=/usr/lib/systemd/system/*-domainname.service\n      \n      #
        Workaround for BZ1071969 on RHEL 7.0\n      grep -q \"DefaultDependencies=no\"
        $domain_service\n      if [[ $? -ne 0 ]]\n      then\n        sed -i -e \"s/\\[Unit\\]/\\[Unit\\]\\nDefaultDependencies=no/\"
        $domain_service\n      fi\n\n      systemctl start $(basename $domain_service)\n      systemctl
        enable $(basename $domain_service)\n    fi\n  <% else -%>\n  # OS is not RedHat\n  sed
        -i -e ''/^exit /d'' /etc/rc.local\n  echo \"nisdomainname ${freeipa_domain}\"
        >> /etc/rc.local\n  echo \"exit 0\" >> /etc/rc.local\n  nisdomainname ${freeipa_domain}  \n  <%
        end -%>\nfi\n\n<% end -%>\n\n","locked":false,"snippet":true,"description":"Installs
        IPA client and enrolls the host in IPA realm using the OTP\nOptional parameters:\n  freeipa_server              IPA
        server\n  freeipa_sudo                Enable sudoers\n  freeipa_ssh                 Enable
        ssh integration\n                              Default: true\n  freeipa_automount           Enable
        automounter\n                              Default: false\n  freeipa_automount_location  Location
        for automounts\n  freeipa_mkhomedir           Enable automatically making
        home directories\n                              Default: true\n  freeipa_opts                Additional
        options to pass directly to installer\n  freeipa_automount_server    Override
        automount server if freeipa_automount is true and the server differs from
        freeipa_server","created_at":"2024-06-27 17:28:08 UTC","updated_at":"2024-07-03
        14:59:41 UTC","id":82,"name":"freeipa_register","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '7094'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=86
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/70
  response:
    body:
      string: '{"template":"<%#\nkind: registration\nname: Global Registration\nmodel:
        ProvisioningTemplate\ndescription: |\n  The registration template used to
        render OS agnostic script that any host can use to register to\n  this Foreman
        instance. It is rendered as a response in the registration API endpoint. The
        resulting\n  script contains instructions to prepare the machine for registration,
        to create a new Host record in Foreman,\n  and to fetch and run the host specific
        initial configuration script. The initial script is rendered based\n  on the
        template of host_init_config kind.\n-%>\n#!/bin/sh\n\n# Make sure, all command
        output can be parsed (e.g. from subscription-manager)\nexport LC_ALL=C LANG=C\n<%\n    headers
        = [\"-H ''Authorization: Bearer #{@auth_token}''\"]\n    activation_keys =
        [(@hostgroup.params[''kt_activation_keys''] if @hostgroup), @activation_keys].compact.join('','')\n-%>\n\n#
        Rendered with following template parameters:\n<%= \"# User: [#{@user.login}]\"
        if @user -%>\n<%= \"\\n# Organization: [#{@organization.name}]\" if @organization
        -%>\n<%= \"\\n# Location: [#{@location.name}]\" if @location -%>\n<%= \"\\n#
        Host group: [#{@hostgroup.title}]\" if @hostgroup -%>\n<%= \"\\n# Operating
        system: [#{@operatingsystem}]\" if @operatingsystem -%>\n<%= \"\\n# Setup
        Insights: [#{@setup_insights}]\" unless @setup_insights.nil? -%>\n<%= \"\\n#
        Setup remote execution: [#{@setup_remote_execution}]\" unless @setup_remote_execution.nil?
        -%>\n<%= \"\\n# Setup remote execution pull: [#{@setup_remote_execution_pull}]\"
        unless @setup_remote_execution_pull.nil? -%>\n<%= \"\\n# Remote execution
        interface: [#{@remote_execution_interface}]\" if @remote_execution_interface.present?
        -%>\n<%= \"\\n# Packages: [#{@packages}]\" if @packages.present? -%>\n<%=
        \"\\n# Update packages: [#{@update_packages}]\" unless @update_packages.nil?
        -%>\n<%= \"\\n# Repository data: [#{@repo_data}]\" if @repo_data.present?
        -%>\n<%= \"\\n# Force: [#{@force}]\" unless @force.nil? -%>\n<%= \"\\n# Ignore
        subman errors: [#{@ignore_subman_errors}]\" unless @ignore_subman_errors.nil?
        -%>\n<%= \"\\n# Lifecycle environment id: [#{@lifecycle_environment_id}]\"
        if @lifecycle_environment_id.present? -%>\n<%= \"\\n# Activation keys: [#{activation_keys}]\"
        if activation_keys.present? -%>\n\n\nif ! [ $(id -u) = 0 ]; then\n  echo \"Please
        run as root\"\n  exit 1\nfi\n\n# Select package manager for the OS (sets the
        $PKG_MANAGER* variables)\n<%= snippet ''pkg_manager'' %>\n\nSSL_CA_CERT=$(mktemp)\ncat
        << EOF > $SSL_CA_CERT\n<%= foreman_server_ca_cert %>\nEOF\n\ncleanup_and_exit()
        {\n  rm -f $SSL_CA_CERT\n  exit $1\n}\n\n<%= snippet_if_exists(''before_registration'')
        -%>\n\n<% unless @repo_data.blank? -%>\n<% index = 0 %>\n<% @repo_data.each
        do |repo, repo_gpg_key_url| -%>\necho ''#''\necho ''# Adding repository''\necho
        ''#''\n\n<% index += 1 %>\nif [ x$PKG_MANAGER = xdnf -o x$PKG_MANAGER = xyum
        -o x$PKG_MANAGER = xzypper ]; then\n  cat << EOF > /tmp/foreman_registration.repo\n[foreman_register<%=
        index %>]\nname=foreman_register<%= index %>\nbaseurl=<%= shell_escape repo
        %>\nenabled=1\ntype=rpm-md\nEOF\n<% if repo_gpg_key_url.present? -%>\n  echo
        gpgcheck=1 >> /tmp/foreman_registration.repo\n  echo gpgkey=<%= shell_escape
        repo_gpg_key_url %> >> /tmp/foreman_registration.repo\n<% else -%>\n  echo
        gpgcheck=0 >> /tmp/foreman_registration.repo\n<% end -%>\n  if [ x$PKG_MANAGER
        = xdnf -o x$PKG_MANAGER = xyum ]; then\n    mv -f /tmp/foreman_registration.repo
        /etc/yum.repos.d/foreman_registration<%= index %>.repo\n    echo \"Building
        yum metadata cache, this may take a few minutes\"\n    $PKG_MANAGER makecache\n  else\n    zypper
        --quiet --non-interactive addrepo /tmp/foreman_registration.repo\n  fi\nelif
        [ -f /etc/debian_version ]; then\n  <%= save_to_file(\"/etc/apt/sources.list.d/foreman_registration#{index}.list\",
        repo) %>\n<% if repo_gpg_key_url.present? -%>\n<%# \"apt 1.2.35\" on Ubuntu
        16.04 does not support storing GPG public keys in \"/etc/apt/trusted.gpg.d/\"
        in ASCII format -%>\n  if [ \"$(. /etc/os-release ; echo \"$VERSION_ID\")\"
        = \"16.04\" ]; then\n    $PKG_MANAGER_INSTALL ca-certificates curl gnupg\n    curl
        --silent --show-error <%= shell_escape repo_gpg_key_url %> | gpg --dearmor
        > /etc/apt/trusted.gpg.d/client<%= index %>.gpg\n  else\n    $PKG_MANAGER_INSTALL
        ca-certificates curl\n    curl --silent --show-error --output /etc/apt/trusted.gpg.d/client<%=
        index %>.asc <%= shell_escape repo_gpg_key_url %>\n  fi\n<% end -%>\n  apt-get
        update\n\nelse\n  echo \"Unsupported operating system, can''t add repository.\"\n  cleanup_and_exit
        1\nfi\n<% end -%>\n<% end -%>\n\nregister_host() {\n  curl --silent --show-error
        --cacert $SSL_CA_CERT --request POST <%= @registration_url %> \\\n       <%=
        headers.join('' '') %> \\\n       --data \"host[name]=$(hostname --fqdn)\"
        \\\n       --data \"host[build]=false\" \\\n       --data \"host[managed]=false\"
        \\\n<%= \"       --data ''host[organization_id]=#{@organization.id}'' \\\\\\n\"
        if @organization -%>\n<%= \"       --data ''host[location_id]=#{@location.id}''
        \\\\\\n\" if @location -%>\n<%= \"       --data ''host[hostgroup_id]=#{@hostgroup.id}''
        \\\\\\n\" if @hostgroup -%>\n<%= \"       --data ''host[operatingsystem_id]=#{@operatingsystem.id}''
        \\\\\\n\" if @operatingsystem -%>\n<%= \"       --data host[interfaces_attributes][0][identifier]=#{shell_escape(@remote_execution_interface)}
        \\\\\\n\" if @remote_execution_interface.present? -%>\n<%= \"       --data
        ''setup_insights=#{@setup_insights}'' \\\\\\n\" unless @setup_insights.nil?
        -%>\n<%= \"       --data ''setup_remote_execution=#{@setup_remote_execution}''
        \\\\\\n\" unless @setup_remote_execution.nil? -%>\n<%= \"       --data remote_execution_interface=#{shell_escape(@remote_execution_interface)}
        \\\\\\n\" if @remote_execution_interface.present? -%>\n<%= \"       --data
        packages=#{shell_escape(@packages)} \\\\\\n\" if @packages.present? -%>\n<%=
        \"       --data ''update_packages=#{@update_packages}'' \\\\\\n\" unless @update_packages.nil?
        -%>\n\n}\n\necho \"#\"\necho \"# Running registration\"\necho \"#\"\n\n<%
        if plugin_present?(''katello'') && activation_keys.present? -%>\nregister_katello_host(){\n    UUID=$(subscription-manager
        identity | grep --max-count 1 --only-matching ''\\([[:xdigit:]]\\{8\\}-[[:xdigit:]]\\{4\\}-[[:xdigit:]]\\{4\\}-[[:xdigit:]]\\{4\\}-[[:xdigit:]]\\{12\\}\\)'')\n    curl
        --silent --show-error --cacert $KATELLO_SERVER_CA_CERT --request POST \"<%=
        @registration_url %>\" \\\n         <%= headers.join('' '') %> \\\n         --data
        \"uuid=$UUID\" \\\n         --data \"host[build]=false\" \\\n<%= \"      --data
        ''host[organization_id]=#{@organization.id}'' \\\\\\n\" if @organization -%>\n<%=
        \"      --data ''host[location_id]=#{@location.id}'' \\\\\\n\" if @location
        -%>\n<%= \"      --data ''host[hostgroup_id]=#{@hostgroup.id}'' \\\\\\n\"
        if @hostgroup -%>\n<%= \"      --data ''host[lifecycle_environment_id]=#{@lifecycle_environment_id}''
        \\\\\\n\" if @lifecycle_environment_id.present? -%>\n<%= \"      --data ''setup_insights=#{@setup_insights}''
        \\\\\\n\" unless @setup_insights.nil? -%>\n<%= \"      --data ''setup_remote_execution=#{@setup_remote_execution}''
        \\\\\\n\" unless @setup_remote_execution.nil? -%>\n<%= \"      --data remote_execution_interface=#{shell_escape(@remote_execution_interface)}
        \\\\\\n\" if @remote_execution_interface.present? -%>\n<%= \"      --data
        ''setup_remote_execution_pull=#{@setup_remote_execution_pull}'' \\\\\\n\"
        unless @setup_remote_execution_pull.nil? -%>\n<%= \"      --data packages=#{shell_escape(@packages)}
        \\\\\\n\" if @packages.present? -%>\n<%= \"      --data ''update_packages=#{@update_packages}''
        \\\\\\n\" unless @update_packages.nil? -%>\n\n}\n\n# Set up subscription-manager\n<%=
        snippet(\"subscription_manager_setup\", variables: { subman_setup_scenario:
        ''registration'' }).strip -%>\n\nsubscription-manager register <%= ''--force''
        if truthy?(@force) %> \\\n  --org=''<%= @organization.label if @organization
        %>'' \\\n  --activationkey=''<%= activation_keys %>'' || <%= truthy?(@ignore_subman_errors)
        ? ''true'' : ''cleanup_and_exit 1'' %>\n\nregister_katello_host | bash\n<%
        else -%>\nregister_host | bash\n<% end -%>\n\n<%= snippet_if_exists(''after_registration'')
        -%>\n\ncleanup_and_exit\n","locked":false,"snippet":false,"description":"The
        registration template used to render OS agnostic script that any host can
        use to register to\nthis Foreman instance. It is rendered as a response in
        the registration API endpoint. The resulting\nscript contains instructions
        to prepare the machine for registration, to create a new Host record in Foreman,\nand
        to fetch and run the host specific initial configuration script. The initial
        script is rendered based\non the template of host_init_config kind.","created_at":"2024-06-27
        17:28:08 UTC","updated_at":"2024-07-03 14:59:41 UTC","id":70,"name":"Global
        Registration","template_kind_id":14,"template_kind_name":"registration","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '9241'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=85
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/72
  response:
    body:
      string: '{"template":"#!/bin/bash\n<%#\nkind: script\nname: Grubby default\nmodel:
        ProvisioningTemplate\ndescription: |\n  Script that can be manually downloaded
        to a server to reprovision it without booting from network.\n  Grubby compatibility
        package must be installed. WARNING: It will immediately reconfigure\n  bootloader
        and reprovision the node.\n  \n  Usage:\n  curl https://foreman/unattended/script
        -o reprovision.sh\n  bash reprovision.sh\n  reboot\n-%>\n\nKERNEL=\"/boot/kernel\"\nINITRD=\"/boot/initrd.img\"\n\nwget
        -O \"$KERNEL\" \"<%= @host.url_for_boot(:kernel) %>\"\nwget -O \"$INITRD\"
        \"<%= @host.url_for_boot(:initrd) %>\"\n\ngrubby --add-kernel=$KERNEL --initrd=$INITRD  --copy-default
        --title \"<%= @host.operatingsystem %>\" --make-default  --args=\"inst.ks=<%=
        foreman_url(''provision'')%>\"\n","locked":false,"snippet":false,"description":"Script
        that can be manually downloaded to a server to reprovision it without booting
        from network.\nGrubby compatibility package must be installed. WARNING: It
        will immediately reconfigure\nbootloader and reprovision the node.\n\nUsage:\ncurl
        https://foreman/unattended/script -o reprovision.sh\nbash reprovision.sh\nreboot","created_at":"2024-06-27
        17:28:08 UTC","updated_at":"2024-07-03 14:59:41 UTC","id":72,"name":"Grubby
        default","template_kind_id":9,"template_kind_name":"script","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1714'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=84
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/83
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: http_proxy\nmodel: ProvisioningTemplate\nsnippet:
        true\ndescription: |\n  Configures common HTTP proxy ENV variables based on
        the host_proxy\n  host parameter. Currently not used by any shipped template.\n-%>\n<%
        if (proxy = host_param(\"http_proxy\")) -%>\nhttp_proxy=<%= proxy %>\nexport
        http_proxy\nhttps_proxy=<%= proxy %>\nexport https_proxy\nno_proxy=localhost,127.0.0.0/8,*.local,*.<%=
        @host.domain.name -%>,puppet\nexport no_proxy\n<% end -%>\n","locked":false,"snippet":true,"description":"Configures
        common HTTP proxy ENV variables based on the host_proxy\nhost parameter. Currently
        not used by any shipped template.","created_at":"2024-06-27 17:28:08 UTC","updated_at":"2024-07-03
        14:59:41 UTC","id":83,"name":"http_proxy","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1196'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=83
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/84
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: insights\nmodel: ProvisioningTemplate\nsnippet:
        true\ndescription: |\n  Installs and registers the insights client on RHEL,
        typically used\n  in the Kickstart provisioning and host init templates.\n-%>\n<%
        if @host.operatingsystem.name == ''RedHat'' -%>\necho ''#''\necho ''# Installing
        Insights client''\necho ''#''\n\nyum install -y insights-client\ninsights-client
        --register\n\n<% end -%>\n","locked":false,"snippet":true,"description":"Installs
        and registers the insights client on RHEL, typically used\nin the Kickstart
        provisioning and host init templates.","created_at":"2024-06-27 17:28:08 UTC","updated_at":"2024-07-03
        14:59:41 UTC","id":84,"name":"insights","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1123'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=82
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/49
  response:
    body:
      string: '{"template":"<%#\nkind: iPXE\nmodel: ProvisioningTemplate\nname: iPXE
        default local boot\nsnippet: false\ndescription: |\n  The template to render
        iPXE bootloader configuration for provisioned hosts,\n  that still boot from
        the network.\n  Hosts are instructed to boot from the first local medium.\n  Do
        not associate or change the name.\n-%>\n#!ipxe\n\n# Skips booting from network
        and continues booting from next device\nexit 1\n","locked":false,"snippet":false,"description":"The
        template to render iPXE bootloader configuration for provisioned hosts,\nthat
        still boot from the network.\nHosts are instructed to boot from the first
        local medium.\nDo not associate or change the name.","created_at":"2024-06-27
        17:28:08 UTC","updated_at":"2024-07-03 14:59:41 UTC","id":49,"name":"iPXE
        default local boot","template_kind_id":6,"template_kind_name":"iPXE","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1229'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=81
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/50
  response:
    body:
      string: '{"template":"<%#\nkind: iPXE\nmodel: ProvisioningTemplate\nname: iPXE
        global default\nsnippet: false\ndescription: |\n  The template to render iPXE
        bootloader configuration for unknown hosts.\n  The output is used for unknown
        hosts (typically discovery flow) and it\n  is not deployed to the TFTP proxy
        (unlike other default templates).\n  Do not associate or change the name.\n-%>\n#!ipxe\n\necho
        Opening global default menu in 15 seconds...\nsleep 15\n\nset menu-default
        <%= global_setting(\"default_pxe_item_global\", \"local\") %>\nset menu-timeout
        5000\nset port 8448\n\n:start\nmenu iPXE global boot menu\nitem --key l local     Local
        boot (next entry)\nitem shell             Drop into iPXE shell\nitem reboot            Reboot
        system\nitem\nitem --key d discovery Discovery from ${next-server}:8000 (httpboot
        module)\nitem discovery_custom Discovery from ${next-server}:${port} (httpboot
        module)\nchoose --timeout ${menu-timeout} --default ${menu-default} selected
        || goto cancel\nset menu-timeout 0\ngoto ${selected}\n\n:cancel\necho Menu
        canceled, dropping to shell\n\n:shell\necho Use the command ''exit'' to return
        to menu\nshell\nset menu-timeout 0\ngoto start\n\n:failed\necho Boot failed,
        dropping to shell\ngoto shell\n\n:reboot\nreboot\n\n:local\nexit 1\n\n:discovery\ndhcp\nkernel
        http://${next-server}:8000/httpboot/boot/fdi-image/vmlinuz0 initrd=initrd0.img
        rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force
        rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset nokaslr
        proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-${mac} fdi.initnet=bootif\ninitrd
        http://${next-server}:8000/httpboot/boot/fdi-image/initrd0.img\nimgstat\nsleep
        2\nboot || goto failed\ngoto start\n\n:discovery_custom\ndhcp\nkernel http://${next-server}:${port}/httpboot/boot/fdi-image/vmlinuz0
        initrd=initrd0.img rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image
        acpi=force rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nomodeset
        nokaslr proxy.url=<%= foreman_server_url %> proxy.type=foreman BOOTIF=01-${mac}
        fdi.initnet=bootif\ninitrd http://${next-server}:${port}/httpboot/boot/fdi-image/initrd0.img\nimgstat\nsleep
        2\nboot || goto failed\ngoto start\n","locked":false,"snippet":false,"description":"The
        template to render iPXE bootloader configuration for unknown hosts.\nThe output
        is used for unknown hosts (typically discovery flow) and it\nis not deployed
        to the TFTP proxy (unlike other default templates).\nDo not associate or change
        the name.","created_at":"2024-06-27 17:28:08 UTC","updated_at":"2024-07-03
        14:59:41 UTC","id":50,"name":"iPXE global default","template_kind_id":6,"template_kind_name":"iPXE","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '3072'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=80
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/51
  response:
    body:
      string: '{"template":"<%#\nkind: iPXE\nmodel: ProvisioningTemplate\nname: iPXE
        intermediate script\nsnippet: false\ndescription: |\n  This template is returned
        when ?bootstrap=1 URL parameter is provided.\n  It is used in pure iPXE environment
        and it''s purpose is to perform another iPXE template call,\n  but with MAC
        address(es) of the server in order to find appropriate host record in the
        inventory.\n  See https://docs.theforeman.org/nightly/Provisioning_Guide/index-foreman-el.html#Configuring_Networking-Configuring_gPXE_to_Reduce_Provisioning_Times\n-%>\n#!ipxe\n#
        Intermediate iPXE script to report MAC address to Foreman\n<% (0..32).each
        do |i| -%>\n\n:net<%= i %>\nisset ${net<%= i -%>/mac} || goto no_nic\ndhcp
        net<%= i -%> || goto net<%= i+1 %>\nchain <%= foreman_url(''iPXE'', {}, {
        mac: \"${net#{i}/mac}\" }) %> || goto net<%= i+1 %>\n<% end -%>\n\n:net33\ngoto
        no_nic\n\nexit 0\n\n:no_nic\necho Failed to chainload from any network interface\nsleep
        30\nexit 1\n","locked":false,"snippet":false,"description":"This template
        is returned when ?bootstrap=1 URL parameter is provided.\nIt is used in pure
        iPXE environment and it''s purpose is to perform another iPXE template call,\nbut
        with MAC address(es) of the server in order to find appropriate host record
        in the inventory.\nSee https://docs.theforeman.org/nightly/Provisioning_Guide/index-foreman-el.html#Configuring_Networking-Configuring_gPXE_to_Reduce_Provisioning_Times","created_at":"2024-06-27
        17:28:08 UTC","updated_at":"2024-07-03 14:59:41 UTC","id":51,"name":"iPXE
        intermediate script","template_kind_id":6,"template_kind_name":"iPXE","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1974'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=79
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/62
  response:
    body:
      string: '{"template":"<%#\nkind: provision\nname: Jumpstart default\nmodel:
        ProvisioningTemplate\noses:\n- Solaris\ndescription: |\n  Provisioning template
        for the Solaris installer\n-%>\ninstall_type <%= @install_type %>\npartitioning
        explicit\n<%= @disk %>\n<% if @host.use_image  -%>\narchive_location nfs <%=@archive_location%>\n<%
        else -%>\nsystem_type <%= @system_type %>\npackage <%= @packages %> add\ncluster
        <%= @cluster %>\n<% end -%>\n","locked":false,"snippet":false,"description":"Provisioning
        template for the Solaris installer","created_at":"2024-06-27 17:28:08 UTC","updated_at":"2024-07-03
        14:59:41 UTC","id":62,"name":"Jumpstart default","template_kind_id":7,"template_kind_name":"provision","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1074'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=78
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/41
  response:
    body:
      string: '{"template":"<%#\nkind: finish\nname: Jumpstart default finish\nmodel:
        ProvisioningTemplate\noses:\n- Solaris\ndescription: |\n  A finish template
        executed at the end of a network provisioning or\n  after the image based
        provisioning is done using the image without user data.\n  It is only used
        for Solaris.\n-%>\nlogger \"Starting finish script\"\n\n# Do not turn the
        machine off after 30 minutes. Very annoying!\n/bin/touch /noautoshutdown\n\n#
        Install the root password\n/usr/bin/perl -p -i -e ''s/^root:[^:]+/root:<%=
        @host.root_pass.gsub(''/'', ''\\/'')-%>/'' /etc/shadow\n\n# Root can ssh into
        this box. This is very useful while we rebuild this\n/usr/bin/perl -p -i -e
        \"s/PermitRootLogin no/PermitRootLogin yes/\" /etc/ssh/sshd_config\n\n# Now
        ensure that we have the newest puppet and facter installed\nmount /proc\n/usr/bin/cat
        /etc/mnttab | sed -e ''s/\\/a/\\//'' | sed -e ''s/\\/a//'' > /a/etc/mnttab\n/sbin/mount
        -F mntfs mnttab /etc/mnttab\n/usr/sbin/mknod /devices/pseudo/random@0:random
        c 190 0\n/usr/sbin/mknod /devices/pseudo/random@0:urandom c 190 1\n/usr/sbin/pkgadd
        -a /tmp/admin -d http://get.opencsw.org/now all\n/opt/csw/bin/pkgutil -U -y\n/opt/csw/bin/pkgutil
        -u -f -y CSWfacter CSWpuppet CSWwget\n\n/usr/bin/echo \"Creating helper startup
        script to start puppet\"\nONETIME=S99.enable.puppet\n/usr/bin/cat > /etc/rc3.d/$ONETIME
        << EOF\n#!/bin/sh\n#\n# $ONETIME\n#\n# runs once at startup and then removes
        itself.\n#\nPATH=/usr/bin:/usr/sbin; export PATH\n/usr/sbin/svccfg import
        /var/opt/csw/svc/manifest/network/cswpuppetd.xml\n/usr/sbin/svcadm enable
        svc:/network/cswpuppetd\nsleep 2\nrm \\$0\nEOF\n\n/usr/bin/echo \"Configuring
        puppet\"\ncat > /etc/puppet/puppet.conf << EOF\n<%= snippet ''puppet.conf''
        -%>\nEOF\n# The x86 version of the puppet package ignores the --config parameter.
        This should fix that and not hurt other installations\nif [ -f /etc/opt/csw/puppet/puppetd.conf
        ]\nthen\n    rm -f /etc/opt/csw/puppet/puppetd.conf\n    ln -s /etc/puppet/puppet.conf
        /etc/opt/csw/puppet/puppetd.conf\nfi\n/opt/csw/bin/puppet agent --config /etc/puppet/puppet.conf
        -o --tags no_such_tag --server <%= host_puppet_server %> --no-daemonize\n\necho
        \"Informing Foreman that we are built\"\n/opt/csw/bin/wget --no-check-certificate
        -O /dev/null <%= foreman_url(''built'') %>\n\n<%= snippet ''schedule_reboot''
        -%>\n\nexit 0\n","locked":false,"snippet":false,"description":"A finish template
        executed at the end of a network provisioning or\nafter the image based provisioning
        is done using the image without user data.\nIt is only used for Solaris.","created_at":"2024-06-27
        17:28:08 UTC","updated_at":"2024-07-03 14:59:41 UTC","id":41,"name":"Jumpstart
        default finish","template_kind_id":8,"template_kind_name":"finish","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '3103'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=77
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/3
  response:
    body:
      string: '{"template":"<%#\nkind: PXEGrub\nname: Jumpstart default PXEGrub\nmodel:
        ProvisioningTemplate\noses:\n- Solaris\ndescription: |\n  The template to
        render Grub bootloader configuration for Solaris.\n  The output is deployed
        on the host''s subnet TFTP proxy.\n  This template is for legacy Grub 1.x,
        you are probably looking for Grub2.\n-%>\ndefault=0\ntimeout=10\ntitle Solaris_10
        Jumpstart\n        kernel <%= @host.multiboot %> kernel/unix - install dhcp
        nowin -B install_config=<%= @host.jumpstart_path %>,sysid_config=<%= @host.jumpstart_path
        %>/sysidcfg/sysidcfg_primary,install_media=<%= @host.install_path %>,install_boot=<%=
        @host.install_path %>/boot\n        module <%= @host.miniroot %>\ntitle Solaris
        10\n        findroot (rootfs0,0,a)\n        kernel$ /platform/i86pc/multiboot\n        module
        /platform/i86pc/boot_archive\n","locked":false,"snippet":false,"description":"The
        template to render Grub bootloader configuration for Solaris.\nThe output
        is deployed on the host''s subnet TFTP proxy.\nThis template is for legacy
        Grub 1.x, you are probably looking for Grub2.","created_at":"2024-06-27 17:28:07
        UTC","updated_at":"2024-07-03 14:59:41 UTC","id":3,"name":"Jumpstart default
        PXEGrub","template_kind_id":4,"template_kind_name":"PXEGrub","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1627'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=76
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/42
  response:
    body:
      string: '{"template":"<%#\nkind: finish\nname: Junos default finish\nmodel:
        ProvisioningTemplate\noses:\n- Junos\ndescription: |\n  Generates a Junos
        OS configuration file. That can be used by Autoinstallation on Juniper\n  network
        devices. For more information, see https://projects.theforeman.org/issues/3906\n-%>\nsystem
        {\n    host-name <%= @host %>;\n    time-zone <%= host_param(''time-zone'')
        || ''Etc/UTC'' %>;\n    root-authentication {\n        encrypted-password
        \"<%= root_pass %>\"; ## SECRET-DATA\n    }\n    name-server {\n        <%
        if @host.subnet.dns_servers.empty? -%>\n        8.8.8.8;\n        <% end -%>\n        <%
        @host.subnet.dns_servers.each do |nameserver| -%>\n        <%= nameserver
        %>;\n        <% end -%>\n    }\n    ntp {\n        boot-server <%= host_param(''ntp-server'')
        || ''0.pool.ntp.org'' %>;\n        server <%= host_param(''ntp-server'') ||
        ''0.pool.ntp.org'' %>;\n    }\n    login {\n        message \"This device
        was provisioned by using The Foreman!\\nSee http://theforeman.org/ for further
        information.\\n\";\n        class automation {\n            permissions all;\n        }\n        user
        puppet {\n            uid 2001;\n            class automation;\n            authentication
        {\n                encrypted-password \"<%= root_pass %>\"; ## SECRET-DATA\n            }\n            shell
        csh;\n        }\n    }\n    services {\n        ssh {\n            protocol-version
        v2;\n        }\n        netconf {\n            ssh;\n        }\n    }\n    syslog
        {\n        user * {\n            any emergency;\n        }\n        file messages
        {\n            any notice;\n            authorization info;\n        }\n        file
        interactive-commands {\n            interactive-commands any;\n        }\n    }\n    ntp
        {\n        boot-server 0.pool.ntp.org;\n        server 0.pool.ntp.org;\n        server
        1.pool.ntp.org;\n    }\n    extensions {\n        providers {\n            juniper
        {\n                license-type juniper deployment-scope commercial;\n            }\n        }\n    }\n}\nchassis
        {\n    alarm {\n        management-ethernet {\n            link-down ignore;\n        }\n    }\n}\ninterfaces
        {\n    interface-range ACCESS-PORT {\n        member ge-0/0/0;\n        unit
        0 {\n            family ethernet-switching {\n                port-mode access;\n            }\n        }\n    }\n    interface-range
        UPLINK-PORT {\n        member ge-0/0/47;\n        unit 0 {\n            family
        ethernet-switching {\n                port-mode trunk;\n                vlan
        {\n                    members all;\n                }\n            }\n        }\n    }\n    vlan
        {\n        unit 37 {\n            family inet;\n        }\n    }\n    vme
        {\n        unit 0 {\n            family inet {\n                dhcp;\n            }\n        }\n    }\n}\nprotocols
        {\n    igmp-snooping {\n        vlan all;\n    }\n    rstp;\n    lldp {\n        interface
        all;\n    }\n    lldp-med {\n        interface all;\n    }\n}\nethernet-switching-options
        {\n    storm-control {\n        interface all;\n    }\n    bpdu-block {\n        interface
        ACCESS-PORT;\n        disable-timeout 120;\n    }\n}\nvlans {\n    testlan
        {\n        vlan-id 37;\n        l3-interface vlan.37;\n    }\n}\ngroups {\n    fmztp
        {\n        apply-macro conf {\n            package jinstall-ex-4200-<%= @host.operatingsystem.major
        %>R<%= @host.operatingsystem.minor %>-domestic-signed.tgz;\n            puppet
        jpuppet-ex-1.0R1.1.tgz;\n        }\n    }\n}\n","locked":false,"snippet":false,"description":"Generates
        a Junos OS configuration file. That can be used by Autoinstallation on Juniper\nnetwork
        devices. For more information, see https://projects.theforeman.org/issues/3906","created_at":"2024-06-27
        17:28:08 UTC","updated_at":"2024-07-03 14:59:41 UTC","id":42,"name":"Junos
        default finish","template_kind_id":8,"template_kind_name":"finish","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '4211'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=75
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/63
  response:
    body:
      string: '{"template":"<%#\nkind: provision\nname: Junos default SLAX\nmodel:
        ProvisioningTemplate\noses:\n- Junos\ndescription: |\n  Provisioning template
        for the Junos OS, used on Juniper network devices.\n  It fetches the config
        file based on the Juniper Finish template and deploys\n  it if it differs
        from the current version.\n-%>\nversion 1.0;\n\n/* ------------------------------------------------------------------\n
        * LICENSE\n * ------------------------------------------------------------------\n
        *\n * Copyright (c) 2013, Juniper Networks\n *\n * All rights reserved.\n
        *\n * Redistribution and use in source and binary forms, with or without\n
        * modification, are permitted provided that the following conditions are met:
        \n *\n * (1) Redistributions of source code must retain the above copyright
        notice, this \n * list of conditions and the following disclaimer. \n *\n
        * (2) Redistributions in binary form must reproduce the above copyright notice,\n
        * this list of conditions and the following disclaimer in the documentation\n
        * and/or other materials provided with the distribution. \n *\n * THIS SOFTWARE
        IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY
        EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n
        * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n
        * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE
        FOR\n * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
        DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
        OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
        HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
        LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY
        WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY
        OF SUCH DAMAGE.\n *\n * The views and conclusions contained in the software
        and documentation are those\n * of the authors and should not be interpreted
        as representing official policies, \n * either expressed or implied, of Juniper
        Networks.\n * \n *\n * ------------------------------------------------------------------\n
        * AUTHORS AND CONTRIBUTORS\n * ------------------------------------------------------------------\n
        *\n * Jeremy Schulman, Juniper Networks\n * - initial release (https://github.com/jeremyschulman/jctyztp/)\n
        *\n * Frank Wall, noris network AG\n * - adapt for integration in The Foreman\n
        * - fix compatibility with older Junos releases\n * \n *\n * ------------------------------------------------------------------\n
        * LIMITATIONS\n * ------------------------------------------------------------------\n
        *\n * To maintain backwards compatibility with JunOS 11.x (and maybe \n *
        even 10.x) you MUST AVOID all of these:\n * - global variable $junos-context
        (introduced with Junos 11.1)\n * - mutable variables (introduced with JunOS
        12.2 -> SLAX 1.1)\n * - native functions (introduced with JunOS 12.2 -> SLAX
        1.1)\n *\n * ------------------------------------------------------------------\n
        */\n\n/* ------------------------------------------------------------------
        */\n/* XML namespaces                                                     */\n/*
        ------------------------------------------------------------------ */\n\n/*
        Juniper */\nns junos = \"http://xml.juniper.net/junos/*/junos\";\nns xnm =
        \"http://xml.juniper.net/xnm/1.1/xnm\";\nns jcs = \"http://xml.juniper.net/junos/commit-scripts/1.0\";\nns
        ztp = \"http://xml.juniper.net/junos/ztp\";\n\n/* EXSLT */\nns exsl extension
        = \"http://exslt.org/common\";\nns func extension = \"http://exslt.org/functions\";\nns
        str extension = \"http://exslt.org/strings\";\n\n/* private namespace for
        this script */\nns jctyztp = \"http://xml.juniper.com/jctyztp/1.0\";\nns fmztp
        = \"http://xml.juniper.com/fmztp/1.0\";\n\n/* depending on Junos version relative
        path may be broken */\n/* import ''../import/junos.xsl''; */\nimport ''/usr/libdata/cscript/import/junos.xsl'';\n\n/*
        ------------------------------------------------------------------ */\n/*
        Script parameters                                                  */\n/*
        ------------------------------------------------------------------ */\n\nparam
        $server = ''ztpserver'';\nparam $mediapath = ''<%= @mediapath %>'';\n\n/*
        ------------------------------------------------------------------ */\n/*
        Constants                                                          */\n/*
        ------------------------------------------------------------------ */\n\nvar
        $APPNAME = ''foreman-ztp'';\nvar $SYSLOG = ''user.info'';\nvar $TMPDIR = ''/var/tmp'';\nvar
        $JUNOS_CONF = ''/var/tmp/junos.conf'';\n\nvar $ZTP_GROUP_NAME = \"fmztp\";\nvar
        $ZTP_MACRO_NAME = \"conf\";\nvar $ZTP_LOCKFILE = ''/tmp/fmztp.lock'';\n\n/*
        ------------------------------------------------------------------ */\n/*
        Global variables                                                   */\n/*
        ------------------------------------------------------------------ */\n\n/*
        Open a connection to the device API */\nvar $jnx = jcs:open();\n\n/* ------------------------------------------------------------------
        */\n/*                                MAIN                                */
        \n/* ------------------------------------------------------------------ */\n\nmatch
        / {\n\n  /* Terminate on connection error */\n  if(not( $jnx )) {\n    expr
        jcs:syslog( $SYSLOG, $APPNAME, \":ERROR: unable to connect to Junos API\");\n    expr
        fmztp:terminate();\n  }\n  \n  var $running = fmztp:only_once();\n  if( $running
        ) {\n    expr jcs:syslog( $SYSLOG, $APPNAME, \": start op script: already
        running, exiting...\" );\n    <xsl:message terminate=\"yes\">;\n  }\n  \n  /*
        if the $JUNOS_CONF file is not on the device, then */\n  /* download it from
        the server */\n  if(not( fmztp:file-exists( $JUNOS_CONF ))) {\n    expr jcs:syslog(
        $SYSLOG, $APPNAME, \": obtaining device config file\");\n    var $cp = fmztp:dl_junos_conf();\n  }\n  \n  /*
        now load $JUNOS_CONF into the candidate configuration so we can */\n  /* extract
        the ZTP config */\n  var $ztp_conf = fmztp:ld_junos_conf();\n  var $has_version
        = $ztp_conf/has_version;\n  var $new_package = $ztp_conf/package;\n  expr
        jcs:syslog( $SYSLOG, $APPNAME, \": preparing update from \", $has_version,
        \" to \", $new_package );\n  \n  /* if we have a version difference, then
        we will install the new OS */\n  /* and reboot the device.  the $JUNOS_CONF
        file will be loaded on */\n  /* after the install process completes */\n  if(
        $ztp_conf/install ) {\n    expr jcs:syslog( $SYSLOG, $APPNAME, \": Junos install
        required\" );\n    var $os = fmztp:install_os( $ztp_conf );\n    expr jcs:syslog(
        $SYSLOG, $APPNAME, \": rebooting in 60 seconds\" );\n    expr jcs:syslog(
        $SYSLOG, $APPNAME, \": SCRIPT-END\");\n    expr fmztp:reboot( 1 );\n    expr
        jcs:close( $jnx );\n  }\n  else {\n    expr jcs:syslog( $SYSLOG, $APPNAME,
        \": no Junos install required\" );\n    /* puppet agent is only supported
        on Junos 12.3R2.5 */\n    if( jcs:regex( \"12.3R2.5\", $ztp_conf/has_version
        )) {\n\texpr jcs:syslog( $SYSLOG, $APPNAME, \": puppet agent install required\"
        );\n\tvar $puppet = fmztp:install_puppet( $ztp_conf );\n    }\n    else {\n\texpr
        jcs:syslog( $SYSLOG, $APPNAME, \": os version is \", $has_version, \", but
        puppet agent is only available on 12.3R2.5\" );\n    }\n    var $fini = fmztp:finalize();\n    expr
        jcs:syslog( $SYSLOG, $APPNAME, \": SCRIPT-END\");\n    expr jcs:close( $jnx
        );\n  }\n}\n\n/* ------------------------------------------------------------------
        */\n/* HTTP Junos configuration file onto the device                      */\n/*
        ------------------------------------------------------------------ */\n\n<func:function
        name=\"fmztp:dl_junos_conf\">\n{\n  expr jcs:syslog( $SYSLOG, $APPNAME, \":
        downloading new Junos conf...\");\n  expr jcs:syslog( $SYSLOG, $APPNAME, \":
        URL: \", ''<%= foreman_url(''finish'') %>'');\n\n  var $get = <file-copy>
        {\n    <source> ''<%= foreman_url(''finish'') %>'';\n    <destination> $JUNOS_CONF;\n    <staging-directory>
        $TMPDIR;\n  };\n\n  var $got = jcs:execute( $jnx, $get );\n\n  if(not( fmztp:file-exists(
        $JUNOS_CONF ))) {\n    expr jcs:syslog( $SYSLOG, $APPNAME, \":ERROR: unable
        to find new Junos conf at \", $JUNOS_CONF);\n    expr fmztp:terminate();\n  }\n\n  <func:result
        select=\"true()\">;\n}\n\n/* ------------------------------------------------------------------
        */\n/* Load the $JUNOS_CONF file into the candidate config and extract    */\n/*
        the ZTP config from the [edit groups] area.  Do *NOT* commit       */\n/*
        this configuration yet, since we may need to install the OS first  */\n/*
        ------------------------------------------------------------------ */\n\n<func:function
        name=\"fmztp:ld_junos_conf\">\n{\n  expr jcs:syslog( $SYSLOG, $APPNAME, \":
        loading new Junos conf...\");\n\n  /* get the current version from the configuration
        file */\n  \n  var $get_cur_ver = <get-configuration database=''committed''>
        { <configuration> { <version>; }};\n  var $got_cur_ver = jcs:execute( $jnx,
        $get_cur_ver );\n\n  /* now load the configuration file we got from the ztp
        server */\n  var $do_load = <load-configuration action=\"override\" url=$JUNOS_CONF
        format=\"text\">;\n  var $did_load = jcs:execute( $jnx, $do_load );\n  if(not(
        $did_load/load-success )) {\n    expr jcs:syslog( $SYSLOG, $APPNAME, \":ERROR:
        unable to load config \", $JUNOS_CONF );\n    expr fmztp:terminate();\n  }\n  \n  expr
        jcs:syslog( $SYSLOG, $APPNAME, \": extracting Junos config parameters...\");\n  var
        $get = <get-configuration> { <configuration> {\n    <version>;\n    <groups>
        { <name> $ZTP_GROUP_NAME;\n      <apply-macro> { <name> $ZTP_MACRO_NAME;\n      }\n    }\n  }};\n  \n  var
        $got = jcs:execute( $jnx, $get );\n\n  expr jcs:syslog( $SYSLOG, $APPNAME,
        \": package: \", $got//data[name = ''package'']/value);\n  expr jcs:syslog(
        $SYSLOG, $APPNAME, \": URL: \", $mediapath);\n\n  /* create a node-set to
        store the following elements             */\n  /* has_version = current Junos
        version string                    */\n  /* package = filename of Junos package
        (*.tgz)                   */\n  /* mediapath = URL where package is obtained
        from                */\n  /* install = present if a install is requeired                   */\n  var
        $ver = $got_cur_ver/version;\n  var $package = $got//data[name = ''package'']/value;\n  var
        $puppet = $got//data[name = ''puppet'']/value;\n  var $conf := {\n    <has_version>
        $ver; \n    <package> $package;\n    <puppet> $puppet;\n    <url> $mediapath;\n    if(not(
        jcs:regex( $ver, $package ))) {\n      <install>;\n    }\n  }\n\n  /* @@@
        should put some trap here on ensuring that the config */\n  /* @@@ file actually
        had the correct group/macro defined */\n    \n  <func:result select=\"$conf\">;\n}\n\n/*
        ------------------------------------------------------------------ */\n/*
        Junos Software Installation - download the software from the HTTP  */\n/*
        server and perform the ''request system software add'' operation     */\n/*
        ------------------------------------------------------------------ */\n\n<func:function
        name=\"fmztp:install_os\">\n{\n  param $ztp_conf;\n\n  var $local_image =
        $TMPDIR _ \"/\" _ $ztp_conf/package;\n  \n  if( fmztp:file-exists( $local_image
        )) {\n    expr jcs:syslog( $SYSLOG, $APPNAME, \": junos image exists, no download
        needed\" );\n  }\n  else {\n  \n    /* request system storage cleanup */\n    expr
        jcs:syslog( $SYSLOG, $APPNAME, \": cleaning filesystem\" );\n    var $clean
        = jcs:execute( $jnx, ''request-system-storage-cleanup'' ); \n\n    /* file
        copy .... */\n    expr jcs:syslog( $SYSLOG, $APPNAME, \": downloading junos
        image...\" );    \n    expr jcs:syslog( $SYSLOG, $APPNAME, \": URL: \", $ztp_conf/url,
        $ztp_conf/package );\n    var $do_copy = <file-copy> {\n      <source> $ztp_conf/url
        _ $ztp_conf/package;\n      <destination> $TMPDIR;\n      <staging-directory>
        $TMPDIR;\n    };\n    var $did_copy = jcs:execute( $jnx, $do_copy );\n    \n    /*
        trap error here */\n    if( not(fmztp:file-exists( $local_image )) ) {\n        expr
        jcs:syslog( $SYSLOG, $APPNAME, \": ERROR: unable to download junos image\"
        );\n        expr fmztp:terminate();\n    }\n  }\n  \n  /* request system software
        add ... */\n  expr jcs:syslog( $SYSLOG, $APPNAME, \": installing junos image\"
        );    \n  var $do_install = <request-package-add> {\n    <no-validate>;\n    <package-name>
        $local_image;\n  };\n  var $did_install = jcs:execute( $jnx, $do_install );\n  /*
        @@@ need to trap error here on $did_install */\n  \n  expr jcs:syslog( $SYSLOG,
        $APPNAME, \": completed installing junos image\" );\n   \n  <func:result select=\"true()\">;\n}\n\n/*
        ------------------------------------------------------------------ */\n/*
        Reboot the device given a delay, in minutes                        */\n/*
        ------------------------------------------------------------------ */\n\n<func:function
        name=\"fmztp:reboot\">\n{\n  param $in_min;\n\n  var $do_reboot = <request-reboot>
        { <in> $in_min; };\n  var $did_reboot = jcs:execute( $jnx, $do_reboot );\n  <func:result
        select=\"true()\">;\n}\n\n/* ------------------------------------------------------------------
        */\n/* Puppet Agent Installation - download the software from the HTTP    */\n/*
        server and perform the ''request system software add'' operation     */\n/*
        ------------------------------------------------------------------ */\n\n<func:function
        name=\"fmztp:install_puppet\">\n{\n  param $ztp_conf;\n  expr jcs:syslog(
        $SYSLOG, $APPNAME, \": starting puppet installation...\" );\n\n  if (fmztp:is-installed(\"puppet\"))
        {\n    expr jcs:syslog( $SYSLOG, $APPNAME, \": package puppet is already installed\"
        );\n    <func:result select=\"true()\">;\n  }\n\n  var $local_image = $TMPDIR
        _ \"/\" _ $ztp_conf/puppet;\n  \n  if( fmztp:file-exists( $local_image ))
        {\n    expr jcs:syslog( $SYSLOG, $APPNAME, \": package puppet exists, no download
        needed\" );\n  }\n  else {\n  \n    /* request system storage cleanup */\n    expr
        jcs:syslog( $SYSLOG, $APPNAME, \": cleaning filesystem\" );\n    var $clean
        = jcs:execute( $jnx, ''request-system-storage-cleanup'' ); \n\n    /* file
        copy .... */\n    expr jcs:syslog( $SYSLOG, $APPNAME, \": downloading puppet
        image...\" );    \n    expr jcs:syslog( $SYSLOG, $APPNAME, \": URL: \", $ztp_conf/url,
        $ztp_conf/puppet );    \n    var $do_copy = <file-copy> {\n      <source>
        $ztp_conf/url _ $ztp_conf/puppet;\n      <destination> $TMPDIR;\n      <staging-directory>
        $TMPDIR;\n    };\n    var $did_copy = jcs:execute( $jnx, $do_copy );\n    \n    /*
        trap error on $did_copy */\n    if( not(fmztp:file-exists( $local_image ))
        ) {\n      expr jcs:syslog( $SYSLOG, $APPNAME, \": ERROR: failed to download
        puppet image\" );\n      expr fmztp:terminate();\n    }\n  }\n\n  /* request
        system software add ... */\n  expr jcs:syslog( $SYSLOG, $APPNAME, \": installing
        puppet image\" );    \n  var $do_install = <request-package-add> {\n    <no-validate>;\n    <package-name>
        $local_image;\n  };\n  var $did_install = jcs:execute( $jnx, $do_install );\n  \n  /*
        NOTE: To complete the puppet installation you need to take manual steps, see:\n   *       http://www.juniper.net/techpubs/en_US/release-independent/junos-puppet/information-products/pathway-pages/index.html\n   */\n\n  /*
        validate installation */\n  if (not(fmztp:is-installed(\"puppet\"))) {\n    expr
        jcs:syslog( $SYSLOG, $APPNAME, \": ERROR: failed to install package puppet\"
        );\n    expr fmztp:terminate();\n  }\n\n  expr jcs:syslog( $SYSLOG, $APPNAME,
        \": completed installing puppet image\" );\n   \n  <func:result select=\"true()\">;\n}\n\n/*
        ------------------------------------------------------------------ */\n/*
        Finalize the ZTP process; i.e. after the OS is correct.  Remove    */\n/*
        the $JUNOS_CONF file and committing the configuration to make      */\n/*
        it active.                                                         */\n/*
        ------------------------------------------------------------------ */\n\n<func:function
        name=\"fmztp:finalize\">\n{\n  expr jcs:syslog( $SYSLOG, $APPNAME, \": deleting
        temp config file...\");  \n  var $rm1 = fmztp:file-delete( $JUNOS_CONF );\n\n  expr
        jcs:syslog( $SYSLOG, $APPNAME, \": sending finish signal to foreman...\");  \n  var
        $do_foreman = <file-copy> {\n      <source> ''<%= foreman_url(''provision'')
        %>'';\n      <destination> \"/tmp\";\n      <staging-directory> \"/tmp\";\n  };\n  var
        $did_foreman = jcs:execute( $jnx, $do_foreman );\n\n  expr jcs:syslog( $SYSLOG,
        $APPNAME, \": deleting ztp lock file...\");  \n  var $rm2 = fmztp:file-delete(
        $ZTP_LOCKFILE );\n\n  /* commit the configuration that was previously loaded
        */  \n  expr jcs:syslog( $SYSLOG, $APPNAME, \": committing configuration...\");  \n  var
        $commit = jcs:execute( $jnx, ''commit-configuration'' );\n  if( $commit//self::xnm:error
        ) {\n    expr jcs:syslog( $SYSLOG, $APPNAME, \":ERROR: unable to commit configuration:
        \", $commit//self::xnm:error/message );\n    var $die = fmztp:terminate();\n  }\n\n  <func:result
        select=\"true()\">;\n}\n\n/* ------------------------------------------------------------------
        */\n/* Helper routine: check to see if a file exists on the device,       */\n/*
        returns [ true | false ]                                           */\n/*
        ------------------------------------------------------------------ */\n\n<func:function
        name=\"fmztp:file-exists\">\n{\n  param $filename;\n  var $ls_file = <file-list>
        { <path> $filename; };\n  var $ls_got = jcs:execute( $jnx, $ls_file );\n  var
        $retval = boolean( $ls_got//file-information );\n\n  <func:result select=\"$retval\">;\n}\n\n<func:function
        name=\"fmztp:file-delete\">\n{\n  param $filename;\n  var $do_rm = <file-delete>
        { <path> $filename; };\n  var $did_rm = jcs:execute( $jnx, $do_rm );\n  /*
        @@@ trap error */\n  \n  <func:result select=\"true()\">;\n}\n\n/* ------------------------------------------------------------------
        */\n/* Helper routine: create a lockfile to make sure the script only     */\n/*
        runs once, and terminate if it is already running.                 */\n/*
        returns [ true | false ]                                           */\n/*
        ------------------------------------------------------------------ */\n\n<func:function
        name=\"fmztp:only_once\">\n{\n  if( fmztp:file-exists( $ZTP_LOCKFILE )) {\n    <func:result
        select=\"true()\">;\n  }\n  else {\n    var $do_lock = <file-put> {\n      <filename>
        $ZTP_LOCKFILE;\n      <encoding> ''ascii'';\n      <file-contents> ''locked'';\n    };\n    var
        $did_lock = jcs:execute( $jnx, $do_lock );\n    <func:result select=\"false()\">;\n  }\n}\n\n<func:function
        name=\"fmztp:terminate\">\n{\n  expr jcs:syslog( $SYSLOG, $APPNAME, \": SCRIPT-FAILED\"
        );\n  var $rm_lock = fmztp:file-delete( $ZTP_LOCKFILE );\n  <xsl:message terminate=\"yes\">;\n}\n\n/*
        ------------------------------------------------- */\n/* check if software
        package is installed            */\n/* -------------------------------------------------
        */\n<func:function name=\"fmztp:is-installed\">\n{\n  param $string;\n\n  var
        $do_query = <get-software-information>;\n  var $did_query = jcs:execute( $jnx,
        $do_query );\n\n  if( jcs:regex( $string, $did_query )) {\n    expr jcs:output(\"package
        found: \", $string);\n    expr jcs:syslog( $SYSLOG, $APPNAME, \": package
        found: \", $string);\n    <func:result select=\"true()\">;\n  }\n  else {\n    expr
        jcs:output(\"package NOT found: \", $string);\n    expr jcs:syslog( $SYSLOG,
        $APPNAME, \": package NOT found: \", $string);\n    <func:result select=\"false()\">;\n  }\n}\n","locked":false,"snippet":false,"description":"Provisioning
        template for the Junos OS, used on Juniper network devices.\nIt fetches the
        config file based on the Juniper Finish template and deploys\nit if it differs
        from the current version.","created_at":"2024-06-27 17:28:08 UTC","updated_at":"2024-07-03
        14:59:41 UTC","id":63,"name":"Junos default SLAX","template_kind_id":7,"template_kind_name":"provision","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '20266'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=74
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/30
  response:
    body:
      string: '{"template":"<%#\nkind: ZTP\nname: Junos default ZTP config\nmodel:
        ProvisioningTemplate\noses:\n- Junos\ndescription: |\n  Generates a Junos
        OS configuration file. That can be used by ZTP on Juniper\n  network devices.
        For more information, see https://projects.theforeman.org/issues/3906\n-%>\nsystem
        {\n    host-name <%= @host.shortname %>;\n    root-authentication {\n      encrypted-password
        \"<%= root_pass %>\"; ## SECRET-DATA\n    }\n    services {\n        ssh;\n        netconf
        {\n            ssh;\n        }\n    }\n    syslog {\n        user * {\n            any
        emergency;\n            user info;\n        }\n        file messages {\n            any
        notice;\n            authorization info;\n        }\n        console {\n            user
        info;\n        }\n    }\n}\ninterfaces {\n    vme {\n        unit 0 {\n            family
        inet {\n                dhcp;\n            }\n        }\n    }\n}\nevent-options
        {\n    generate-event {\n        fmztp time-interval 90;\n    }\n    policy
        fmztp {\n        events fmztp;\n        then {\n            execute-commands
        {\n                commands {\n                    \"op url <%= foreman_url(''provision'')%>.slax\";\n                }\n            }\n        }\n    }\n}\nprotocols
        {\n    igmp-snooping {\n        vlan all;\n    }\n    rstp;\n    lldp {\n        interface
        all;\n    }\n    lldp-med {\n        interface all;\n    }\n}\nethernet-switching-options
        {\n    storm-control {\n        interface all;\n    }\n}\n","locked":false,"snippet":false,"description":"Generates
        a Junos OS configuration file. That can be used by ZTP on Juniper\nnetwork
        devices. For more information, see https://projects.theforeman.org/issues/3906","created_at":"2024-06-27
        17:28:08 UTC","updated_at":"2024-07-03 14:59:41 UTC","id":30,"name":"Junos
        default ZTP config","template_kind_id":11,"template_kind_name":"ZTP","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '2235'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=73
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/64
  response:
    body:
      string: '{"template":"<%#\nkind: provision\nname: Kickstart default\nmodel:
        ProvisioningTemplate\noses:\n- AlmaLinux\n- CentOS\n- CentOS_Stream\n- Fedora\n-
        RedHat\n- Rocky\ntest_on:\n- host4dhcp\n- host6dhcp\n- host4and6dhcp\n- host4static\n-
        host6static\n- rhel9_dhcp\n- rocky8_dhcp\n- rocky9_dhcp\ndescription: |\n  The
        provisioning template for kickstart based distributions. The output is fetched
        by Anaconda installer during\n  the network based installation. To customize
        the installation, modify the host parameters.\n\n  This template accepts the
        following parameters:\n  - lang: string (default=\"en_US.UTF-8\")\n  - selinux-mode:
        string (default=\"enforcing\")\n  - keyboard: string (default=\"us\")\n  -
        time-zone: string (default=\"UTC\")\n  - http-proxy: string (default=\"\")\n  -
        http-proxy-port: string (default=\"\")\n  - force-puppet: boolean (default=false)\n  -
        enable-epel: boolean (default=false)\n  - enable-puppetlabs-repo: boolean
        (default=false)\n  - enable-puppetlabs-puppet5-repo: boolean (default=false)\n  -
        enable-puppetlabs-puppet6-repo: boolean (default=false)\n  - enable-official-puppet7-repo:
        boolean (default=false)\n  - enable-official-puppet8-repo: boolean (default=false)\n  -
        skip-puppet-setup: boolean (default=false)\n  - salt_master: string (default=undef)\n  -
        ntp-server: string (default=undef)\n  - bootloader-append: string (default=\"nofb
        quiet splash=quiet\")\n  - disable-firewall: boolean (default=false)\n  -
        package_upgrade: boolean (default=true)\n  - disable-uek: boolean (default=false)\n  -
        use-ntp: boolean (default depends on OS release)\n  - fips_enabled: boolean
        (default=false)\n  - encrypt_grub: boolean (default=false)\n  - use_graphical_installer:
        boolean (default=false)\n  - enable-remote-execution-pull: boolean (default=false)\n  -
        additional-packages: string (default=undef)\n\n  Reference links:\n  - https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/installation_guide/s1-kickstart2-options\n  -
        https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/installation_guide/sect-kickstart-syntax\n  -
        https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/performing_an_advanced_rhel_installation/kickstart-commands-and-options-reference_installing-rhel-as-an-experienced-user\n-%>\n<%\n  rhel_compatible
        = @host.operatingsystem.family == ''Redhat'' && @host.operatingsystem.name
        != ''Fedora''\n  is_fedora = @host.operatingsystem.name == ''Fedora''\n  os_major
        = @host.operatingsystem.major.to_i\n  os_minor = @host.operatingsystem.minor.to_i\n  realm_compatible
        = (@host.operatingsystem.name == ''Fedora'' && os_major >= 20) || (rhel_compatible
        && os_major >= 7)\n  # safemode renderer does not support unary negation\n  proxy_uri
        = host_param(''http-proxy'') ? \"http://#{host_param(''http-proxy'')}:#{host_param(''http-proxy-port'')}\"
        : nil\n  proxy_string = proxy_uri ? \" --proxy=#{proxy_uri}\" : ''''\n  puppet_enabled
        = !host_param_true?(''skip-puppet-setup'') && (host_puppet_server.present?
        || host_param_true?(''force-puppet''))\n  salt_enabled = host_param(''salt_master'')
        ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n  section_end
        = (rhel_compatible && os_major <= 5) ? '''' : ''%end''\n  use_ntp = host_param_true?(''use-ntp'',
        (is_fedora && os_major < 16) || (rhel_compatible && os_major <= 6))\n  iface
        = @host.provision_interface\n  appstream_present = false\n  use_rhsm = (@host.operatingsystem.name
        == ''RedHat'' || @host.operatingsystem.name == ''RHEL'') && os_major >= 9\n-%>\n#
        This kickstart file was rendered from the Foreman provisioning template \"<%=
        @template_name %>\".\n# for <%= @host %> running <%= @host.operatingsystem.name
        %> <%= os_major %> <%= @arch %>\n# Organization: <%= @host.organization %>\n#
        Location: <%= @host.location %>\n<%\nif plugin_present?(''katello'')\n-%>\n#
        Lifecycle environment: <%= @host.single_lifecycle_environment %>\n# Content
        View: <%= @host.single_content_view %>\n# Content Source: <%= @host.content_source
        %>\n<% end -%>\n\n<% if (is_fedora && os_major < 29) || (rhel_compatible &&
        os_major <= 7) -%>\ninstall\n<% end -%>\n<%\nif host_param(''kickstart_liveimg'')\n  img_name
        = host_param(''kickstart_liveimg'')\n  liveimg_url = if host_param(''kt_activation_keys'')\n    repository_url(img_name,
        ''isos'')\n  else\n    if img_name.match(%r|^([\\w\\-\\+]+)://|)\n      img_name\n    else\n      \"#{medium_uri}/#{img_name}\"\n    end\n  end\n%>\nliveimg
        --url=<%= liveimg_url %> <%= proxy_string %>\n<% else %>\n<%= @mediapath %><%=
        proxy_string %>\n<% @additional_media.each do |medium| -%>\nrepo --name <%=
        medium[:name] %> --baseurl <%= medium[:url] %> <%= medium[:install] ? '' --install''
        : '''' %><%= proxy_string %>\n<% end -%>\n<%= snippet_if_exists(template_name
        + \" custom repositories\") %>\n<% end %>\nlang <%= host_param(''lang'') ||
        ''en_US.UTF-8'' %>\nselinux --<%= host_param(''selinux-mode'') || host_param(''selinux'')
        || ''enforcing'' %>\nkeyboard <%= host_param(''keyboard'') || ''us'' %>\n\n<%\n#
        start with provisioning interface, then other non-bond non-bridge interfaces
        and the bonds + bridges at the end\n@host.interfaces.reject{ |iface| iface.bmc?
        }.sort_by { |iface| (iface.bond? || iface.bridge?) ? 0 : iface.provision?
        ? 20 : 10 }.each do |iface|\n-%>\n<%= snippet(\n      ''kickstart_network_interface'',\n      variables:
        {\n        iface: iface,\n        host: @host,\n        use_slaac: host_param_true?(''use-slaac''),\n        static:
        @static,\n        static6: @static6\n      }\n    ) -%>\n<%\nend\n-%>\n\nrootpw
        --iscrypted <%= root_pass %>\n<% if host_param_true?(''disable-firewall'')
        -%>\nfirewall --disable\n<% else -%>\nfirewall --<%= os_major >= 6 ? ''service=''
        : '''' %>ssh\n<% end -%>\n<% if (is_fedora && os_major >= 28) || (rhel_compatible
        && os_major > 7) -%>\nauthselect --useshadow --passalgo=<%= @host.operatingsystem.password_hash.downcase
        || ''sha256'' %> --kickstart\n<% else -%>\nauthconfig --useshadow --passalgo=<%=
        @host.operatingsystem.password_hash.downcase || ''sha256'' %> --kickstart\n<%
        end -%>\ntimezone --utc <%= host_param(''time-zone'') || ''UTC'' %> <%= host_param(''ntp-server'')
        ? \"--ntpservers #{host_param(''ntp-server'')}\" : '''' %>\n\n<% if rhel_compatible
        -%>\nservices --disabled gpm,sendmail,cups,pcmcia,isdn,rawdevices,hpoj,bluetooth,openibd,avahi-daemon,avahi-dnsconfd,hidd,hplip,pcscd\n<%
        end -%>\n\n<% if realm_compatible && host_enc[''parameters''][''realm''] &&
        @host.realm && @host.realm.realm_type == ''Active Directory'' -%>\n# One-time
        password will be requested at install time. Otherwise, $HOST[OTP] is used
        as a placeholder value.\nrealm join --one-time-password=''<%= @host.otp ||
        \"$HOST[OTP]\" %>'' <%= @host.realm %>\n<% end -%>\n\n<% if @host.operatingsystem.name
        == ''OracleLinux'' && os_major == 7 && os_minor < 5 -%>\nrepo --name=\"Server-Mysql\"\n<%
        end -%>\n\n<% if @host.operatingsystem.name == ''Fedora'' && os_major <= 16
        -%>\n# Bootloader exception for Fedora 16:\nbootloader --append=\"<%= host_param(''bootloader-append'')
        || ''nofb quiet splash=quiet'' %> <%= ks_console %>\" <%= grub_pass %>\npart
        biosboot --fstype=biosboot --size=1\n<% else -%>\nbootloader --location=mbr
        --append=\"<%= host_param(''bootloader-append'') || ''nofb quiet splash=quiet''
        %>\" <%= grub_pass %>\n<% if os_major == 5 -%>\nkey --skip\n<% end -%>\n<%
        end -%>\n\n<% if @dynamic -%>\n%include /tmp/diskpart.cfg\n<% else -%>\n<%=
        @host.diskLayout %>\n<% end -%>\n<%= snippet(''kickstart_rhsm'') if use_rhsm
        -%>\n\n<% if host_param_true?(''use_graphical_installer'') -%>\ngraphical\n<%
        else -%>\nskipx\ntext\n<% end -%>\nreboot<% if host_param_true?(''install_reboot_kexec'')
        %> --kexec<% end %>\n\n%packages\n<%= snippet_if_exists(template_name + \"
        custom packages\") %>\nyum\n<% if os_major < 8 -%>\ndhclient\n<% end -%>\n<%
        if use_ntp -%>\nntp\n-chrony\n<% else -%>\nchrony\n-ntp\n<% end -%>\n<% if
        rhel_compatible && os_major < 9 -%>\nwget\n<% end -%>\n<% if host_param_true?(''fips_enabled'')
        -%>\n<%=   snippet ''fips_packages'' %>\n<% end -%>\n<% if host_param(''additional-packages'').present?
        -%>\n<%= host_param(''additional-packages'').split(\" \").join(\"\\n\") %>\n<%
        end -%>\n<%= section_end %>\n\n<% if @dynamic -%>\n%pre --log=/tmp/install.pre.dynamic.log\n<%=
        snippet_if_exists(template_name + \" custom pre\") %>\n<%= @host.diskLayout
        %>\n<%= section_end %>\n<% end -%>\n\n%post --nochroot\nexec < /dev/tty3 >
        /dev/tty3\nchvt 3\n(\n\n<% if host_param_false?(''no-resolv-override'') -%>\ncp
        -va /etc/resolv.conf /mnt/sysimage/etc/resolv.conf\n<% end -%>\n\n<%= snippet_if_exists(template_name
        + \" custom postnochroot\") -%>\n\nchvt 1\n) 2>&1 | tee /mnt/sysimage/root/install.postnochroot.log\n<%=
        section_end %>\n\n<%#\nMain post script, if it fails the last post is still
        executed.\n%>\n%post\nexec < /dev/tty3 > /dev/tty3\nchvt 3\n(\nlogger \"Starting
        anaconda <%= @host %> postinstall\"\n<%= snippet ''ntp'' %>\n\n<%= snippet
        ''yum_proxy'' %>\n\n<% if rhel_compatible && host_param_true?(''enable-epel'')
        -%>\n<%= snippet ''epel'' -%>\n<% end -%>\n\n<%= snippet ''redhat_register''
        if rhel_compatible && !use_rhsm -%>\n\n<% if host_enc[''parameters''][''realm'']
        && @host.realm && (@host.realm.realm_type == ''FreeIPA'' || @host.realm.realm_type
        == ''Red Hat Identity Management'') -%>\n<%= snippet ''freeipa_register''
        %>\n<% end -%>\n\n<% unless host_param_false?(''package_upgrade'') -%>\n#
        update all the base packages from the updates repository\nif [ -f /usr/bin/dnf
        ]; then\n  dnf -y update\nelse\n  yum -t -y update\nfi\n<% end -%>\n\n<%=
        snippet(''remote_execution_ssh_keys'') %>\n\n<% if plugin_present?(''katello'')
        && host_param_true?(''enable-remote-execution-pull'') -%>\n<%= save_to_file(''/root/remote_execution_pull_setup.sh'',
        snippet(''remote_execution_pull_setup''), verbatim: true) %>\nchmod +x /root/remote_execution_pull_setup.sh\n/root/remote_execution_pull_setup.sh\n<%
        end -%>\n\n<%= snippet \"blacklist_kernel_modules\" %>\n\n<% if chef_enabled
        %>\n<%= snippet ''chef_client'' %>\n<% end -%>\n\n<% if puppet_enabled %>\n<%
        if host_param_true?(''enable-puppetlabs-repo'') || host_param_true?(''enable-official-puppet8-repo'')
        || host_param_true?(''enable-official-puppet7-repo'') || host_param_true?(''enable-puppetlabs-puppet6-repo'')||
        host_param_true?(''enable-puppetlabs-puppet5-repo'') -%>\n<%= snippet ''puppetlabs_repo''
        %>\n<% end -%>\n<%= snippet ''puppet_setup'' %>\n<% end -%>\n\n<% if salt_enabled
        %>\n<%= snippet ''saltstack_setup'' %>\n<% end -%>\n\n<% if @host.operatingsystem.name
        == ''OracleLinux'' && host_param_true?(''disable-uek'') -%>\n# Uninstall the
        Oracle Unbreakable Kernel packages\nyum -t -y remove kernel-uek*\nsed -e ''s/DEFAULTKERNEL=kernel-uek/DEFAULTKERNEL=kernel/g''
        -i /etc/sysconfig/kernel\n<% end -%>\n\n<%= snippet(''ansible_provisioning_callback'')
        %>\n\n<%= snippet ''efibootmgr_netboot'' %>\n\n<%= snippet_if_exists(template_name
        + \" custom post\") %>\n\n<%= snippet ''insights'' if host_param_true?(''host_registration_insights'')
        && os_major < 9 -%>\n<%= snippet ''disk_enc_clevis_tang'' if host_param(''disk_enc_tang_servers'')
        -%>\n\ntouch /tmp/foreman_built\n\n<% if host_param_true?(''use_graphical_installer'')
        -%>\nchvt 6\n<% else -%>\nchvt 1\n<% end -%>\n) 2>&1 | tee /root/install.post.log\n<%=
        section_end %>\n\n# copy %pre log files into chroot\n%post --nochroot\ncp
        -vf /tmp/*.pre.*.log /mnt/sysimage/root/\n<%= section_end %>\n\n<%#\nThe last
        post section halts Anaconda to prevent endless loop in case HTTP request fails\n%>\n<%
        if (is_fedora && os_major < 20) || (rhel_compatible && os_major < 7) -%>\n%post\n<%
        else -%>\n%post --erroronfail --log=/root/install-callhome.post.log\n<% end
        -%>\n\n<%= snippet ''eject_cdrom'' -%>\n\nif test -f /tmp/foreman_built; then\n  echo
        \"calling home: build is done!\"\n  <%= indent(2, skip1: true, skip_content:
        ''EOF'') { snippet(''built'', :variables => { :endpoint => ''built'', :method
        => ''POST'', :body_file => ''/root/install.post.log'' }) } -%>\nelse\n  echo
        \"calling home: build failed!\"\n  <%= indent(2, skip1: true, skip_content:
        ''EOF'') { snippet(''built'', :variables => { :endpoint => ''failed'', :method
        => ''POST'', :body_file => ''/root/install.post.log'' }) } -%>\nfi\n\nsync\n<%=
        section_end %>\n","locked":false,"snippet":false,"description":"The provisioning
        template for kickstart based distributions. The output is fetched by Anaconda
        installer during\nthe network based installation. To customize the installation,
        modify the host parameters.\n\nThis template accepts the following parameters:\n-
        lang: string (default=\"en_US.UTF-8\")\n- selinux-mode: string (default=\"enforcing\")\n-
        keyboard: string (default=\"us\")\n- time-zone: string (default=\"UTC\")\n-
        http-proxy: string (default=\"\")\n- http-proxy-port: string (default=\"\")\n-
        force-puppet: boolean (default=false)\n- enable-epel: boolean (default=false)\n-
        enable-puppetlabs-repo: boolean (default=false)\n- enable-puppetlabs-puppet5-repo:
        boolean (default=false)\n- enable-puppetlabs-puppet6-repo: boolean (default=false)\n-
        enable-official-puppet7-repo: boolean (default=false)\n- enable-official-puppet8-repo:
        boolean (default=false)\n- skip-puppet-setup: boolean (default=false)\n- salt_master:
        string (default=undef)\n- ntp-server: string (default=undef)\n- bootloader-append:
        string (default=\"nofb quiet splash=quiet\")\n- disable-firewall: boolean
        (default=false)\n- package_upgrade: boolean (default=true)\n- disable-uek:
        boolean (default=false)\n- use-ntp: boolean (default depends on OS release)\n-
        fips_enabled: boolean (default=false)\n- encrypt_grub: boolean (default=false)\n-
        use_graphical_installer: boolean (default=false)\n- enable-remote-execution-pull:
        boolean (default=false)\n- additional-packages: string (default=undef)\n\nReference
        links:\n- https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/installation_guide/s1-kickstart2-options\n-
        https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/installation_guide/sect-kickstart-syntax\n-
        https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/performing_an_advanced_rhel_installation/kickstart-commands-and-options-reference_installing-rhel-as-an-experienced-user","created_at":"2024-06-27
        17:28:08 UTC","updated_at":"2024-07-03 14:59:41 UTC","id":64,"name":"Kickstart
        default","template_kind_id":7,"template_kind_name":"provision","template_combinations":[],"operatingsystems":[{"id":1,"name":"RedHat","title":"RHEL
        8.10"}],"os_default_templates":[{"id":6,"provisioning_template_id":64,"provisioning_template_name":"Kickstart
        default","template_kind_id":7,"template_kind_name":"provision","operatingsystem_id":1,"operatingsystem_name":"RHEL
        8.10"}],"locations":[{"id":12,"name":"Test Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '14853'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=72
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/43
  response:
    body:
      string: '{"template":"<%#\nkind: finish\nname: Kickstart default finish\nmodel:
        ProvisioningTemplate\noses:\n- AlmaLinux\n- CentOS\n- CentOS_Stream\n- Fedora\n-
        Rocky\ndescription: |\n  A finish template executed at the end of the image
        based provisioning\n  using the image without user data. Foreman connects
        to the VM over SSH\n  and runs the script rendered from this template. It
        is meant to be run\n  on RPM based distributons.\n\n  This template accepts
        the following parameters:\n  - bootloader-append: string (default=\"nofb quiet
        splash=quiet\")\n  - force-puppet: boolean (default=false)\n  - skip-puppet-setup:
        boolean (default=false)\n  - use-ntp: boolean (default depends on OS release)\n  -
        ntp-server: string (default=undef)\n  - package_upgrade: boolean (default=true)\n  -
        salt_master: string (default=undef)\n  - enable-remote-execution-pull: boolean
        (default=false)\n-%>\n<%\n  rhel_compatible = @host.operatingsystem.family
        == ''Redhat'' && @host.operatingsystem.name != ''Fedora''\n  os_major = @host.operatingsystem.major.to_i\n  puppet_enabled
        = !host_param_true?(''skip-puppet-setup'') && (host_puppet_server.present?
        || host_param_true?(''force-puppet''))\n  salt_enabled = host_param(''salt_master'')
        ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n\n<%=
        snippet_if_exists(template_name + \" custom pre\") -%>\n\n<% if @host.provision_method
        == ''image'' && root_pass.present? -%>\n# Install the root password\necho
        ''root:<%= root_pass -%>'' | /usr/sbin/chpasswd -e\n<% end -%>\n\n<%= snippet
        ''yum_proxy'' %>\n\n<%= snippet ''ntp'' %>\n\n<% if rhel_compatible && host_param_true?(''enable-epel'')
        -%>\n<%= snippet ''epel'' -%>\n<% end -%>\n\n<%= snippet ''redhat_register''
        %>\n\n<% if host_enc[''parameters''][''realm''] && @host.realm && (@host.realm.realm_type
        == ''FreeIPA'' || @host.realm.realm_type == ''Red Hat Identity Management'')
        -%>\n<%= snippet ''freeipa_register'' %>\n<% end -%>\n\n<% unless host_param_false?(''package_upgrade'')
        -%>\n# update all the base packages from the updates repository\nif [ -f /usr/bin/dnf
        ]; then\n  dnf -y update\nelse\n  yum -t -y update\nfi\n<% end -%>\n\n<%=
        snippet(''remote_execution_ssh_keys'') %>\n\n<% if plugin_present?(''katello'')
        && host_param_true?(''enable-remote-execution-pull'') -%>\n<%= save_to_file(''/root/remote_execution_pull_setup.sh'',
        snippet(''remote_execution_pull_setup''), verbatim: true) %>\nchmod +x /root/remote_execution_pull_setup.sh\n/root/remote_execution_pull_setup.sh\n<%
        end -%>\n\n<%= snippet \"blacklist_kernel_modules\" %>\n\n<%= snippet_if_exists(template_name
        + \" custom post\") -%>\n<% if chef_enabled %>\n<%= snippet ''chef_client''
        %>\n<% end -%>\n\n<% if puppet_enabled %>\n<% if host_param_true?(''enable-puppetlabs-repo'')
        || host_param_true?(''enable-official-puppet8-repo'') || host_param_true?(''enable-official-puppet7-repo'')
        || host_param_true?(''enable-puppetlabs-puppet6-repo'') || host_param_true?(''enable-puppetlabs-puppet5-repo'')
        -%>\n<%= snippet ''puppetlabs_repo'' %>\n<% end -%>\n<%= snippet ''puppet_setup''
        %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet ''saltstack_setup'' %>\n<%
        end -%>\n\n<% if host_param_true?(''ansible_tower_provisioning'') -%>\n<%=
        save_to_file(''/root/ansible_provisioning_call.sh'', snippet(''ansible_tower_callback_script''))
        %>\nchmod +x /root/ansible_provisioning_call.sh\n/root/ansible_provisioning_call.sh\n<%
        end -%>\n\nsync\n\n<%= snippet ''schedule_reboot'' -%>\n\nexit 0\n","locked":false,"snippet":false,"description":"A
        finish template executed at the end of the image based provisioning\nusing
        the image without user data. Foreman connects to the VM over SSH\nand runs
        the script rendered from this template. It is meant to be run\non RPM based
        distributons.\n\nThis template accepts the following parameters:\n- bootloader-append:
        string (default=\"nofb quiet splash=quiet\")\n- force-puppet: boolean (default=false)\n-
        skip-puppet-setup: boolean (default=false)\n- use-ntp: boolean (default depends
        on OS release)\n- ntp-server: string (default=undef)\n- package_upgrade: boolean
        (default=true)\n- salt_master: string (default=undef)\n- enable-remote-execution-pull:
        boolean (default=false)","created_at":"2024-06-27 17:28:08 UTC","updated_at":"2024-07-03
        14:59:41 UTC","id":43,"name":"Kickstart default finish","template_kind_id":8,"template_kind_name":"finish","template_combinations":[],"operatingsystems":[{"id":1,"name":"RedHat","title":"RHEL
        8.10"}],"os_default_templates":[{"id":7,"provisioning_template_id":43,"provisioning_template_name":"Kickstart
        default finish","template_kind_id":8,"template_kind_name":"finish","operatingsystem_id":1,"operatingsystem_name":"RHEL
        8.10"}],"locations":[{"id":12,"name":"Test Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '4931'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=71
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/52
  response:
    body:
      string: '{"template":"#!gpxe\n<%#\nkind: iPXE\nname: Kickstart default iPXE\nmodel:
        ProvisioningTemplate\noses:\n- AlmaLinux\n- CentOS\n- CentOS_Stream\n- Fedora\n-
        RedHat\n- Rocky\ndescription: |\n  The template to render iPXE installation
        script for kickstart based distributions\n  The output is deployed on the
        host''s subnet TFTP proxy.\n  See https://ipxe.org/scripting for more details\ntest_on:\n-
        host4dhcp\n- host6dhcp\n- host4and6dhcp\n- host4static\n- host6static\n-%>\n\necho
        Trying to ping Gateway: ${netX/gateway}\nping --count 1 ${netX/gateway} ||
        echo Ping to Gateway failed or ping command not available.\necho Trying to
        ping DNS: ${netX/dns}\nping --count 1 ${netX/dns} || echo Ping to DNS failed
        or ping command not available.\n\nkernel <%= \"#{@host.url_for_boot(:kernel)}\"
        %> initrd=initrd.img <%= pxe_kernel_options %> <%= snippet(\"kickstart_kernel_options\",
        variables: {ipxe_net: true}).strip %>\ninitrd <%= \"#{@host.url_for_boot(:initrd)}\"
        %>\nimgstat\nsleep 2\nboot\n","locked":false,"snippet":false,"description":"The
        template to render iPXE installation script for kickstart based distributions\nThe
        output is deployed on the host''s subnet TFTP proxy.\nSee https://ipxe.org/scripting
        for more details","created_at":"2024-06-27 17:28:08 UTC","updated_at":"2024-07-03
        14:59:41 UTC","id":52,"name":"Kickstart default iPXE","template_kind_id":6,"template_kind_name":"iPXE","template_combinations":[],"operatingsystems":[{"id":1,"name":"RedHat","title":"RHEL
        8.10"}],"os_default_templates":[{"id":5,"provisioning_template_id":52,"provisioning_template_name":"Kickstart
        default iPXE","template_kind_id":6,"template_kind_name":"iPXE","operatingsystem_id":1,"operatingsystem_name":"RHEL
        8.10"}],"locations":[{"id":12,"name":"Test Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '2008'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=70
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/4
  response:
    body:
      string: '{"template":"<%#\nkind: PXEGrub\nname: Kickstart default PXEGrub\nmodel:
        ProvisioningTemplate\noses:\n- AlmaLinux\n- CentOS\n- CentOS_Stream\n- Fedora\n-
        RedHat\n- Rocky\ndescription: |\n  The template to render Grub bootloader
        configuration for kickstart based distributions.\n  The output is deployed
        on the host''s subnet TFTP proxy.\n  This template is for legacy Grub 1.x,
        you are probably looking for Grub2.\ntest_on:\n- host4dhcp\n- host6dhcp\n-
        host4and6dhcp\n- host4static\n- host6static\n-%>\n# This file was deployed
        via ''<%= template_name %>'' template\n\ndefault=0\ntimeout=<%= host_param(''loader_timeout'')
        || 10 %>\n\ntitle <%= template_name %>\n  root (nd)\n  kernel (nd)/../<%=
        @kernel %> <%= pxe_kernel_options %> <%= snippet(\"kickstart_kernel_options\").strip
        %>\n  initrd (nd)/../<%= @initrd %>\n\n<%= snippet_if_exists(template_name
        + \" custom menu\") %>\n","locked":false,"snippet":false,"description":"The
        template to render Grub bootloader configuration for kickstart based distributions.\nThe
        output is deployed on the host''s subnet TFTP proxy.\nThis template is for
        legacy Grub 1.x, you are probably looking for Grub2.","created_at":"2024-06-27
        17:28:07 UTC","updated_at":"2024-07-03 14:59:41 UTC","id":4,"name":"Kickstart
        default PXEGrub","template_kind_id":4,"template_kind_name":"PXEGrub","template_combinations":[],"operatingsystems":[{"id":1,"name":"RedHat","title":"RHEL
        8.10"}],"os_default_templates":[{"id":3,"provisioning_template_id":4,"provisioning_template_name":"Kickstart
        default PXEGrub","template_kind_id":4,"template_kind_name":"PXEGrub","operatingsystem_id":1,"operatingsystem_name":"RHEL
        8.10"}],"locations":[{"id":12,"name":"Test Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1938'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=69
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/8
  response:
    body:
      string: '{"template":"<%#\nkind: PXEGrub2\nname: Kickstart default PXEGrub2\nmodel:
        ProvisioningTemplate\noses:\n- AlmaLinux\n- CentOS\n- CentOS_Stream\n- Fedora\n-
        RedHat\n- Rocky\ndescription: |\n  The template to render Grub2 bootloader
        configuration for kickstart based distributions.\n  The output is deployed
        on the host''s subnet TFTP proxy.\ntest_on:\n- host4dhcp\n- host6dhcp\n- host4and6dhcp\n-
        host4static\n- host6static\n-%>\n# This file was deployed via ''<%= template_name
        %>'' template\n<%\n  rhel_compatible = @host.operatingsystem.family == ''Redhat''
        && @host.operatingsystem.name != ''Fedora''\n  os_major = @host.operatingsystem.major.to_i\n\n  if
        rhel_compatible && os_major == 7 && [''i386'',''x86_64''].include?(@host.architecture.to_s)
        && @host.pxe_loader_efi?\n    #\n    # The linuxefi and initrdefi commands,
        despite their names, are specific to\n    # x86 and its \"EFI Handover Protocol.\"
        They do not exist in upstream Grub\n    # and have been added to Fedora''s
        since Fedora 17.\n    #\n    # https://docs.kernel.org/arch/x86/boot.html#efi-handover-protocol-deprecated\n    #
        https://src.fedoraproject.org/rpms/grub2/blob/f39/f/0004-Add-support-for-Linux-EFI-stub-loading.patch\n    #\n    #
        EL6''s kernel did not support EFI Handover (\"kernel too old\"). EL7''s does,\n    #
        and its Grubby generates {linux,initrd}efi commands (excluding aarch64),\n    #
        but that ends in EL8''s BLS support.\n    #\n    # https://projects.theforeman.org/issues/24026\n    #
        https://git.centos.org/rpms/grubby/blob/c7/f/SOURCES/0008-Use-the-correct-load-commands-for-aarch64-efi.patch\n    #
        https://git.centos.org/rpms/grub2/blob/c8s/f/SOURCES/0207-blscfg-Get-rid-of-the-linuxefi-linux16-linux-distinc.patch\n    #\n    linuxcmd
        = \"linuxefi\"\n    initrdcmd = \"initrdefi\"\n  else\n    linuxcmd = \"linux\"\n    initrdcmd
        = \"initrd\"\n  end\n-%>\n\nset default=<%= host_param(''default_grub_install_entry'')
        || 0 %>\nset timeout=<%= host_param(''loader_timeout'') || 10 %>\n\nmenuentry
        ''<%= template_name %>'' {\n  <%= linuxcmd %> <%= @kernel %> <%= pxe_kernel_options
        %> <%= snippet(\"kickstart_kernel_options\").strip %>\n  <%= initrdcmd %>
        <%= @initrd %>\n}\n\n<%\n# Workaround for https://bugzilla.redhat.com/show_bug.cgi?id=1811561
        and https://bugzilla.redhat.com/show_bug.cgi?id=1842893\nsubnet = @host.provision_interface.subnet
        || @host.provision_interface.subnet6\nif subnet && subnet.httpboot\n  proxy_http_port
        = subnet.httpboot.httpboot_http_port\n  proxy_https_port = subnet.httpboot.httpboot_https_port\n  #
        Workaround for \"no DNS server configured\" https://bugzilla.redhat.com/show_bug.cgi?id=1842509\n  proxy_host
        = dns_lookup(subnet.httpboot.hostname)\n-%>\n<% if proxy_http_port -%>\nmenuentry
        ''<%= template_name %> EFI HTTP'' --id efi_http {\n  <%= linuxcmd %> (http,<%=
        proxy_host %>:<%= proxy_http_port %>)/httpboot/<%= @kernel %> <%= pxe_kernel_options
        %> <%= snippet(\"kickstart_kernel_options\").strip %>\n  <%= initrdcmd %>
        (http,<%= proxy_host %>:<%= proxy_http_port %>)/httpboot/<%= @initrd %>\n}\n<%
        else -%>\n# Smart proxy does not have HTTPBoot feature with HTTP port enabled,
        skipping EFI HTTP boot menu entry\n<% end -%>\n\n<% if proxy_https_port -%>\nmenuentry
        ''<%= template_name %> EFI HTTPS'' --id efi_https {\n  <%= linuxcmd %> (https,<%=
        proxy_host %>:<%= proxy_https_port %>)/httpboot/<%= @kernel %> <%= pxe_kernel_options
        %> <%= snippet(\"kickstart_kernel_options\").strip %>\n  <%= initrdcmd %>
        (https,<%= proxy_host %>:<%= proxy_https_port %>)/httpboot/<%= @initrd %>\n}\n<%
        else -%>\n# Smart proxy does not have HTTPBoot feature with HTTPS port enabled,
        skipping EFI HTTPS boot menu entry\n<% end -%>\n\n<% end %>\n\n<%= snippet_if_exists(template_name
        + \" custom menu\") %>\n","locked":false,"snippet":false,"description":"The
        template to render Grub2 bootloader configuration for kickstart based distributions.\nThe
        output is deployed on the host''s subnet TFTP proxy.","created_at":"2024-06-27
        17:28:07 UTC","updated_at":"2024-07-03 14:59:41 UTC","id":8,"name":"Kickstart
        default PXEGrub2","template_kind_id":5,"template_kind_name":"PXEGrub2","template_combinations":[],"operatingsystems":[{"id":1,"name":"RedHat","title":"RHEL
        8.10"}],"os_default_templates":[{"id":4,"provisioning_template_id":8,"provisioning_template_name":"Kickstart
        default PXEGrub2","template_kind_id":5,"template_kind_name":"PXEGrub2","operatingsystem_id":1,"operatingsystem_name":"RHEL
        8.10"}],"locations":[{"id":12,"name":"Test Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '4703'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=68
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/17
  response:
    body:
      string: '{"template":"<%#\nkind: PXELinux\nname: Kickstart default PXELinux\nmodel:
        ProvisioningTemplate\noses:\n- AlmaLinux\n- CentOS\n- CentOS_Stream\n- Fedora\n-
        RedHat\n- Rocky\ndescription: |\n  The template to render PXELinux bootloader
        configuration for kickstart based distributions.\n  The output is deployed
        on the host''s subnet TFTP proxy.\ntest_on:\n- host4dhcp\n- host6dhcp\n- host4and6dhcp\n-
        host4static\n- host6static\n-%>\n# This file was deployed via ''<%= template_name
        %>'' template\n<%\n  rhel_compatible = @host.operatingsystem.family == ''Redhat''
        && @host.operatingsystem.name != ''Fedora''\n  os_major = @host.operatingsystem.major.to_i\n  os_minor
        = @host.operatingsystem.minor.to_i\n  timeout = host_param(''loader_timeout'').to_i
        * 10\n  timeout = 100 if timeout.nil? || timeout <= 0\n-%>\nDEFAULT menu\nMENU
        TITLE Booting into OS installer (ESC to stop)\nTIMEOUT <%= timeout %>\nONTIMEOUT
        installer\n\nLABEL installer\nMENU LABEL <%= template_name %>\nKERNEL <%=
        @kernel %>\nAPPEND initrd=<%= @initrd %> <%= pxe_kernel_options %> <%= snippet(\"kickstart_kernel_options\").strip
        %>\n<% if @host.architecture.to_s.match(/s390x?/i) %>\nINITRD <%= @initrd
        %>\n<% end %>\nIPAPPEND 2\n\n<%= snippet_if_exists(template_name + \" custom
        menu\") %>\n","locked":false,"snippet":false,"description":"The template to
        render PXELinux bootloader configuration for kickstart based distributions.\nThe
        output is deployed on the host''s subnet TFTP proxy.","created_at":"2024-06-27
        17:28:07 UTC","updated_at":"2024-07-03 14:59:41 UTC","id":17,"name":"Kickstart
        default PXELinux","template_kind_id":3,"template_kind_name":"PXELinux","template_combinations":[],"operatingsystems":[{"id":1,"name":"RedHat","title":"RHEL
        8.10"}],"os_default_templates":[{"id":2,"provisioning_template_id":17,"provisioning_template_name":"Kickstart
        default PXELinux","template_kind_id":3,"template_kind_name":"PXELinux","operatingsystem_id":1,"operatingsystem_name":"RHEL
        8.10"}],"locations":[{"id":12,"name":"Test Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '2250'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=67
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/130
  response:
    body:
      string: '{"template":"<%#\nkind: user_data\nname: Kickstart default user data\nmodel:
        ProvisioningTemplate\noses:\n- AlmaLinux\n- CentOS\n- CentOS_Stream\n- Fedora\n-
        Rocky\ndescription: |\n  This template is used during image based provisioning,
        when the image is configured to use user-data.\n  The output is a shell script
        that cloud-init runs to configures the VM\n  booted from the image. The image
        must have cloud-init installed in order for this to work.\n  This script can
        be used with kickstart based distributions images.\n-%>\n<%\n  rhel_compatible
        = @host.operatingsystem.family == ''Redhat'' && @host.operatingsystem.name
        != ''Fedora''\n  # safemode renderer does not support unary negation\n  puppet_enabled
        = !host_param_true?(''skip-puppet-setup'') && (host_puppet_server.present?
        || host_param_true?(''force-puppet''))\n  salt_enabled = host_param(''salt_master'')
        ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n-%>\n#!/bin/bash\n\n<%#
        Cloud instances frequently have incorrect hosts data %>\n<%= snippet ''fix_hosts''
        %>\n\n<% if @host.provision_method == ''image'' && root_pass.present? -%>\n#
        Install the root password\necho ''root:<%= root_pass -%>'' | /usr/sbin/chpasswd
        -e\n<% end -%>\n\n<%= snippet ''yum_proxy'' %>\n\n<%= snippet ''ntp'' %>\n\n<%
        if rhel_compatible && host_param_true?(''enable-epel'') -%>\n<%= snippet ''epel''
        -%>\n<% end -%>\n\n<%= snippet ''redhat_register'' %>\n\n<% if host_enc[''parameters''][''realm'']
        && @host.realm && (@host.realm.realm_type == ''FreeIPA'' || @host.realm.realm_type
        == ''Red Hat Identity Management'') -%>\n<%= snippet ''freeipa_register''
        %>\n<% end -%>\n\n<% unless host_param_false?(''package_upgrade'') -%>\n#
        update all the base packages from the updates repository\nif [ -f /usr/bin/dnf
        ]; then\n  dnf -y update\nelse\n  yum -t -y update\nfi\n<% end -%>\n\n<%=
        snippet(''remote_execution_ssh_keys'') %>\n\n<%= snippet \"blacklist_kernel_modules\"
        %>\n\n<% if chef_enabled %>\n<%= snippet ''chef_client'' %>\n<% end -%>\n\n<%
        if puppet_enabled %>\n<% if host_param_true?(''enable-puppetlabs-repo'') ||
        host_param_true?(''enable-official-puppet8-repo'') || host_param_true?(''enable-official-puppet7-repo'')
        || host_param_true?(''enable-puppetlabs-puppet6-repo'') || host_param_true?(''enable-puppetlabs-puppet5-repo'')
        -%>\n<%= snippet ''puppetlabs_repo'' %>\n<% end -%>\n<%= snippet ''puppet_setup''
        %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet ''saltstack_setup'' %>\n<%
        end -%>\n\n<% if host_param_true?(''ansible_tower_provisioning'') -%>\n    <%=
        save_to_file(''/tmp/ansible_provisioning_call.sh'', snippet(''ansible_tower_callback_script''))
        %>\n    /bin/sh /tmp/ansible_provisioning_call.sh\n<% end -%>\n\n# UserData
        still needs to mark the build as finished\n<%= snippet ''built'' %>\n","locked":false,"snippet":false,"description":"This
        template is used during image based provisioning, when the image is configured
        to use user-data.\nThe output is a shell script that cloud-init runs to configures
        the VM\nbooted from the image. The image must have cloud-init installed in
        order for this to work.\nThis script can be used with kickstart based distributions
        images.","created_at":"2024-06-27 17:28:09 UTC","updated_at":"2024-07-03 14:59:41
        UTC","id":130,"name":"Kickstart default user data","template_kind_id":10,"template_kind_name":"user_data","template_combinations":[],"operatingsystems":[{"id":1,"name":"RedHat","title":"RHEL
        8.10"}],"os_default_templates":[{"id":8,"provisioning_template_id":130,"provisioning_template_name":"Kickstart
        default user data","template_kind_id":10,"template_kind_name":"user_data","operatingsystem_id":1,"operatingsystem_name":"RHEL
        8.10"}],"locations":[{"id":12,"name":"Test Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '3929'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=66
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/86
  response:
    body:
      string: '{"template":"<%#\nname: kickstart_ifcfg_bonded_interface\nmodel: ProvisioningTemplate\nsnippet:
        true\nmodel: ProvisioningTemplate\nkind: snippet\ndescription: |\n  Generates
        the ifcfg configuration file for interface attached to a bond.\n  This is
        typically used by other templates and snippets that pass interface\n  object
        to be configured. It is not expected to be used directly.\n-%>\n<%= snippet(''kickstart_ifcfg_generic_interface'',
        :variables => {\n                  :interface => @interface,\n                  :subnet
        => @subnet,\n                  :subnet6 => @subnet6,\n                  :dhcp
        => @dhcp }) -%>\n<%-   if ( @host.operatingsystem.family == ''Redhat'' &&
        @host.operatingsystem.major.to_i <= 7 ) -%>\n<%=     \"NM_CONTROLLED=no\"
        %>\n<%-   end -%>\nMASTER=<%= @bond_identifier %>\nSLAVE=yes\n","locked":false,"snippet":true,"description":"Generates
        the ifcfg configuration file for interface attached to a bond.\nThis is typically
        used by other templates and snippets that pass interface\nobject to be configured.
        It is not expected to be used directly.","created_at":"2024-06-27 17:28:08
        UTC","updated_at":"2024-07-03 14:59:41 UTC","id":86,"name":"kickstart_ifcfg_bonded_interface","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1626'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=65
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/85
  response:
    body:
      string: '{"template":"<%#\nname: kickstart_ifcfg_bond_interface\nmodel: ProvisioningTemplate\nsnippet:
        true\nmodel: ProvisioningTemplate\nkind: snippet\ndescription: |\n  Generates
        the ifcfg configuration file for bond interface.\n  This is typically used
        by other templates and snippets that pass interface\n  object to be configured.
        It is not expected to be used directly.\n-%>\n<%= snippet(''kickstart_ifcfg_generic_interface'',
        :variables => {\n                  :interface => @interface,\n                  :subnet
        => @subnet,\n                  :subnet6 => @subnet6,\n                  :dhcp
        => @dhcp }) -%>\nTYPE=Bond\n<%-   if @interface.mac.to_s.present? -%>\nMACADDR=\"<%=
        @interface.mac -%>\"\n<%-   end -%>\nBONDING_OPTS=\"<%= @interface.bond_options
        -%> mode=<%= @interface.mode -%>\"\nBONDING_MASTER=yes\n<%-   if ( @host.operatingsystem.family
        == ''Redhat'' && @host.operatingsystem.major.to_i <= 7 ) -%>\n<%=     \"NM_CONTROLLED=no\"
        %>\n<%-   end -%>\n","locked":false,"snippet":true,"description":"Generates
        the ifcfg configuration file for bond interface.\nThis is typically used by
        other templates and snippets that pass interface\nobject to be configured.
        It is not expected to be used directly.","created_at":"2024-06-27 17:28:08
        UTC","updated_at":"2024-07-03 14:59:42 UTC","id":85,"name":"kickstart_ifcfg_bond_interface","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1755'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=64
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/87
  response:
    body:
      string: '{"template":"<%#\nname: kickstart_ifcfg_generic_interface\nmodel: ProvisioningTemplate\nsnippet:
        true\nmodel: ProvisioningTemplate\nkind: snippet\ndescription: |\n  Generates
        the ifcfg configuration file for a generic network interface.\n  This is typically
        used by other templates and snippets that pass interface\n  object to be configured.
        It is not expected to be used directly.\n-%>\n<%- primary = @interface.primary
        ? ''yes'' : ''no'' -%>\nBOOTPROTO=\"<%= @dhcp ? ''dhcp'' : ''none'' -%>\"\n<%-
        unless @dhcp || @subnet.nil? -%>\n<%-   if @interface.ip.present? -%>\n<%=     \"IPADDR=\\\"#{@interface.ip}\\\"\"
        %>\n<%=     \"NETMASK=\\\"#{@subnet.mask}\\\"\" %>\n<%-     if @subnet.gateway.present?
        -%>\n<%=       \"GATEWAY=\\\"#{@subnet.gateway}\\\"\" %>\n<%-     end -%>\n<%-   end
        -%>\n<%- end -%>\n<%- if @interface.ip6.present? -%>\n<%=   \"IPV6INIT=yes\"
        %>\n<%=   \"IPV6_AUTOCONF=#{host_param_true?(''use-slaac'') ? ''yes'' : ''no''}\"
        %>\n<%=   \"IPV6ADDR=#{@interface.ip6}\" %>\n<%-   if !@subnet6.nil? && @subnet6.gateway.present?
        -%>\n<%=     \"IPV6_DEFAULTGW=#{@subnet6.gateway}\" %><%= ''%$real'' if @subnet6.gateway.match(/^fe80:/)
        %>\n<%-   end -%>\n<%=   \"IPV6_PEERDNS=#{primary}\" %>\n<%=   \"IPV6_PEERROUTES=#{primary}\"
        %>\n<%=   \"IPV6_DEFROUTE=#{primary}\" %>\n<%- end -%>\n<%- if @interface.domain
        -%>\nDOMAIN=\"<%= @interface.domain %>\"\n<%- end -%>\nDEVICE=$real\n<%- unless
        @interface.virtual? -%>\n<%=   \"HWADDR=\\\"#{@interface.mac}\\\"\" %>\n<%-
        end -%>\nONBOOT=yes\nPEERDNS=<%= primary %>\nPEERROUTES=<%= primary %>\nDEFROUTE=<%=
        primary %>\n<%- if @interface.primary -%>\n<%-   if !@dhcp && @subnet -%>\n<%-     @subnet.dns_servers.each_index
        do |index| -%>\n<%=       \"DNS#{index +1}=\\\"#{@subnet.dns_servers[index]}\\\"\"
        %>\n<%-     end -%>\n<%-   elsif !@dhcp && @subnet6 -%>\n<%-     @subnet6.dns_servers.each_index
        do |index| -%>\n<%=       \"DNS#{index +1}=\\\"#{@subnet6.dns_servers[index]}\\\"\"
        %>\n<%-     end -%>\n<%-   end -%>\n<%- end -%>\n<%- if @interface.virtual?
        && (!@subnet.nil? && (@subnet.has_vlanid? || @interface.vlanid.present?))
        -%>\n<%=   \"VLAN=yes\" %>\n<%-   if @attached_to_bond -%>\n<%-     if ( @host.operatingsystem.family
        == ''Redhat'' && @host.operatingsystem.major.to_i <= 7 ) -%>\n<%=       \"NM_CONTROLLED=no\"
        %>\n<%-     end -%>\n<%-   end -%>\n<%-   if @interface.identifier.match(/^vlan\\d+/)
        -%>\n<%=     \"VLAN_NAME_TYPE=VLAN_PLUS_VID_NO_PAD\" %>\n<%=     \"PHYSDEV=#{@interface.attached_to}\"
        %>\n<%-     if @bonding_interfaces.include?(@interface.attached_to) -%>\n<%=       \"TYPE=bonding\"
        %>\n<%-     end -%>\n<%-   end -%>\n<%- elsif @interface.virtual? && !@subnet.nil?
        && !@subnet.has_vlanid? && @interface.identifier.include?('':'') -%>\n<%=   \"TYPE=Alias\"
        %>\n<%- end -%>\n<%- if @subnet -%>\n<%=   \"MTU=#{@subnet.mtu}\" %>\n<%-
        elsif @subnet6 -%>\n<%=   \"MTU=#{@subnet6.mtu}\" %>\n<%- end -%>\n","locked":false,"snippet":true,"description":"Generates
        the ifcfg configuration file for a generic network interface.\nThis is typically
        used by other templates and snippets that pass interface\nobject to be configured.
        It is not expected to be used directly.","created_at":"2024-06-27 17:28:08
        UTC","updated_at":"2024-07-03 14:59:42 UTC","id":87,"name":"kickstart_ifcfg_generic_interface","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '3688'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=63
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/88
  response:
    body:
      string: '{"template":"<%#\nname: kickstart_ifcfg_get_identifier_names\nmodel:
        ProvisioningTemplate\nsnippet: true\nmodel: ProvisioningTemplate\nkind: snippet\ndescription:
        |\n  Generates shell snippet that detects the current identifier of a network
        interface\n  based on the MAC address. This is required in provisioning flows
        when reboot is involved\n  between when the network interfaces has been reported
        to the database and the actual\n  provisioning, e.g. when provisioning using
        discovery image. Interfaces reported by FDI\n  use naming convention used
        by FDI, e.g. eth0, while when provisioning a newer RHEL, interfaces\n  use
        bios dev names e.g. enp0s31f6.\n  This is typically used by other templates
        and snippets that pass interface\n  object to be configured. It is not expected
        to be used directly.\n-%>\n<%- if @identifier -%>\n<%=   \"real=\\\"#{@identifier}\\\"\"
        %>\n<%- else -%>\n<%-   if !@interface.inheriting_mac -%>\n<%=     \"\\nreal=`echo
        #{@interface.identifier}`\" -%>\n<%-   else -%>\n<%=     \"real=`grep -l #{@interface.inheriting_mac}
        /sys/class/net/*/{bonding_slave/perm_hwaddr,address} 2>/dev/null | awk -F
        ''/'' ''// {print $5}'' | head -1`\" -%>\n<%-   end -%>\n<%-   if @interface.virtual?
        -%>\n<%=     \"\\nreal=`echo #{@interface.identifier} | sed s/#{@interface.attached_to}/$real/`\"
        -%>\n<%-   end -%>\n<%- end -%>\n<%# ifcfg files are ignored by NM if their
        name contains colons so we convert colons to underscore %>\nsanitized_real=`echo
        $real | sed s/:/_/`\n","locked":false,"snippet":true,"description":"Generates
        shell snippet that detects the current identifier of a network interface\nbased
        on the MAC address. This is required in provisioning flows when reboot is
        involved\nbetween when the network interfaces has been reported to the database
        and the actual\nprovisioning, e.g. when provisioning using discovery image.
        Interfaces reported by FDI\nuse naming convention used by FDI, e.g. eth0,
        while when provisioning a newer RHEL, interfaces\nuse bios dev names e.g.
        enp0s31f6.\nThis is typically used by other templates and snippets that pass
        interface\nobject to be configured. It is not expected to be used directly.","created_at":"2024-06-27
        17:28:08 UTC","updated_at":"2024-07-03 14:59:42 UTC","id":88,"name":"kickstart_ifcfg_get_identifier_names","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '2712'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=62
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/89
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: kickstart_kernel_options\nmodel:
        ProvisioningTemplate\nsnippet: true\ndescription: |\n  The list of kernel
        options for initrd appended to the bootloader kernel line on Red Hat compatible
        distributions.\n  Typically renders to a string with the url where to fetch
        the OS installer answer files, e.g.\n    network ksdevice=bootif ks.device=bootif
        BOOTIF=01-52-54-00-8b-a3-86 inst.ks=http://foreman.example.com/unattended/provision
        inst.ks.sendmac ip=dhcp nameserver=192.168.122.1\n  Custom options can be
        added by setting the array parameter kickstart_kernel_custom_options\n-%>\n<%\n  rhel_compatible
        = @host.operatingsystem.family == ''Redhat'' && @host.operatingsystem.name
        != ''Fedora''\n  is_fedora = @host.operatingsystem.name == ''Fedora''\n  os_major
        = @host.operatingsystem.major.to_i\n  os_minor = @host.operatingsystem.minor.to_i\n  major
        = @host.operatingsystem.major.to_i\n  hostname = @host.name\n  iface = @host.provision_interface\n  mac
        = @host.provision_interface.mac\n  subnet4 = iface.subnet\n  subnet6 = iface.subnet6\n  dual_stack_fallback
        = host_param(''dual_stack_provision_fallback'')\n\n  custom_options = [host_param(''kickstart_kernel_custom_options'')].flatten.compact\n  options
        = []\n\n  if rhel_compatible && os_major < 8\n    # replaced with BOOTIF in
        EL8+\n    options.push(\"network\", \"ksdevice=bootif\", \"ks.device=bootif\")\n  end\n\n  if
        mac\n    # hardware type is always 01 (ethernet) unless specified otherwise\n    options.push(\"BOOTIF=#{host_param(\"hardware_type\",
        \"01\")}-#{mac.gsub('':'', ''-'')}\")\n  end\n\n  # tell Anaconda what to
        pass off to kickstart server\n  # both current and legacy syntax provided\n  if
        (is_fedora && os_major >= 33) || (rhel_compatible && os_major >= 8)\n    if
        subnet4 && !subnet4.dhcp_boot_mode?\n      options.push(\"inst.ks=#{foreman_url(''provision'',
        static: ''1'').gsub(\"&\", \"\\\\\\\\&\")}\")\n    elsif subnet6 && !subnet6.dhcp_boot_mode?\n      options.push(\"inst.ks=#{foreman_url(''provision'',
        static6: ''1'').gsub(\"&\", \"\\\\\\\\&\")}\")\n    else\n      options.push(\"inst.ks=#{foreman_url(''provision'').gsub(\"&\",
        \"\\\\\\\\&\")}\", \"inst.ks.sendmac\")\n    end\n  else\n    if subnet4 &&
        !subnet4.dhcp_boot_mode?\n      options.push(\"ks=#{foreman_url(''provision'',
        static: ''1'').gsub(\"&\", \"\\\\\\\\&\")}\")\n    elsif subnet6 && !subnet6.dhcp_boot_mode?\n      options.push(\"ks=#{foreman_url(''provision'',
        static6: ''1'').gsub(\"&\", \"\\\\\\\\&\")}\")\n    else\n      options.push(\"ks=#{foreman_url(''provision'').gsub(\"&\",
        \"\\\\\\\\&\")}\", \"kssendmac\", \"ks.sendmac\")\n    end  \n  end\n\n  #
        networking credentials\n  if subnet4 && subnet6\n    if dual_stack_fallback
        == ''IPv4''\n      subnet6 = false\n    elsif dual_stack_fallback == ''IPv6''\n      subnet4
        = false\n    else\n      raise(\"Dual-stack provisioning not supported, set
        parameter ''dual_stack_provision_fallback''\")\n    end\n  end\n  options.push(\"dualstack!\")
        if subnet4 && subnet6\n  if subnet4 && subnet4.dhcp_boot_mode?\n    options.push(\"ip=dhcp\")
        if rhel_compatible && major >= 7\n  elsif subnet4 && !subnet4.dhcp_boot_mode?\n    if
        rhel_compatible && major < 7\n      dns_servers = subnet4.dns_servers.join('','')\n      if
        @ipxe_net\n        options.push(''ip=${netX/ip} netmask=${netX/netmask} gateway=${netX/gateway}
        dns=${dns}'')\n      else\n        options.push(\"ip=#{iface.ip}\", \"netmask=#{subnet4.mask}\",
        \"gateway=#{subnet4.gateway}\", \"dns=#{dns_servers}\")\n      end\n    else\n      if
        @ipxe_net\n        options.push(\"ip=${netX/ip}::${netX/gateway}:${netX/netmask}:#{hostname}:#{iface.identifier}:none
        nameserver=${dns}\")\n      else\n        options.push(\"ip=#{iface.ip}::#{subnet4.gateway}:#{subnet4.mask}:#{hostname}:#{iface.identifier}:none\")\n      end\n    end\n  elsif
        subnet6 && subnet6.dhcp_boot_mode? && rhel_compatible && major >= 7\n    if
        host_param_true?(\"use-slaac\")\n      options.push(\"ip=auto6\")\n    else\n      options.push(\"ip=dhcp6\")\n    end\n  elsif
        subnet6 && !subnet6.dhcp_boot_mode?\n    raise(\"Static IPv6 provisioning
        works on RHEL7 or newer\") if rhel_compatible && major < 7\n    gw = subnet6.gateway
        ? \"[#{subnet6.gateway}]\" : \"\"\n    options.push(\"ip=[#{iface.ip6}]::#{gw}:#{subnet6.cidr}:#{hostname}:#{iface.identifier}:none\")\n  end\n\n  #
        nameservers - must be present even for DHCP subnets because of bug:\n  # https://bugzilla.redhat.com/show_bug.cgi?id=1795276\n  if
        subnet4 && !@ipxe_net\n    subnet4.dns_servers.each { |server|\n      options.push(\"nameserver=#{server}\")\n    }\n  elsif
        subnet6 && !@ipxe_net\n    subnet6.dns_servers.each { |server|\n      options.push(\"nameserver=#{server}\")\n    }\n  end\n\n  #
        bond\n  if iface.bond? && rhel_compatible && os_major >= 6\n    bond_slaves
        = iface.attached_devices_identifiers.join('','')\n    options.push(\"bond=#{iface.identifier}:#{bond_slaves}:mode=#{iface.mode},#{iface.bond_options.tr(''
        '', '','')}\")\n  end\n\n  # VLAN (only on physical is recognized)\n  if iface.virtual?
        && iface.tag.present? && iface.attached_to.present?\n    if iface.attached_to.match
        ''bond''\n      @host.bond_interfaces.each do |bond_interface|\n          if
        bond_interface.identifier == iface.attached_to\n              bond_slaves
        = bond_interface.attached_devices_identifiers.join('','')\n              options.push(\"bond=#{bond_interface.identifier}:#{bond_slaves}:mode=#{bond_interface.mode},#{bond_interface.bond_options.tr(''
        '', '','')}\")\n          end\n      end\n    end\n    if (is_fedora && os_major
        < 17) || (rhel_compatible && os_major < 7)\n      options.push(\"vlanid=#{iface.tag}\")\n    else\n      options.push(\"vlan=#{iface.attached_to}.#{iface.tag}:#{iface.attached_to}\")\n    end\n  end\n\n  if
        host_param(''kickstart_liveimg'')\n    options.push(\"inst.stage2=#{medium_uri}\")\n  end\n\n  #
        S390x architecture has a different stage two image:\n  # https://access.redhat.com/solutions/4206591\n  if
        @host.architecture.to_s.match(/s390x?/i)\n    options.push(\"inst.cmdline\")\n    options.push(\"inst.repo=#{medium_uri}\")\n  end\n\n  #
        FIPS\n  if !is_fedora && os_major >= 7 && host_param_true?(''fips_enabled'')\n    options.push(''fips=1'')\n  end\n\n  nic_delay
        = subnet4&.nic_delay || subnet6&.nic_delay\n  if nic_delay && rhel_compatible
        && major >= 7\n    [\"dhcp\", \"iflink\", \"ifup\", \"route\", \"ipv6dad\",
        \"ipv6auto\", \"carrier\"].each do |type|\n      options.push(\"rd.net.timeout.#{type}=#{nic_delay}\")\n    end\n  elsif
        nic_delay\n    options.push(\"nicdelay=#{nic_delay} linksleep=#{nic_delay}\")\n  end\n\n  #
        add user specified custom options if specified (noop if not)\n  options.concat(custom_options)\n-%>\n<%#
        do not add newline after the next line %>\n<%= options.join('' '') -%>\n","locked":false,"snippet":true,"description":"The
        list of kernel options for initrd appended to the bootloader kernel line on
        Red Hat compatible distributions.\nTypically renders to a string with the
        url where to fetch the OS installer answer files, e.g.\n  network ksdevice=bootif
        ks.device=bootif BOOTIF=01-52-54-00-8b-a3-86 inst.ks=http://foreman.example.com/unattended/provision
        inst.ks.sendmac ip=dhcp nameserver=192.168.122.1\nCustom options can be added
        by setting the array parameter kickstart_kernel_custom_options","created_at":"2024-06-27
        17:28:08 UTC","updated_at":"2024-07-03 14:59:42 UTC","id":89,"name":"kickstart_kernel_options","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '7802'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=61
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/91
  response:
    body:
      string: '{"template":"<%#\nname: kickstart_networking_setup\nmodel: ProvisioningTemplate\nsnippet:
        true\nkind: snippet\ndescription: |\n  Generates a complete shell script that
        creates ifcfg configuration files for all\n  host''s network interfaces. Typically
        used on Red Hat based distributions.\n-%>\n<%- bonded_interfaces = [] -%>\n<%-
        bonding_interfaces = [] -%>\n<%- @host.bond_interfaces.each do |bond| -%>\n<%-   bonding_interfaces.push(bond.identifier)
        -%>\n<%=   \"# #{bond.identifier} interface\" %>\n<%=   snippet(''kickstart_ifcfg_get_identifier_names'',
        :variables => { :identifier => bond.identifier }) %>\n<%-   ifcfg = snippet(''kickstart_ifcfg_bond_interface'',
        :variables => {\n                        :interface => bond,\n                        :subnet
        => bond.subnet,\n                        :subnet6 => bond.subnet6,\n                        :dhcp
        => bond.subnet&.dhcp_boot_mode? }) -%>\n<%=   save_to_file(''/etc/sysconfig/network-scripts/ifcfg-$sanitized_real'',
        ifcfg) %>\n\n<%-   @host.interfaces_with_identifier(bond.attached_devices_identifiers).each
        do |interface| -%>\n<%-     next if !interface.managed? -%>\n<%=     \"# #{interface.identifier}
        interface\" %>\n<%=     snippet(''kickstart_ifcfg_get_identifier_names'',
        :variables => { :interface => interface }) -%>\n<%-     ifcfg = snippet(''kickstart_ifcfg_bonded_interface'',
        :variables => {\n                          :interface => interface,\n                          :subnet
        => interface.subnet,\n                          :subnet6 => interface.subnet6,\n                          :dhcp
        => false,\n                          :bond_identifier => bond.identifier })
        %>\n<%=     save_to_file(''/etc/sysconfig/network-scripts/ifcfg-$sanitized_real'',
        ifcfg) %>\n<%-     bonded_interfaces.push(interface.identifier) %>\n<%-   end
        -%>\n<%- end -%>\n\n<%- @host.managed_interfaces.each do |interface| %>\n<%-   next
        if !interface.managed? -%>\n<%-   next if bonded_interfaces.include?(interface.identifier)
        -%>\n\n<%-   interface_identifier = @host.bond_interfaces.map { |i| i.identifier
        }.include?(interface.attached_to) ? interface.identifier : nil %>\n<%=   \"#
        #{interface.identifier} interface\" %>\n<%=   snippet(''kickstart_ifcfg_get_identifier_names'',
        :variables => { :interface => interface, :identifier => interface_identifier
        }) -%>\n<%-   ifcfg = snippet(''kickstart_ifcfg_generic_interface'', :variables
        => {\n                        :interface => interface,\n                        :subnet
        => interface.subnet,\n                        :subnet6 => interface.subnet6,\n                        :bonding_interfaces
        => bonding_interfaces,\n                        :dhcp => interface.subnet&.dhcp_boot_mode?,\n                        :attached_to_bond
        => interface_identifier.present? }) %>\n<%=   save_to_file(''/etc/sysconfig/network-scripts/ifcfg-$sanitized_real'',
        ifcfg) %>\n<%- end %>\n","locked":false,"snippet":true,"description":"Generates
        a complete shell script that creates ifcfg configuration files for all\nhost''s
        network interfaces. Typically used on Red Hat based distributions.","created_at":"2024-06-27
        17:28:08 UTC","updated_at":"2024-07-03 14:59:42 UTC","id":91,"name":"kickstart_networking_setup","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '3605'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=60
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/90
  response:
    body:
      string: '{"template":"<%#\nname: kickstart_network_interface\nmodel: ProvisioningTemplate\nsnippet:
        true\nmodel: ProvisioningTemplate\nkind: snippet\ndescription: |\n  Generates
        network directive for a given interface. It is not expected to be used directly.\n-%>\n<%#\n  #
        Variables: iface, host, use_slaac, static, static6\n-%>\n<%if @iface.managed?
        -%>\n<%\nnetwork_options = []\nnameservers = []\nsubnet4 = @iface.subnet\nsubnet6
        = @iface.subnet6\n\nrhel_compatible = @host.operatingsystem.family == ''Redhat''
        && @host.operatingsystem.name != ''Fedora''\nis_fedora = @host.operatingsystem.name
        == ''Fedora''\nos_major = @host.operatingsystem.major.to_i\n\n# device and
        hostname\nif @iface.bond? || @iface.bridge?\n  network_options.push(\"--device=#{@iface.identifier}\")\nelse\n  network_options.push(\"--device=#{@iface.mac
        || @iface.identifier}\")\nend\nnetwork_options.push(\"--hostname #{@host.name}\")\n\n#
        single stack\nnetwork_options.push(\"--noipv6\") if subnet4 && !subnet6\nnetwork_options.push(\"--noipv4\")
        if !subnet4 && subnet6\n\n# dual stack MTU check\nraise(\"IPv4 and IPv6 subnets
        have different MTU\") if subnet4 && subnet6 && subnet4.mtu.present? && subnet6.mtu.present?
        && subnet4.mtu != subnet6.mtu\n\n# mtu method is taking into account both
        ipv4 and ipv6 stacks\nif @iface.respond_to?(:mtu) && @iface.mtu\n  network_options.push(\"--mtu=#{@iface.mtu}\")\nend\n\n#
        IPv4\nif subnet4\n  if !subnet4.dhcp_boot_mode? || @static\n    network_options.push(\"--bootproto
        static\")\n    network_options.push(\"--ip=#{@iface.ip}\")\n    network_options.push(\"--netmask=#{subnet4.mask}\")\n    network_options.push(\"--gateway=#{subnet4.gateway}\")\n  elsif
        subnet4.dhcp_boot_mode?\n    network_options.push(\"--bootproto dhcp\")\n  end\n\n  nameservers.concat(subnet4.dns_servers)\nend\n\n#
        IPv6\nif subnet6\n  if !subnet6.dhcp_boot_mode? || @static6\n    network_options.push(\"--ipv6=#{@iface.ip6}/#{subnet6.cidr}\")\n    network_options.push(\"--ipv6gateway=#{subnet6.gateway}\")\n  elsif
        subnet6.dhcp_boot_mode?\n    if @use_slaac\n      network_options.push(\"--ipv6
        auto\")\n    else\n      network_options.push(\"--ipv6 dhcp\")\n    end\n  end\n\n  nameservers.concat(subnet6.dns_servers)\nend\n\n#
        bond\nif @iface.bond?\n  bond_slaves = @iface.attached_devices_identifiers.join('','')\n  network_options.push(\"--bondslaves=#{bond_slaves}\")\n  network_options.push(\"--bondopts=mode=#{@iface.mode},#{@iface.bond_options.tr(''
        '', '','')}\")\nend\n\n# bridge\nif @iface.bridge?\n  bridge_slaves = @iface.attached_devices_identifiers.join('','')\n  network_options.push(\"--bridgeslaves=#{bridge_slaves}\")\n  #
        Currently no support for bridge options in the interface.\nend\n\n# VLAN (only
        on physical is recognized)\nif @iface.virtual? && @iface.tag.present? && @iface.attached_to.present?\n  network_options.push(\"--vlanid=#{@iface.tag}\")\n  network_options.push(\"--interfacename=vlan#{@iface.tag}\")
        if (is_fedora && os_major >= 21) || (rhel_compatible && os_major >= 7)\nend\n\n#
        DNS\nif nameservers.empty?\n  network_options.push(\"--nodns\")\nelse\n  network_options.push(\"--nameserver=#{nameservers.join('','')}\")\nend\n\n#
        Search domain - available from Fedora 39 (RHEL 10)\nif @iface.domain && ((is_fedora
        && os_major >= 39) || (rhel_compatible && os_major >= 10))\n  network_options.push(\"--ipv4-dns-search=#{@iface.domain}\")
        if subnet4\n  network_options.push(\"--ipv6-dns-search=#{@iface.domain}\")
        if subnet6\nend\n-%>\n<%= \"network #{network_options.join('' '')}\\n\" -%>\n<%
        end -%>\n","locked":false,"snippet":true,"description":"Generates network
        directive for a given interface. It is not expected to be used directly.","created_at":"2024-06-27
        17:28:08 UTC","updated_at":"2024-07-03 14:59:42 UTC","id":90,"name":"kickstart_network_interface","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '4195'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=59
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/65
  response:
    body:
      string: '{"template":"<%#\nkind: provision\nname: Kickstart oVirt-RHVH\nmodel:
        ProvisioningTemplate\noses:\n- oVirt\n- RHVH\ndescription: |\n  Provisioning
        template for oVirt Node and Red Hat Virtualization Host. It renders the kickstart\n  file.\n\n  This
        template accepts the following parameters:\n  - liveimg_name: string (default=squashfs.img)\n  -
        lang: string (default=\"en_US.UTF-8\")\n  - selinux-mode: string (default=\"enforcing\")\n  -
        keyboard: string (default=\"us\")\n  - time-zone: string (default=\"UTC\")\n  -
        ntp-server: string (default=\"0.fedora.pool.ntp.org\")\n  - disable-firewall:
        boolean (default=false)\n\n  This kickstart will only work with LVM THIN partitioning
        (''Kickstart default thin'')\n  and it requires the installation URL to have
        squashfs.img image extracted in the\n  root folder (or specified via ''liveimg_name''
        parameter). See oVirt Node documentation\n  or RHV Installation Manual, section
        5.2. Advanced installation.\n\n  By default, the template expects the squashfs.img
        to be present inside\n  the installation media. When using Katello for content
        management (the\n  kt_activation_key parameter is set), the liveimg_name is
        used to\n  specify relative path to the file and the template use repository_url\n  helper
        to generate an absolute path to the file (taking into account\n  also info
        about the content proxy relevant for the host)\n\n  For example, in case the
        squashfs.img is uploaded inside custom\n  product named ''oVirt'' and repository
        ''hypervisor'', the\n  liveimg_name would be ''custom/ovirt/hypervisor/squashfs.img''.\n  In
        this case, this repository would need to be part of the content\n  view the
        host is assigned to. It''s also possible to provide full url,\n  in which
        case it would be used without a change.\n-%>\n# This kickstart file was rendered
        from the Foreman provisioning template \"<%= @template_name %>\".\n\ninstall\n<%\nliveimg_name
        = host_param(''liveimg_name'') || ''squashfs.img''\nif host_param(''kt_activation_keys'')\n  liveimg_url
        = repository_url(liveimg_name, ''isos'')\nelse\n  liveimg_url = \"#{medium_uri}/#{liveimg_name}\"\nend\n%>\n\nliveimg
        --url=<%= liveimg_url %>\n\n<%\n# start with provisioning interface, then
        other non-bond interfaces and the bonds at the end\n@host.managed_interfaces.sort_by
        { |iface| (iface.bond? || iface.bridge?) 0 : iface.provision? 20 : 10 }.each
        |iface| do\n%>\n  <%= snippet(\n        ''kickstart_network_interface'',\n        variables:
        {\n          iface: iface,\n          host: @host,\n          use_slaac: false,\n          static:
        @static,\n          static6: @static6\n          }\n      ) -%>\n<%\nend\n-%>\n\n\nrootpw
        --iscrypted <%= root_pass %>\n<% if host_param_true?(''disable-firewall'')
        -%>\nfirewall --disable\n<% else -%>\nfirewall --service=ssh\n<% end -%>\nlang
        <%= host_param(''lang'') || ''en_US.UTF-8'' %>\ntimezone --utc <%= host_param(''time-zone'')
        || ''UTC'' %>\nselinux --<%= host_param(''selinux-mode'') || host_param(''selinux'')
        || ''enforcing'' %>\nkeyboard <%= host_param(''keyboard'') || ''us'' %>\nservices
        --enabled=sshd\ntext\nreboot\n<%= @host.diskLayout %>\n\n%post --log=/root/ks.post.log
        --erroronfail\nnodectl init\n<%= snippet ''redhat_register'' %>\n<%= snippet
        ''efibootmgr_netboot'' %>\n<% if host_param_true?(''host_registration_insights'')
        -%>\n<%= snippet ''insights'' -%>\n<% end -%>\n\n/usr/sbin/ntpdate -sub <%=
        host_param(''ntp-server'') || ''0.fedora.pool.ntp.org'' %>\n/usr/sbin/hwclock
        --systohc\n\n/usr/bin/curl <%= foreman_url(''built'') %>\nsync\nsystemctl
        reboot\n%end\n","locked":false,"snippet":false,"description":"Provisioning
        template for oVirt Node and Red Hat Virtualization Host. It renders the kickstart\nfile.\n\nThis
        template accepts the following parameters:\n- liveimg_name: string (default=squashfs.img)\n-
        lang: string (default=\"en_US.UTF-8\")\n- selinux-mode: string (default=\"enforcing\")\n-
        keyboard: string (default=\"us\")\n- time-zone: string (default=\"UTC\")\n-
        ntp-server: string (default=\"0.fedora.pool.ntp.org\")\n- disable-firewall:
        boolean (default=false)\n\nThis kickstart will only work with LVM THIN partitioning
        (''Kickstart default thin'')\nand it requires the installation URL to have
        squashfs.img image extracted in the\nroot folder (or specified via ''liveimg_name''
        parameter). See oVirt Node documentation\nor RHV Installation Manual, section
        5.2. Advanced installation.\n\nBy default, the template expects the squashfs.img
        to be present inside\nthe installation media. When using Katello for content
        management (the\nkt_activation_key parameter is set), the liveimg_name is
        used to\nspecify relative path to the file and the template use repository_url\nhelper
        to generate an absolute path to the file (taking into account\nalso info about
        the content proxy relevant for the host)\n\nFor example, in case the squashfs.img
        is uploaded inside custom\nproduct named ''oVirt'' and repository ''hypervisor'',
        the\nliveimg_name would be ''custom/ovirt/hypervisor/squashfs.img''.\nIn this
        case, this repository would need to be part of the content\nview the host
        is assigned to. It''s also possible to provide full url,\nin which case it
        would be used without a change.","created_at":"2024-06-27 17:28:08 UTC","updated_at":"2024-07-03
        14:59:42 UTC","id":65,"name":"Kickstart oVirt-RHVH","template_kind_id":7,"template_kind_name":"provision","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '5663'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=58
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/18
  response:
    body:
      string: '{"template":"<%#\nkind: PXELinux\nname: Kickstart oVirt-RHVH PXELinux\nmodel:
        ProvisioningTemplate\noses:\n- oVirt\n- RHVH\ndescription: |\n  The template
        to render PXELinux bootloader configuration for oVirt Node or Red Hat Virtualization
        Host.\n  The output is deployed on the host''s subnet TFTP proxy.\n-%>\nDEFAULT
        rhvh\n\nLABEL rhvh\nKERNEL <%= @kernel %>\nAPPEND initrd=<%= @initrd %> inst.ks=<%=
        foreman_url(\"provision\") %> inst.stage2=<%= medium_uri %> local_boot_trigger=<%=
        foreman_url(\"built\") %> intel_iommu=on\nIPAPPEND 2\n","locked":false,"snippet":false,"description":"The
        template to render PXELinux bootloader configuration for oVirt Node or Red
        Hat Virtualization Host.\nThe output is deployed on the host''s subnet TFTP
        proxy.","created_at":"2024-06-27 17:28:07 UTC","updated_at":"2024-07-03 14:59:42
        UTC","id":18,"name":"Kickstart oVirt-RHVH PXELinux","template_kind_id":3,"template_kind_name":"PXELinux","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1301'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=57
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/92
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: kickstart_rhsm\nmodel: ProvisioningTemplate\nsnippet:
        true\ndescription: |\n  Generate Anaconda RHSM configuration for Red Hat OS
        registration\ntest_on:\n- rhel9_dhcp\n-%>\n<%\n  subman_keys = host_param(''kt_activation_keys'')
        || host_param(''activation_key'')\n  subman_org = (plugin_present?(''katello'')
        && @host.rhsm_organization_label) || host_param(''subscription_manager_org'')\n  subman_registration
        = host_param_true?(''subscription_manager'') || subman_keys.present?\n  subman_hostname
        = \" --server-hostname #{@host.content_source.rhsm_url.host}\" if (plugin_present?(''katello'')
        && @host.content_source)\n  subman_rhsm_baseurl = \" --rhsm-baseurl #{@host.content_source.pulp_content_url}\"
        if (plugin_present?(''katello'') && @host.content_source)\n  subman_insights
        = '' --connect-to-insights'' if host_param_true?(''host_registration_insights'')\n\n  sys_role
        = \" --role ''#{host_param(''syspurpose_role'')}''\" if host_param(''syspurpose_role'')\n  sys_usage
        = \" --usage ''#{host_param(''syspurpose_usage'')}''\" if host_param(''syspurpose_usage'')\n  sys_sla
        = \" --sla ''#{host_param(''syspurpose_sla'')}''\" if host_param(''syspurpose_sla'')\n  sys_addons
        = \" #{host_param(''syspurpose_addons'').split('','')\n                                                  .map
        { |add_on| \"--addon ''#{add_on.strip}''\" }.join(\" \")}\" if host_param(''syspurpose_addons'')\n-%>\n<%
        if subman_registration -%>\nrhsm --organization=\"<%= subman_org %>\" --activation-key=\"<%=
        subman_keys %>\"<%= subman_hostname -%><%= subman_rhsm_baseurl -%><%= subman_insights
        -%>\n<% end -%>\n<%- if host_param(''syspurpose_role'') %>\nsyspurpose<%=
        sys_role %><%= sys_usage %><%= sys_sla %><%= sys_addons %>\n<% end -%>\n","locked":false,"snippet":true,"description":"Generate
        Anaconda RHSM configuration for Red Hat OS registration","created_at":"2024-06-27
        17:28:09 UTC","updated_at":"2024-07-03 14:59:42 UTC","id":92,"name":"kickstart_rhsm","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '2358'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=56
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/47
  response:
    body:
      string: '{"template":"<%#\nkind: host_init_config\nname: Linux host_init_config
        default\nmodel: ProvisioningTemplate\noses:\n- AlmaLinux\n- CentOS\n- CentOS_Stream\n-
        Fedora\n- Rocky\n- SLES\n- Debian\n- Ubuntu\ndescription: |\n  This template
        is used during the host registration to perform the initial host configuration.
        After the host\n  is created by starting the registration, the registration
        script asks for the host init config script, that\n  is rendered based on
        this template. It is rendered for the specific host therefore it contains
        instructions\n  specific for the OS of the host. It''s content can differ
        based on any parameters applicable for the host.\n\n  It deploys the CA certificate
        so any later communication with the Foreman is TLS secured. Then it\n  performs
        initial steps, such as puppet deployment, remote execution SSH key configuration
        etc. At the end\n  it informs Foreman that provisioning has finished.\n-%>\n#!/bin/bash\nset
        -e\n\necho \"# Running [<%= @host.name %>] host initial configuration\"\n\n<%=
        snippet_if_exists(''host_init_config_pre'') -%>\n\nexit_and_cancel_build()
        {\n  echo ''Host [<%= @host.name %>] initial configuration failed''\n\n  <%=
        indent(2, skip1: true, skip_content: ''EOF'') { snippet(''built'', :variables
        => {\n    :endpoint => ''failed'',\n    :method => ''POST'',\n    :post_data
        => ''Host initial configuration failed, please see the registration log for
        more details.'' }) }\n  -%>\n  exit 1\n}\n\nset +e\ntrap ''exit_and_cancel_build''
        ERR\n\n<% if !host_param_true?(''skip-puppet-setup'') && (host_puppet_server.present?
        || host_param_true?(''force-puppet'')) -%>\n<%= snippet ''puppetlabs_repo''
        %>\n<%= snippet ''puppet_setup'' %>\n<% end -%>\n\n<% if host_param_true?(''host_registration_remote_execution'')
        -%>\n<%= snippet ''remote_execution_ssh_keys'' %>\n<% end -%>\n\n<% if plugin_present?(''katello'')
        && host_param_true?(''host_registration_remote_execution_pull'') -%>\n<%=
        snippet ''remote_execution_pull_setup'' %>\n<% end -%>\n\n<%= install_packages(host_param(''host_packages''))
        -%>\n\n<% if host_param_true?(''host_registration_insights'') -%>\n<%= snippet
        ''insights'' %>\n\n<% end -%>\n\n<% if plugin_present?(''katello'') -%>\nif
        command -v subscription-manager &>/dev/null; then\n  echo \"Refreshing subscription
        data\"\n  subscription-manager refresh\nfi\n\n<% if host_param_true?(''redhat_install_host_tools'')
        -%>\n<%= install_packages(''katello-host-tools'') -%>\n<% end -%>\n\n<% if
        host_param_true?(''redhat_install_host_tracer_tools'') -%>\n<%= install_packages(''katello-host-tools-tracer'')
        -%>\n<% end -%>\n\n<% end -%>\n<%= update_packages if host_param_true?(''host_update_packages'')
        -%>\n\n<%= snippet_if_exists(''host_init_config_post'') -%>\n\n# Call home
        to exit build mode\n\ntrap - ERR\n<%= snippet ''built'' %>\n\nif [[ $? ==
        0 ]] ; then\n  echo \"Host [<%= @host.name %>] successfully configured.\"\nelse\n  echo
        \"Host [<%= @host.name %>] successfully configured, but failed to set built
        status.\"\nfi\n\n<% if plugin_present?(''katello'') && @host.operatingsystem.family
        == ''Redhat'' -%>\nsubscription-manager facts --update\n<% end -%>\n\nexit
        0\n","locked":false,"snippet":false,"description":"This template is used during
        the host registration to perform the initial host configuration. After the
        host\nis created by starting the registration, the registration script asks
        for the host init config script, that\nis rendered based on this template.
        It is rendered for the specific host therefore it contains instructions\nspecific
        for the OS of the host. It''s content can differ based on any parameters applicable
        for the host.\n\nIt deploys the CA certificate so any later communication
        with the Foreman is TLS secured. Then it\nperforms initial steps, such as
        puppet deployment, remote execution SSH key configuration etc. At the end\nit
        informs Foreman that provisioning has finished.","created_at":"2024-06-27
        17:28:08 UTC","updated_at":"2024-07-03 14:59:42 UTC","id":47,"name":"Linux
        host_init_config default","template_kind_id":2,"template_kind_name":"host_init_config","template_combinations":[],"operatingsystems":[{"id":1,"name":"RedHat","title":"RHEL
        8.10"},{"id":2,"name":"TempleOS","title":"TempleOS 1.2"}],"os_default_templates":[{"id":1,"provisioning_template_id":47,"provisioning_template_name":"Linux
        host_init_config default","template_kind_id":2,"template_kind_name":"host_init_config","operatingsystem_id":1,"operatingsystem_name":"RHEL
        8.10"},{"id":10,"provisioning_template_id":47,"provisioning_template_name":"Linux
        host_init_config default","template_kind_id":2,"template_kind_name":"host_init_config","operatingsystem_id":2,"operatingsystem_name":"TempleOS
        1.2"}],"locations":[{"id":12,"name":"Test Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '4933'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=55
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/93
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: ntp\nmodel: ProvisioningTemplate\nsnippet:
        true\ndescription: |\n  The snippet configuring the system time using a given
        NTP server\n  It respects the following parameters:\n  - use-ntp: boolean
        (default depends on OS release)\n  - ntp-server: string (default=undef)\n-%>\n<%\nrhel_compatible
        = @host.operatingsystem.family == ''Redhat'' && @host.operatingsystem.name
        != ''Fedora''\nis_fedora = @host.operatingsystem.name == ''Fedora''\nos_major
        = @host.operatingsystem.major.to_i\nuse_ntp = host_param_true?(''use-ntp'',
        (is_fedora && os_major < 16) || (rhel_compatible && os_major <= 6))\n-%>\n\necho
        \"Updating system time\"\n<% if use_ntp -%>\nyum -y install ntpdate\n  <%
        if host_param(''ntp-server'') -%>\n/usr/sbin/ntpdate -sub <%= host_param(''ntp-server'')
        %>\n  <% end -%>\nsystemctl enable --now ntpd\n<% else -%>\nsystemctl enable
        --now chronyd\n/usr/bin/chronyc -a makestep\n<% end -%>\n/usr/sbin/hwclock
        --systohc\n","locked":false,"snippet":true,"description":"The snippet configuring
        the system time using a given NTP server\nIt respects the following parameters:\n-
        use-ntp: boolean (default depends on OS release)\n- ntp-server: string (default=undef)","created_at":"2024-06-27
        17:28:09 UTC","updated_at":"2024-07-03 14:59:42 UTC","id":93,"name":"ntp","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1720'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=54
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/1
  response:
    body:
      string: '{"template":"<%#\nkind: POAP\nname: NX-OS default POAP setup\nmodel:
        ProvisioningTemplate\noses:\n- NX-OS\ndescription: |\n  This is a placeholder
        template that must be replaced with the actual template\n  that renders the
        POAP script. DHCP options must be configured to point NX-OS to\n  download
        the POAP from Foreman. For more details, see https://projects.theforeman.org/issues/10526\n-%>\n#
        This template file is only a placeholder. Cisco provides sample Python\n#
        scripts for POAP, but they are only distributed through their support site.\n#
        You will need to provide your own POAP scripts or download one from Cisco.\n","locked":false,"snippet":false,"description":"This
        is a placeholder template that must be replaced with the actual template\nthat
        renders the POAP script. DHCP options must be configured to point NX-OS to\ndownload
        the POAP from Foreman. For more details, see https://projects.theforeman.org/issues/10526","created_at":"2024-06-27
        17:28:07 UTC","updated_at":"2024-07-03 14:59:42 UTC","id":1,"name":"NX-OS
        default POAP setup","template_kind_id":12,"template_kind_name":"POAP","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1475'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=53
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/94
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: pkg_manager\nmodel: ProvisioningTemplate\nsnippet:
        true\ndescription: |\n  Select package manager for the OS. Snippet sets the
        package manager\n  in the PKG_MANAGER env variable so it can be used in templates
        like this:\n  $PKG_MANAGER install -y pkg1 pkg2\n-%>\nif [ -f /etc/os-release
        ] ; then\n  . /etc/os-release\nfi\n\nif [ \"${NAME%.*}\" = ''FreeBSD'' ];
        then\n  PKG_MANAGER=''pkg''\n  PKG_MANAGER_INSTALL=\"${PKG_MANAGER} install
        -y\"\n  PKG_MANAGER_REMOVE=\"${PKG_MANAGER} delete -y\"\n  PKG_MANAGER_UPGRADE=\"${PKG_MANAGER}
        install -y\"\nelif [ -f /etc/fedora-release -o -f /etc/redhat-release -o -f
        /etc/amazon-linux-release -o -f /etc/system-release ]; then\n  PKG_MANAGER=''dnf''\n  if
        [ -f /etc/redhat-release -a \"${VERSION_ID%.*}\" -le 7 ]; then\n    PKG_MANAGER=''yum''\n  elif
        [ -f /etc/system-release ]; then\n    PKG_MANAGER=''yum''\n  fi\n  PKG_MANAGER_INSTALL=\"${PKG_MANAGER}
        install -y\"\n  PKG_MANAGER_REMOVE=\"${PKG_MANAGER} remove -y\"\n  PKG_MANAGER_UPGRADE=\"${PKG_MANAGER}
        upgrade -y\"\nelif [ -f /etc/debian_version ]; then\n  PKG_MANAGER=''apt-get''\n  PKG_MANAGER_INSTALL=\"${PKG_MANAGER}
        install -y\"\n  PKG_MANAGER_REMOVE=\"${PKG_MANAGER} remove -y\"\n  PKG_MANAGER_UPGRADE=\"${PKG_MANAGER}
        -o Dpkg::Options::=''--force-confdef'' -o Dpkg::Options::=''--force-confold''
        -o APT::Get::Upgrade-Allow-New=''true'' upgrade -y\"\nelif [ -f /etc/arch-release
        ]; then\n  PKG_MANAGER=''pacman''\n  PKG_MANAGER_INSTALL=\"${PKG_MANAGER}
        --noconfirm -S\"\n  PKG_MANAGER_REMOVE=\"${PKG_MANAGER} --noconfirm -R\"\n  PKG_MANAGER_UPGRADE=\"${PKG_MANAGER}
        --noconfirm -S\"\nelif [ x$ID = xopensuse-tumbleweed -o x$ID = xsles ]; then\n  PKG_MANAGER=''zypper''\n  PKG_MANAGER_INSTALL=\"${PKG_MANAGER}
        --non-interactive install --auto-agree-with-licenses\"\n  PKG_MANAGER_REMOVE=\"${PKG_MANAGER}
        --non-interactive remove\"\n  PKG_MANAGER_UPGRADE=\"${PKG_MANAGER} --non-interactive
        update\"\nfi\n","locked":false,"snippet":true,"description":"Select package
        manager for the OS. Snippet sets the package manager\nin the PKG_MANAGER env
        variable so it can be used in templates like this:\n$PKG_MANAGER install -y
        pkg1 pkg2","created_at":"2024-06-27 17:28:09 UTC","updated_at":"2024-07-03
        14:59:42 UTC","id":94,"name":"pkg_manager","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '2681'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=52
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/95
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: preseed_autoinstall_clevis_tang_wrapper\nmodel:
        ProvisioningTemplate\nsnippet: true\ndescription: |\n  Wrapper snippet to
        set up Clevis/Tang disk encryption.\n  Requires Ubuntu >= 22.04.3.\n  The
        snippet is automatically indented by 2 spaces. For reference:\n  https://ubuntu.com/server/docs/install/autoinstall-reference\n%>\n-
        |\n  cat > /target/tmp/disk_enc_clevis_tang.sh <<\"WRAPPER\"\n  #!/bin/sh\n<%=
        indent(2) { snippet ''disk_enc_clevis_tang'' } %>\n  WRAPPER\n- curtin in-target
        -- bash /tmp/disk_enc_clevis_tang.sh\n- curtin in-target -- rm /tmp/disk_enc_clevis_tang.sh\n","locked":false,"snippet":true,"description":"Wrapper
        snippet to set up Clevis/Tang disk encryption.\nRequires Ubuntu >= 22.04.3.\nThe
        snippet is automatically indented by 2 spaces. For reference:\nhttps://ubuntu.com/server/docs/install/autoinstall-reference","created_at":"2024-06-27
        17:28:09 UTC","updated_at":"2024-07-03 14:59:42 UTC","id":95,"name":"preseed_autoinstall_clevis_tang_wrapper","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1438'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=51
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/131
  response:
    body:
      string: '{"template":"<%#\nkind: user_data\nname: Preseed Autoinstall cloud-init
        user data\nmodel: ProvisioningTemplate\noses:\n- ubuntu\ntest_on:\n- ubuntu_autoinst4dhcp\ndescription:
        |\n  The provisioning template for Autoinstall based distributions. To customize
        the installation,\n  modify the host parameters\n\n  This template accepts
        the following parameters:\n  - lang: string (default=\"en_US.UTF-8\")\n  -
        keyboard: string (default=\"us\")\n  - package_upgrade: boolean (default=false)\n  -
        remote_execution_ssh_keys: string (default=\"\")\n  - username_to_create:
        string (default=\"root\")\n  - realname_to_create: string (default=username_to_create)\n  -
        password_to_create: string (default=@host.root_pass)\n-%>\n<%-\nusername_to_create
        = host_param(''username_to_create'', ''root'')\nrealname_to_create = host_param(''realname_to_create'')
        || username_to_create\npassword_to_create = host_param(''password_to_create'')
        || @host.root_pass\nenable_auto_update = (host_param_true?(''package_upgrade'')
        && !host_param(''kt_activation_keys''))\nos_major = @host.operatingsystem.major.to_i\nos_minor
        = @host.operatingsystem.minor.to_i\n-%>\n#cloud-config\nautoinstall:\n  version:
        1\n  apt:\n    geoip: false\n    preserve_sources_list: false\n    primary:\n      -
        arches: [amd64, i386]\n        uri: http://archive.ubuntu.com/ubuntu\n      -
        arches: [default]\n        uri: http://ports.ubuntu.com/ubuntu-ports\n<% unless
        enable_auto_update -%>\n    disable_components: [multiverse]\n    disable_suites:
        [backports,security,updates] \n    fallback: offline-install\n<% end -%>\n<%=
        indent(4) { snippet_if_exists(template_name + \" custom apt\") } -%>\n  user-data:\n    disable_root:
        false\n    fqdn: <%= @host.name %>\n    users:\n    - name: <%= username_to_create
        %>\n      gecos: <%= realname_to_create %>\n      lock_passwd: false\n      hashed_passwd:
        <%= password_to_create %>\n<% if !host_param(''remote_execution_ssh_keys'').blank?
        -%>\n<%   if host_param(''remote_execution_ssh_keys'').is_a?(String) -%>\n      ssh_authorized_keys:
        [<%= host_param(''remote_execution_ssh_keys'') %>]\n<%   else -%>\n      ssh_authorized_keys:
        <%= host_param(''remote_execution_ssh_keys'') %>\n<%   end -%>\n<% end -%>\n  keyboard:\n    layout:
        <%= host_param(''keyboard'', ''us'') %>\n    toggle: null\n    variant: ''''\n  locale:
        <%= host_param(''lang'', ''en_US'') %>.UTF-8\n<%= snippet ''preseed_netplan_setup''
        -%>\n  ssh:\n    allow-pw: true\n    install-server: true\n  updates: security\n<%=
        indent(2) { @host.diskLayout } %>\n<%= indent(2) { snippet_if_exists(template_name
        + \" custom root\") } -%>\n  late-commands:\n<%= indent(2) { snippet ''preseed_autoinstall_clevis_tang_wrapper''
        if host_param(''disk_enc_tang_servers'') && os_major >= 22 && os_minor >=
        3 } %>\n  - wget -Y off <%= @static ? \"''#{foreman_url(''finish'', static:
        ''true'')}''\" : foreman_url(''finish'') %> -O /target/tmp/finish.sh\n  -
        curtin in-target -- chmod +x /tmp/finish.sh\n  - curtin in-target -- /tmp/finish.sh\n","locked":false,"snippet":false,"description":"The
        provisioning template for Autoinstall based distributions. To customize the
        installation,\nmodify the host parameters\n\nThis template accepts the following
        parameters:\n- lang: string (default=\"en_US.UTF-8\")\n- keyboard: string
        (default=\"us\")\n- package_upgrade: boolean (default=false)\n- remote_execution_ssh_keys:
        string (default=\"\")\n- username_to_create: string (default=\"root\")\n-
        realname_to_create: string (default=username_to_create)\n- password_to_create:
        string (default=@host.root_pass)","created_at":"2024-06-27 17:28:09 UTC","updated_at":"2024-07-03
        14:59:42 UTC","id":131,"name":"Preseed Autoinstall cloud-init user data","template_kind_id":10,"template_kind_name":"user_data","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '4081'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=50
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/66
  response:
    body:
      string: '{"template":"<%#\nkind: provision\nname: Preseed default\nmodel: ProvisioningTemplate\noses:\n-
        Debian\n- Ubuntu\ntest_on:\n- debian4dhcp\n- ubuntu4dhcp\ndescription: |\n  The
        provisioning template for preseed based distributions. The output is fetched
        by the installer during\n  the network based installation. To customize the
        installation, modify the host parameters.\n-%>\n<%\n  proxy_string = host_param(''http-proxy'')
        ? \" http://#{host_param(''http-proxy'')}:#{host_param(''http-proxy-port'')}\"
        : ''''\n  ansible_enabled = plugin_present?(''foreman_ansible'')\n  salt_enabled
        = host_param(''salt_master'') ? true : false\n  os_major = @host.operatingsystem.major.to_i\n  squeeze_or_older
        = (@host.operatingsystem.name == ''Debian'' && os_major <= 6)\n  python_package
        = case\n                   when (@host.operatingsystem.name == ''Ubuntu''
        && os_major < 20) then ''python''\n                   when (@host.operatingsystem.name
        == ''Debian'' && os_major < 11) then ''python''\n                   else ''python3''\n                   end\n\n  additional_packages
        = [''lsb-release'', ''wget'']\n  additional_packages << host_param(''additional-packages'')\n  additional_packages
        << python_package if ansible_enabled\n  additional_packages << ''eject'' if
        @host.respond_to?(:bootdisk_build?) && @host.bootdisk_build?\n  additional_packages
        = additional_packages.join(\" \").split().uniq().join(\" \")\n%>\n# This preseed
        file was rendered from the Foreman provisioning template \"<%= @template_name
        %>\".\n# for <%= @host %> running <%= @host.operatingsystem.name %> <%= os_major
        %> <%= @arch %>\n# Organization: <%= @host.organization %>\n# Location: <%=
        @host.location %>\n\n<%= snippet_if_exists(template_name + \" custom pre\")
        -%>\n\n# Locale\nd-i debian-installer/locale string <%= host_param(''lang'')
        || ''en_US'' %>\n# country and keyboard settings are automatic. Keep them
        ...\n# ... for wheezy and newer:\nd-i keyboard-configuration/xkb-keymap seen
        true\n<% if squeeze_or_older -%>\n# ... for squeeze and older:\nd-i console-keymaps-at/keymap
        seen true\n<% end -%>\n\n<% subnet = @host.subnet -%>\n<% if @static -%>\n  <%-
        dhcp = false -%>\n<% elsif subnet.nil? -%>\n  <%- dhcp = true -%>\n<% else
        -%>\n  <%- dhcp = subnet.dhcp_boot_mode? -%>\n<% end -%>\n<% unless dhcp -%>\n#
        Static network configuration.\nd-i preseed/early_command string /bin/killall.sh;
        /bin/netcfg\nd-i netcfg/disable_autoconfig boolean true\nd-i netcfg/dhcp_failed
        note\nd-i netcfg/dhcp_options select Configure network manually\nd-i netcfg/disable_dhcp
        boolean true\nd-i netcfg/get_ipaddress string <%= @host.ip %>\nd-i netcfg/get_netmask
        string <%= subnet.mask %>\nd-i netcfg/get_nameservers string <%= subnet.dns_servers.join(''
        '') %>\nd-i netcfg/get_gateway string <%= subnet.gateway %>\nd-i netcfg/confirm_static
        boolean true\n<% end -%>\n\n# Network configuration\nd-i netcfg/choose_interface
        select auto\nd-i netcfg/get_hostname string <%= @host %>\nd-i netcfg/get_domain
        string <%= @host.domain %>\nd-i netcfg/wireless_wep string\n\nd-i hw-detect/load_firmware
        boolean true\n\n<% if host_param_true?(''preseed-live-installer'') -%>\n#
        Offline live-installer location\nd-i live-installer/net-image string http://<%=
        @preseed_server %><%= @preseed_path %>/install/filesystem.squashfs\n<% end
        -%>\n\n# Mirror settings\nd-i mirror/country string manual\nd-i mirror/http/hostname
        string <%= @preseed_server %>\nd-i mirror/http/directory string <%= @preseed_path
        %>\nd-i mirror/http/proxy string<%= proxy_string %>\nd-i mirror/codename string
        <%= @host.operatingsystem.release_name %>\nd-i mirror/suite string <%= @host.operatingsystem.release_name
        %>\nd-i mirror/udeb/suite string <%= @host.operatingsystem.release_name %>\n\n#
        Time settings\nd-i clock-setup/utc boolean true\nd-i time/zone string <%=
        host_param(''time-zone'') || ''UTC'' %>\n\n# NTP\nd-i clock-setup/ntp boolean
        true\nd-i clock-setup/ntp-server string <%= host_param(''ntp-server'') ||
        ''0.debian.pool.ntp.org'' %>\n\n# Set alignment for automatic partitioning\n#
        Choices: cylinder, minimal, optimal\n#d-i partman/alignment select cylinder\n\n<%=
        @host.diskLayout %>\n\n<% if host_param(''preseed-kernel-image'') -%>\n# Install
        different kernel\nd-i base-installer/kernel/image string <%= host_param(''preseed-kernel-image'')
        %>\n<% end %>\n\n# User settings\nd-i passwd/root-password-crypted password
        <%= root_pass %>\nuser-setup-udeb passwd/root-login boolean true\nd-i passwd/make-user
        boolean false\nuser-setup-udeb passwd/make-user boolean false\n\n<% repos
        = 0 %>\n\n<% @additional_media.each do |medium| -%>\nd-i apt-setup/local<%=
        repos %>/repository string <%= medium[:url] %> <%= @host.operatingsystem.release_name
        %>-<%= medium[:name] %> main\n<%= \"d-i apt-setup/local#{repos}/comment string
        #{medium[:comment]}\" if medium[:comment] %>\n<%= \"d-i apt-setup/local#{repos}/key
        string #{medium[:gpgkey]}\" if medium[:gpgkey] %>\n<% repos +=1 -%>\n<% end
        -%>\n\n<% if salt_enabled -%>\n<% if host_param_true?(''enable-saltstack-repo'')
        -%>\n<% if @host.operatingsystem.name == ''Debian'' -%>\nd-i apt-setup/local<%=
        repos %>/repository string http://debian.saltstack.com/debian <%= @host.operatingsystem.release_name
        %>-saltstack main\nd-i apt-setup/local<%= repos %>/comment string SaltStack
        Repository\nd-i apt-setup/local<%= repos %>/key string http://debian.saltstack.com/debian-salt-team-joehealy.gpg.key\n<%
        repos += 1 -%>\n<% end -%>\n<% if @host.operatingsystem.name == ''Ubuntu''
        -%>\nd-i apt-setup/local<%= repos %>/repository string http://ppa.launchpad.net/saltstack/salt/ubuntu
        <%= @host.operatingsystem.release_name %> main\nd-i apt-setup/local<%= repos
        %>/comment string SaltStack Repository\nd-i apt-setup/local<%= repos %>/key
        string http://keyserver.ubuntu.com/pks/lookup?op=get&search=0x4759FA960E27C0A6\n<%
        repos += 1 -%>\n<% end -%>\n<% end -%>\n<% end -%>\n\n<% if host_param(''kt_activation_keys'')
        -%>\n# If we are using Katello for content management, then we do not want
        to use\n# upstream mirrors prior to Katello registration.\nd-i apt-setup/use_mirror
        boolean false\nd-i apt-setup/services-select multiselect\n\n<% end -%>\n#
        Install minimal task set (see tasksel --task-packages minimal)\ntasksel tasksel/first
        multiselect minimal, ssh-server, openssh-server\n\n# Install some base packages\nd-i
        pkgsel/include string <%= additional_packages %>\nd-i pkgsel/update-policy
        select <%= host_param(''preseed-update-policy'') || ''unattended-upgrades''
        %>\nd-i pkgsel/upgrade select <%= host_param(''preseed-post-install-upgrade'')
        || ''none'' %>\n\npopularity-contest popularity-contest/participate boolean
        false\n\n# Boot loader settings\n#grub-pc grub-pc/hidden_timeout boolean false\n#grub-pc
        grub-pc/timeout string 10\nd-i grub-installer/only_debian boolean true\nd-i
        grub-installer/with_other_os boolean true\nd-i finish-install/reboot_in_progress
        note\n\n<%= snippet_if_exists(template_name + \" custom post\") -%>\n\nd-i
        preseed/late_command string wget -Y off <%= @static ? \"''#{foreman_url(''finish'',
        static: ''true'')}''\" : foreman_url(''finish'') %> -O /target/tmp/finish.sh
        && in-target chmod +x /tmp/finish.sh && in-target /tmp/finish.sh\n","locked":false,"snippet":false,"description":"The
        provisioning template for preseed based distributions. The output is fetched
        by the installer during\nthe network based installation. To customize the
        installation, modify the host parameters.","created_at":"2024-06-27 17:28:08
        UTC","updated_at":"2024-07-03 14:59:42 UTC","id":66,"name":"Preseed default","template_kind_id":7,"template_kind_name":"provision","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '7861'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=49
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/44
  response:
    body:
      string: '{"template":"<%#\nkind: finish\nname: Preseed default finish\nmodel:
        ProvisioningTemplate\noses:\n- Debian\n- Ubuntu\ntest_on:\n- debian4dhcp\n-
        ubuntu4dhcp\ndescription: |\n  A finish template executed at the end of a
        network provisioning done using preseed based\n  installer, typically DEB
        based distributions. This template renders to a shell script.\n-%>\n<%\n  #
        safemode renderer does not support unary negation\n  puppet_enabled = !host_param_true?(''skip-puppet-setup'')
        && (host_puppet_server.present? || host_param_true?(''force-puppet''))\n  salt_enabled
        = host_param(''salt_master'') ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy)
        && @host.chef_proxy\n-%>\n<% subnet = @host.subnet -%>\n<% if @static -%>\n  <%-
        dhcp = false -%>\n<% elsif subnet.nil? -%>\n  <%- dhcp = true -%>\n<% else
        -%>\n  <%- dhcp = subnet.dhcp_boot_mode? -%>\n<% end -%>\n<%= snippet_if_exists(template_name
        + \" custom pre\") -%>\n<% unless dhcp -%>\n# host and domain name need setting
        as these values may have come from dhcp if pxe booting\n/bin/sed -i \"s/^search.*$/search
        <%= @host.domain %>/g\" /etc/resolv.conf\n/bin/sed -i \"s/.*dns-search.*/\\tdns-search
        <%= @host.domain %>/g\" /etc/network/interfaces\n/bin/sed -i \"s/^<%= @host.ip
        %>.*/<%= @host.ip %>\\t<%= @host.shortname %>.<%= @host.domain %>\\t<%= @host.shortname
        %>/g\" /etc/hosts\n<% end -%>\n\n<% unless !(@host.operatingsystem.name ==
        \"Ubuntu\" && @host.operatingsystem.major.to_i > 20 || (@host.operatingsystem.major.to_i
        == 20 && @host.operatingsystem.minor.to_i >= 3)) || dhcp -%>\n/bin/echo <%=
        @host.shortname %> > /etc/hostname\n/bin/hostname  <%= @host.shortname %>.<%=
        @host.domain %>\n<% end -%>\n\n<% if @host.provision_method == ''image'' &&
        root_pass.present? -%>\n# Install the root password\necho ''root:<%= root_pass
        -%>'' | /usr/sbin/chpasswd -e\n\n<% end -%>\n<%= snippet_if_exists(template_name
        + \" custom snippet\") %>\n<% if host_enc[''parameters''][''realm''] && @host.realm
        && @host.realm.realm_type == ''FreeIPA'' -%>\n<%= snippet ''freeipa_register''
        %>\n<% end -%>\n\n<%= snippet(''remote_execution_ssh_keys'') %>\n\n<%= snippet
        \"blacklist_kernel_modules\" %>\n\n<%= snippet_if_exists(template_name + \"
        custom post\") -%>\n<% unless host_param(''kernel_parameters'').nil? -%>\n\n#
        Allow overriding the default kernel parameters\n  sed -i ''s/GRUB_CMDLINE_LINUX_DEFAULT=\".*\"/GRUB_CMDLINE_LINUX_DEFAULT=\"<%=
        host_param(''kernel_parameters'') %>\"/g'' /etc/default/grub && update-grub\n<%
        end -%>\n<% if chef_enabled -%>\n\n<%= snippet ''chef_client'' %>\n<% end
        -%>\n<% if puppet_enabled -%>\n\n<% if host_param_true?(''enable-puppetlabs-repo'')
        || host_param_true?(''enable-official-puppet8-repo'') || host_param_true?(''enable-official-puppet7-repo'')
        || host_param_true?(''enable-puppetlabs-puppet6-repo'') || host_param_true?(''enable-puppetlabs-puppet5-repo'')
        -%>\n<%= snippet ''puppetlabs_repo'' %>\n<% end -%>\n<%= snippet ''puppet_setup''
        %>\n<% end -%>\n<% if salt_enabled -%>\n\n<%= snippet ''saltstack_setup''
        %>\n<% end -%>\n\n<%= snippet ''preseed_networking_setup'' -%>\n<%= snippet
        ''ansible_provisioning_callback'' -%>\n<%= snippet ''efibootmgr_netboot''
        -%>\n<%= snippet ''eject_cdrom'' -%>\n<%= snippet ''built'' -%>\n<%= snippet
        ''schedule_reboot'' -%>\n","locked":false,"snippet":false,"description":"A
        finish template executed at the end of a network provisioning done using preseed
        based\ninstaller, typically DEB based distributions. This template renders
        to a shell script.","created_at":"2024-06-27 17:28:08 UTC","updated_at":"2024-07-03
        14:59:42 UTC","id":44,"name":"Preseed default finish","template_kind_id":8,"template_kind_name":"finish","template_combinations":[],"operatingsystems":[{"id":2,"name":"TempleOS","title":"TempleOS
        1.2"}],"os_default_templates":[{"id":14,"provisioning_template_id":44,"provisioning_template_name":"Preseed
        default finish","template_kind_id":8,"template_kind_name":"finish","operatingsystem_id":2,"operatingsystem_name":"TempleOS
        1.2"}],"locations":[{"id":12,"name":"Test Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '4245'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=48
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/53
  response:
    body:
      string: '{"template":"#!gpxe\n<%#\nkind: iPXE\nname: Preseed default iPXE\nmodel:
        ProvisioningTemplate\noses:\n- Debian\n- Ubuntu\ntest_on:\n- debian4dhcp\n-
        ubuntu4dhcp\ndescription: |\n  The template to render iPXE installation script
        for preseed based distributions\n  The output is deployed on the host''s subnet
        TFTP proxy.\n  See https://ipxe.org/scripting for more details\n-%>\n<%\n  iface
        = @host.provision_interface\n  subnet4 = iface.subnet\n  subnet6 = iface.subnet6\n\n  if
        subnet4 && !subnet4.dhcp_boot_mode?\n    url = foreman_url(''provision'',
        static: ''1'')\n  elsif subnet6 && !subnet6.dhcp_boot_mode?\n    url = foreman_url(''provision'',
        static6: ''1'')\n  else\n    url = foreman_url(''provision'')\n  end\n-%>\necho
        Trying to ping Gateway: ${netX/gateway}\nping --count 1 ${netX/gateway} ||
        echo Ping to Gateway failed or ping command not available.\necho Trying to
        ping DNS: ${netX/dns}\nping --count 1 ${netX/dns} || echo Ping to DNS failed
        or ping command not available.\n\n<% boot_files_uris = @host.operatingsystem.boot_files_uri(medium_provider)
        -%>\n<% kernel = boot_files_uris[0] -%>\n<% initrd = boot_files_uris[1] -%>\n\nkernel
        <%= kernel %> initrd=initrd.img interface=auto url=<%= url %> ramdisk_size=10800
        root=/dev/rd/0 rw auto <%= snippet(\"preseed_kernel_options\", variables:
        {ipxe_net: true}).strip %>\n\ninitrd <%= initrd %>\n\nimgstat\nsleep 2\nboot\n","locked":false,"snippet":false,"description":"The
        template to render iPXE installation script for preseed based distributions\nThe
        output is deployed on the host''s subnet TFTP proxy.\nSee https://ipxe.org/scripting
        for more details","created_at":"2024-06-27 17:28:08 UTC","updated_at":"2024-07-03
        14:59:42 UTC","id":53,"name":"Preseed default iPXE","template_kind_id":6,"template_kind_name":"iPXE","template_combinations":[],"operatingsystems":[{"id":2,"name":"TempleOS","title":"TempleOS
        1.2"}],"os_default_templates":[{"id":13,"provisioning_template_id":53,"provisioning_template_name":"Preseed
        default iPXE","template_kind_id":6,"template_kind_name":"iPXE","operatingsystem_id":2,"operatingsystem_name":"TempleOS
        1.2"}],"locations":[{"id":12,"name":"Test Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '2397'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=47
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/54
  response:
    body:
      string: '{"template":"#!gpxe\n<%#\nkind: iPXE\nname: Preseed default iPXE Autoinstall\nmodel:
        ProvisioningTemplate\noses:\n- ubuntu\ntest_on:\n- ubuntu_autoinst4dhcp\n-%>\n#\n#
        This file was deployed via ''<%= template_name %>'' template\n#\n# Supported
        host/hostgroup parameters:\n#\n# blacklist = module1, module2\n#   Blacklisted
        kernel modules\n#\n# lang = en_US\n#   System locale\n#\n# WARNING\n#\n# Foreman
        will not download the kernel/initramdisk to PXE automatically. Please follow\n#
        the official Ubuntu documentation and extract the files from the LiveCD (DVD)
        manually\n# and optionally update the KERNEL and INITRD lines in this template.\n#\n\n<%
        boot_files_uris = @host.operatingsystem.boot_files_uri(medium_provider) -%>\n<%
        kernel = boot_files_uris[0] -%>\n<% initrd = boot_files_uris[1] -%>\n\nkernel
        <%= kernel %> initrd=initrd root=/dev/rd/0 rw auto <%= snippet(''preseed_kernel_options_autoinstall'').strip
        %>\n\ninitrd <%= initrd %>\n\nimgstat\nsleep 2\nboot\n","locked":false,"snippet":false,"description":null,"created_at":"2024-06-27
        17:28:08 UTC","updated_at":"2024-07-03 14:59:42 UTC","id":54,"name":"Preseed
        default iPXE Autoinstall","template_kind_id":6,"template_kind_name":"iPXE","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1571'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=46
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/9
  response:
    body:
      string: '{"template":"<%#\nkind: PXEGrub2\nname: Preseed default PXEGrub2\nmodel:
        ProvisioningTemplate\noses:\n- Debian\n- Ubuntu\ntest_on:\n- debian4dhcp\n-
        ubuntu4dhcp\ndescription: |\n  The template to render Grub2 bootloader configuration
        for preseed based distributions.\n  The output is deployed on the host''s
        subnet TFTP proxy.\n-%>\n#\n# This file was deployed via ''<%= template_name
        %>'' template\n\n<%\n  os_major = @host.operatingsystem.major.to_i\n  os_name  =
        @host.operatingsystem.name\n\n  if (os_name == ''Ubuntu'' && os_major > 12)
        || (os_name == ''Debian'' && os_major > 8)\n    efi_suffix = ''efi''\n  else\n    efi_suffix
        = ''''\n  end\n-%>\nset default=0\nset timeout=<%= host_param(''loader_timeout'')
        || 10 %>\n\nmenuentry ''<%= template_name %>'' {\n  linux<%= efi_suffix %>  <%=
        @kernel %> interface=auto url=<%= foreman_url(''provision'')%> ramdisk_size=10800
        root=/dev/rd/0 rw auto <%= snippet(\"preseed_kernel_options\").strip %>\n  initrd<%=
        efi_suffix %> <%= @initrd %>\n}\n\n<%= snippet_if_exists(template_name + \"
        custom menu\") %>\n","locked":false,"snippet":false,"description":"The template
        to render Grub2 bootloader configuration for preseed based distributions.\nThe
        output is deployed on the host''s subnet TFTP proxy.","created_at":"2024-06-27
        17:28:07 UTC","updated_at":"2024-07-03 14:59:42 UTC","id":9,"name":"Preseed
        default PXEGrub2","template_kind_id":5,"template_kind_name":"PXEGrub2","template_combinations":[],"operatingsystems":[{"id":2,"name":"TempleOS","title":"TempleOS
        1.2"}],"os_default_templates":[{"id":12,"provisioning_template_id":9,"provisioning_template_name":"Preseed
        default PXEGrub2","template_kind_id":5,"template_kind_name":"PXEGrub2","operatingsystem_id":2,"operatingsystem_name":"TempleOS
        1.2"}],"locations":[{"id":12,"name":"Test Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '2037'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=45
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/10
  response:
    body:
      string: '{"template":"<%#\nkind: PXEGrub2\nname: Preseed default PXEGrub2 Autoinstall\nmodel:
        ProvisioningTemplate\noses:\n- Ubuntu\ntest_on:\n- ubuntu_autoinst4dhcp\n%>\n#\n#
        This file was deployed via ''<%= template_name %>'' template\n#\n# Supported
        host/hostgroup parameters:\n#\n# blacklist = module1, module2\n#   Blacklisted
        kernel modules\n#\n# lang = en_US\n#   System locale\n#\n<%\n  efi_suffix
        = ''efi''\n-%>\n\nset default=0\nset timeout=<%= host_param(''loader_timeout'')
        || 10 %>\n\nmenuentry ''<%= template_name %>'' {\n  linux<%= efi_suffix %>
        <%= @kernel %> root=/dev/rd/0 rw auto <%= snippet(''preseed_kernel_options_autoinstall'',
        variables: {add_userdata_quotes: true}).strip %>\n  initrd<%= efi_suffix %>
        <%= @initrd %>\n}\n\n<%= snippet_if_exists(template_name + \" custom menu\")
        %>\n\n","locked":false,"snippet":false,"description":null,"created_at":"2024-06-27
        17:28:07 UTC","updated_at":"2024-07-03 14:59:42 UTC","id":10,"name":"Preseed
        default PXEGrub2 Autoinstall","template_kind_id":5,"template_kind_name":"PXEGrub2","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1401'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=44
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/19
  response:
    body:
      string: '{"template":"<%#\nkind: PXELinux\nname: Preseed default PXELinux\nmodel:
        ProvisioningTemplate\noses:\n- Debian\n- Ubuntu\ntest_on:\n- debian4dhcp\n-
        ubuntu4dhcp\ndescription: |\n  The template to render PXELinux bootloader
        configuration for preseed based distributions.\n  The output is deployed on
        the host''s subnet TFTP proxy.\n-%>\n#\n# This file was deployed via ''<%=
        template_name %>'' template\n\nDEFAULT linux\nLABEL linux\n    KERNEL <%=
        @kernel %>\n    APPEND initrd=<%= @initrd %> interface=auto url=<%= foreman_url(''provision'')%>
        ramdisk_size=10800 root=/dev/rd/0 rw auto <%= snippet(\"preseed_kernel_options\").strip
        %>\n    IPAPPEND 2\n\n<%= snippet_if_exists(template_name + \" custom menu\")
        %>\n","locked":false,"snippet":false,"description":"The template to render
        PXELinux bootloader configuration for preseed based distributions.\nThe output
        is deployed on the host''s subnet TFTP proxy.","created_at":"2024-06-27 17:28:07
        UTC","updated_at":"2024-07-03 14:59:43 UTC","id":19,"name":"Preseed default
        PXELinux","template_kind_id":3,"template_kind_name":"PXELinux","template_combinations":[],"operatingsystems":[{"id":2,"name":"TempleOS","title":"TempleOS
        1.2"}],"os_default_templates":[{"id":11,"provisioning_template_id":19,"provisioning_template_name":"Preseed
        default PXELinux","template_kind_id":3,"template_kind_name":"PXELinux","operatingsystem_id":2,"operatingsystem_name":"TempleOS
        1.2"}],"locations":[{"id":12,"name":"Test Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1710'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=43
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/20
  response:
    body:
      string: '{"template":"<%#\nkind: PXELinux\nname: Preseed default PXELinux Autoinstall\nmodel:
        ProvisioningTemplate\noses:\n- ubuntu\ntest_on:\n- ubuntu_autoinst4dhcp\n-%>\n#\n#
        This file was deployed via ''<%= template_name %>'' template\n#\n# Supported
        host/hostgroup parameters:\n#\n# blacklist = module1, module2\n#   Blacklisted
        kernel modules\n#\n# lang = en_US\n#   System locale\n#\n# WARNING\n#\n# Foreman
        will not download the kernel/initramdisk to PXE automatically. Please follow\n#
        the official Ubuntu documentation and extract the files from the LiveCD (DVD)
        manually\n# and optionally update the KERNEL and INITRD lines in this template.\n#\nDEFAULT
        linux cloud-init autoinstall\nLABEL linux cloud-init autoinstall\n    KERNEL
        <%= @kernel %>\n    INITRD <%= @initrd %>\n    APPEND root=/dev/ram0 <%= snippet(''preseed_kernel_options_autoinstall'').strip
        %>\n\n<%= snippet_if_exists(template_name + \" custom menu\") %>\n","locked":false,"snippet":false,"description":null,"created_at":"2024-06-27
        17:28:07 UTC","updated_at":"2024-07-03 14:59:43 UTC","id":20,"name":"Preseed
        default PXELinux Autoinstall","template_kind_id":3,"template_kind_name":"PXELinux","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1531'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=42
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/132
  response:
    body:
      string: '{"template":"<%#\nkind: user_data\nname: Preseed default user data\nmodel:
        ProvisioningTemplate\noses:\n- Debian\n- Ubuntu\ntest_on:\n- debian4dhcp\n-
        ubuntu4dhcp\ndescription: |\n  This template is used during image based provisioning,
        when the image is configured to use user-data.\n  The output is a shell script
        that cloud-init runs to configures the VM\n  booted from the image. The image
        must have cloud-init installed in order for this to work.\n  This script can
        be used with preseed distributions images.\n-%>\n#!/bin/bash\n\n<%# Cloud
        instances frequently have incorrect hosts data %>\n<%= snippet ''fix_hosts''
        %>\n\n<%\n  # safemode renderer does not support unary negation\n  proxy_uri
        = host_param(''http-proxy'') ? \"http://#{host_param(''http-proxy'')}:#{host_param(''http-proxy-port'')}\"
        : nil\n  puppet_enabled = !host_param_true?(''skip-puppet-setup'') && (host_puppet_server.present?
        || host_param_true?(''force-puppet''))\n  salt_enabled = host_param(''salt_master'')
        ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n%>\n\n<%
        if proxy_uri -%>\necho ''Acquire::http::Proxy \"<%= proxy_uri %>\";'' >> /etc/apt/apt.conf\n<%
        end -%>\n\n<% if host_enc[''parameters''][''realm''] && @host.realm && @host.realm.realm_type
        == ''FreeIPA'' -%>\n<%= snippet ''freeipa_register'' %>\n<% end -%>\n\n<%=
        snippet(''remote_execution_ssh_keys'') %>\n\n<%= snippet \"blacklist_kernel_modules\"
        %>\n\n<% if chef_enabled %>\n<%= snippet ''chef_client'' %>\n<% end -%>\n\n<%
        if puppet_enabled %>\n<% if host_param_true?(''enable-puppetlabs-repo'') ||
        host_param_true?(''enable-official-puppet8-repo'') || host_param_true?(''enable-official-puppet7-repo'')
        || host_param_true?(''enable-puppetlabs-puppet6-repo'') || host_param_true?(''enable-puppetlabs-puppet5-repo'')
        -%>\n<%= snippet ''puppetlabs_repo'' %>\n<% end -%>\n<%= snippet ''puppet_setup''
        %>\n<% end -%>\n\n<% if salt_enabled %>\n<%= snippet ''saltstack_setup'' %>\n<%
        end -%>\n\n# UserData still needs wget to mark as finished\n<%= snippet ''built''
        %>\n","locked":false,"snippet":false,"description":"This template is used
        during image based provisioning, when the image is configured to use user-data.\nThe
        output is a shell script that cloud-init runs to configures the VM\nbooted
        from the image. The image must have cloud-init installed in order for this
        to work.\nThis script can be used with preseed distributions images.","created_at":"2024-06-27
        17:28:09 UTC","updated_at":"2024-07-03 14:59:43 UTC","id":132,"name":"Preseed
        default user data","template_kind_id":10,"template_kind_name":"user_data","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '2932'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=41
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/96
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: preseed_kernel_options\nmodel:
        ProvisioningTemplate\nsnippet: true\ndescription: options for the kernel /
        preseed startup initialization\n-%>\n<%\n  is_debian = @host.operatingsystem.name
        == ''Debian''\n  hostname = @host.name\n  domain = @host.domain\n  iface =
        @host.provision_interface\n  mac = @host.provision_interface.mac\n  subnet4
        = iface.subnet\n  subnet6 = iface.subnet6\n  options = []\n\n  if host_param(''blacklist'')\n    options
        << host_param(''blacklist'').split('','').collect{|x| \"#{x.strip}.blacklist=yes\"}.join(''
        '')\n  end\n\n  if mac\n    # hardware type is always 01 (ethernet) unless
        specified otherwise\n    if @ipxe_net\n      options << \"BOOTIF=01-${netX/mac:hexhyp}\"\n    else\n      options
        << \"BOOTIF=#{host_param(\"hardware_type\", \"01\")}-#{mac.gsub('':'', ''-'')}\"\n    end\n  end\n\n  if
        is_debian\n    options << \"auto=true\"\n  else\n    options << ''console-setup/ask_detect=false
        console-setup/layout=USA console-setup/variant=USA keyboard-configuration/layoutcode=us
        localechooser/translation/warn-light=true localechooser/translation/warn-severe=true''\n  end\n\n  if
        @host.provision_interface.vlanid.present?\n    options << \"netcfg/use_vlan=true
        netcfg/vlan_id=#{@host.provision_interface.vlanid}\"\n  end\n\n  if subnet4
        && subnet4.dhcp_boot_mode?\n    options << ''netcfg/disable_dhcp=false''\n  elsif
        subnet4 && !subnet4.dhcp_boot_mode?\n    if @ipxe_net\n      options << ''netcfg/disable_dhcp=true
        netcfg/get_ipaddress=${netX/ip} netcfg/get_netmask=${netX/netmask} netcfg/get_gateway=${netX/gateway}
        netcfg/get_nameservers=${dns} netcfg/confirm_static=true''\n    else\n      dns_servers
        = subnet4.dns_servers.join('' '')\n      options << \"netcfg/disable_dhcp=true
        netcfg/get_ipaddress=#{iface.ip} netcfg/get_netmask=#{subnet4.mask} netcfg/get_gateway=#{subnet4.gateway}
        netcfg/get_nameservers=\\\"#{dns_servers}\\\" netcfg/confirm_static=true\"\n    end\n  elsif
        subnet6 && subnet6.dhcp_boot_mode?\n    options << ''netcfg/disable_dhcp=false''\n  elsif
        subnet6 && !subnet6.dhcp_boot_mode?\n    if @ipxe_net\n      options << ''netcfg/disable_dhcp=true
        netcfg/get_ipaddress=${netX/ip} netcfg/get_netmask=${netX/netmask} netcfg/get_gateway=${netX/gateway}
        netcfg/get_nameservers=${dns} netcfg/confirm_static=true''\n    else\n      dns_servers
        = subnet6.dns_servers.join('' '')\n      options << \"netcfg/disable_dhcp=true
        netcfg/get_ipaddress=#{iface.ip6} netcfg/get_netmask=#{subnet6.mask} netcfg/get_gateway=#{subnet6.gateway}
        netcfg/get_nameservers=\\\"#{dns_servers}\\\" netcfg/confirm_static=true\"\n    end\n  end\n\n  if
        host_param(''pxe_kernel_options'')\n    options << host_param(''pxe_kernel_options'')\n  end\n\n  options
        << \"locale=#{host_param(''lang'') || ''en_US''}\"\n  options << \"hostname=#{hostname}\"\n  options
        << \"domain=#{domain}\"\n%>\n<%# do not add newline after the next line %>\n<%=
        options.join('' '') -%>\n","locked":false,"snippet":true,"description":"options
        for the kernel / preseed startup initialization","created_at":"2024-06-27
        17:28:09 UTC","updated_at":"2024-07-03 14:59:43 UTC","id":96,"name":"preseed_kernel_options","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '3545'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=40
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/97
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: preseed_kernel_options_autoinstall\nmodel:
        ProvisioningTemplate\nsnippet: true\ndescription: options for the kernel /
        preseed startup initialization\noses:\n- ubuntu\ntest_on:\n- ubuntu_autoinst4dhcp\n-%>\n<%\n  hostname
        = @host.name\n  domain = @host.domain\n  iface = @host.provision_interface\n  mac
        = @host.provision_interface.mac\n  subnet4 = iface.subnet\n  subnet6 = iface.subnet6\n  image_path
        = @preseed_path.sub(/\\/?$/, ''.iso'')\n  userdata_option = \"ds=nocloud-net;s=http://#{foreman_request_addr}/userdata/#{mac
        ? mac + ''/'' : ''''}\"\n  options = []\n\n  if host_param(''blacklist'')\n    options
        << host_param(''blacklist'').split('','').collect{|x| \"#{x.strip}.blacklist=yes\"}.join(''
        '')\n  end\n  if @host.provision_interface.vlanid.present?\n    options <<
        \"netcfg/use_vlan=true netcfg/vlan_id=#{@host.provision_interface.vlanid}\"\n  end\n  if
        subnet4 && subnet4.dhcp_boot_mode?\n    options << ''ip=dhcp''\n  elsif subnet4
        && !subnet4.dhcp_boot_mode?\n    options << \"ip=#{iface.ip}::#{subnet4.gateway}:#{subnet4.mask}:#{hostname}:#{iface.identifier}:none:#{subnet4.dns_servers.join('':'')}\"\n  elsif
        subnet6 && subnet6.dhcp_boot_mode?\n    options << ''ip=dhcp''\n  elsif subnet6
        && !subnet6.dhcp_boot_mode?\n    options << \"ip=[#{iface.ip6}]::[#{subnet6.gateway}]:[#{subnet6.mask}]:#{hostname}:#{iface.identifier}:none:[#{subnet6.dns_servers.join('']:['')}]\"\n  end\n\n  options
        << \"BOOTIF=#{mac}\" if mac\n  options << ''ramdisk_size=1500000''\n  options
        << ''fsck.mode=skip''\n  options << ''autoinstall''\n  options << \"url=http://#{@preseed_server}#{image_path}\"\n  options
        << ''cloud-config-url=/dev/null''\n  if @add_userdata_quotes\n    options
        << \"\\\"#{userdata_option}\\\"\"\n  else\n    options << userdata_option\n  end\n  options
        << ''console-setup/ask_detect=false''\n  options << \"locale=#{host_param(''lang'')
        || ''en_US''}\"\n  options << ''localechooser/translation/warn-light=true''\n  options
        << ''localechooser/translation/warn-severe=true''\n  options << \"hostname=#{hostname}\"\n  options
        << \"domain=#{domain}\"\n%>\n<%# do not add newline after the next line %>\n<%=
        options.join('' '') -%>\n","locked":false,"snippet":true,"description":"options
        for the kernel / preseed startup initialization","created_at":"2024-06-27
        17:28:09 UTC","updated_at":"2024-07-03 14:59:43 UTC","id":97,"name":"preseed_kernel_options_autoinstall","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '2810'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=39
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/98
  response:
    body:
      string: '{"template":"<%#\nname: preseed_netplan_generic_interface\nmodel: ProvisioningTemplate\nsnippet:
        true\nmodel: ProvisioningTemplate\nkind: snippet\noses:\n- Ubuntu\n-%>\n<%-
        if @interface.identifier.blank? -%>\n    id0:\n        match:\n          macaddress:
        \"<%= @host.mac %>\"\n<%- else -%>\n    <%= @interface.identifier %>:\n<%-
        end -%>\n        dhcp4: <%= @dhcp %>\n        dhcp6: <%= @dhcp6 %>\n<%-\nstatic_v4
        = !@dhcp && !@subnet.nil? && !@interface.ip.nil?\nstatic_v6 = !@dhcp6 && !@subnet6.nil?
        && !@interface.ip6.nil?\n-%>\n<%- if static_v4 || static_v6 -%>\n        addresses:\n<%-   if
        static_v4 -%>\n          - <%= @interface.ip %>/<%= @subnet.cidr %>\n<%-   end
        -%>\n<%-   if static_v6 -%>\n          - \"<%= @interface.ip6 %>/<%= @subnet6.cidr
        %>\"\n<%-   end -%>\n<%-   if static_v4 && @subnet.gateway.present? -%>\n        gateway4:
        <%= @subnet.gateway %>\n<%-   end -%>\n<%-   if static_v6 && @subnet6.gateway.present?
        -%>\n        gateway6: \"<%= @subnet6.gateway %>\"\n<%-   end -%>\n<%-   if
        @interface.primary -%>\n        nameservers:\n          search: [ <%= @interface.domain
        %> ]\n          addresses:\n<%-     if static_v4 -%>\n<%-       @subnet.dns_servers.each
        do |dns_server| -%>\n            - <%= dns_server %>\n<%-       end -%>\n<%-     end
        -%>\n<%-     if static_v6 -%>\n<%-       @subnet6.dns_servers.each do |dns6_server|
        -%>\n            - \"<%= dns6_server %>\"\n<%-       end -%>\n<%-     end
        -%>\n<%-   end -%>\n<%- end -%>\n","locked":false,"snippet":true,"description":null,"created_at":"2024-06-27
        17:28:09 UTC","updated_at":"2024-07-03 14:59:43 UTC","id":98,"name":"preseed_netplan_generic_interface","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '2070'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=38
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/99
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: preseed_netplan_setup\nmodel:
        ProvisioningTemplate\nsnippet: true\ndescription: |\n  This will configure
        your host networking, it configures your\n  primary interface as well as other
        NICs like BOND, BRIDGE, VLAN and Alias\n  interfaces.\noses:\n- Ubuntu\n-%>\n<%
        os_major = @host.operatingsystem.major.to_i -%>\n<% os_minor = @host.operatingsystem.minor.to_i
        -%>\n<%- -%>\n<%# Begin Ubuntu 18.04 and newer uses netplan instead of /etc/network/interfaces
        -%>\n<%- if os_major >= 20 -%>\n<%- bonding_interfaces = [] -%>\n<%- bridged_interfaces
        = [] -%>\n<%- vlans_interfaces = [] -%>\n  network:\n    version: 2\n<%#\n#####
        Processing bond-interfaces #####\n-%>\n<%- found = false -%>\n<%- @host.bond_interfaces.each
        do | bond | -%>\n  <%- bonding_interfaces.push(bond.identifier) -%>\n  <%-
        if !found -%>\n  <%- found = true -%>\n    bonds:\n  <%- end -%>\n<%- result=
        snippet(''preseed_netplan_generic_interface'', :variables => {\n                  :interface
        => bond,\n                  :subnet => bond.subnet,\n                  :subnet6
        => bond.subnet6,\n                  :dhcp => bond.subnet.nil? ? false : bond.subnet.dhcp_boot_mode?,\n                  :dhcp6
        => bond.subnet6.nil? ? false : bond.subnet6.dhcp_boot_mode? }) -%>\n  <%=
        result -%>\n        interfaces: <%= bond.attached_devices_identifiers %>\n        parameters:\n          mode:
        <%= bond.mode %>\n          <%- options = bond.bond_options.split() -%>\n          <%-
        options.each do | option | -%>\n          <%= option.gsub(''='','': '') %>\n          <%-
        end -%>\n<% end -%>\n<%#\n##### Processing bridge interfaces #####\n-%>\n<%-
        found = false -%>\n<%- @host.bridge_interfaces.each do | bridge | -%>\n<%-
        next if bonding_interfaces.include?(bridge.identifier) -%>\n  <%- bridged_interfaces.push(bridge.identifier)
        -%>\n  <%- if !found -%>\n  <%- found = true -%>\n    bridges:\n  <%- end
        -%>\n<%- result= snippet(''preseed_netplan_generic_interface'', :variables
        => {\n                  :interface => bridge,\n                  :subnet =>
        bridge.subnet,\n                  :subnet6 => bridge.subnet6,\n                  :dhcp
        => bridge.subnet.nil? ? false : bridge.subnet.dhcp_boot_mode?,\n                  :dhcp6
        => bridge.subnet6.nil? ? false : bridge.subnet6.dhcp_boot_mode? }) -%>\n  <%=
        result -%>\n<%- end -%>\n<%#\n##### Processing vlan interfaces #####\n-%>\n<%-
        found = false -%>\n<%- @host.managed_interfaces.each do | vlan | -%>\n<%-
        next if bonding_interfaces.include?(vlan.identifier) -%>\n<%- next if bridged_interfaces.include?(vlan.identifier)
        -%>\n<%- next if !vlan.virtual? -%>\n  <%- vlans_interfaces.push(vlan.identifier)
        -%>\n  <%- if !found -%>\n  <%- found = true -%>\n    vlans:\n  <%- end -%>\n<%-
        result= snippet(''preseed_netplan_generic_interface'', :variables => {\n                  :interface
        => vlan,\n                  :subnet => vlan.subnet,\n                  :subnet6
        => vlan.subnet6,\n                  :dhcp => vlan.subnet.nil? ? false : vlan.subnet.dhcp_boot_mode?,\n                  :dhcp6
        => vlan.subnet6.nil? ? false : vlan.subnet6.dhcp_boot_mode? }) -%>\n  <%=
        result -%>\n        id: <%= vlan.tag %>\n        link: <%= vlan.attached_to
        %>\n<%- end -%>\n<%#\n##### Processing remaining interfaces (ethernets) #####\n-%>\n<%-
        found = false -%>\n<%- @host.managed_interfaces.each do | interface | -%>\n<%-
        next if bonding_interfaces.include?(interface.identifier) -%>\n<%- next if
        bridged_interfaces.include?(interface.identifier) -%>\n<%- next if vlans_interfaces.include?(interface.identifier)
        -%>\n  <%- interface_subnet = interface.subnet -%>\n  <%- if !found -%>\n  <%-
        found = true -%>\n    ethernets:\n  <%- end -%>\n<%- result= snippet(''preseed_netplan_generic_interface'',
        :variables => {\n                  :interface => interface,\n                  :subnet
        => interface.subnet,\n                  :subnet6 => interface.subnet6,\n                  :dhcp
        => interface.subnet.nil? ? false : interface.subnet.dhcp_boot_mode?,\n                  :dhcp6
        => interface.subnet6.nil? ? false : interface.subnet6.dhcp_boot_mode? }) -%>\n  <%=
        result -%>\n<%- end -%>\n<%- end -%>\n","locked":false,"snippet":true,"description":"This
        will configure your host networking, it configures your\nprimary interface
        as well as other NICs like BOND, BRIDGE, VLAN and Alias\ninterfaces.","created_at":"2024-06-27
        17:28:09 UTC","updated_at":"2024-07-03 14:59:43 UTC","id":99,"name":"preseed_netplan_setup","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '4868'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=37
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/100
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: preseed_networking_setup\nmodel:
        ProvisioningTemplate\nsnippet: true\ndescription: |\n  This will configure
        your host networking, it configures your primary interface as well\n  as other
        configures NICs. It supports physical, VLAN and Alias interfaces. It''s intended
        to be\n  called in your preseed finish template.\n-%>\n<% host_subnet = @host.subnet
        -%>\n<% host_dhcp = host_subnet.nil? ? true : host_subnet.dhcp_boot_mode?
        -%>\n<% host_subnet6 = @host.subnet6 -%>\n<% host_dhcp6 = host_subnet6.nil?
        ? true : host_subnet6.dhcp_boot_mode? -%>\n\nreal=`ip -o link | awk ''/<%=
        @host.mac -%>/ {print $2;}'' | sed s/://`\ncat << EOF > /etc/network/interfaces\n#loopback\nauto
        lo\niface lo inet loopback\n\n#<%= @host.primary_interface.identifier %>\nauto
        $real\nallow-hotplug $real\niface $real inet <%= host_dhcp ? ''dhcp'' : ''static''
        %>\n<% if host_subnet && !host_dhcp -%>\n    address <%= @host.ip %>\n    gateway
        <%= host_subnet.gateway %>\n    netmask <%= host_subnet.mask %>\n    dns-nameservers
        <%= host_subnet.dns_servers.join('' '') %>\n    dns-search <%= @host.domain
        %>\n<% end -%>\n<% if @host.ip6 && host_subnet6 && !host_dhcp6 -%>\niface
        $real inet6 static\n    address <%= @host.ip6 %>/<%= host_subnet6.cidr %>\n<%
        if host_subnet6.gateway -%>\n    gateway <%= host_subnet6.gateway %>\n<% end
        -%>\n<% end -%>\nEOF\n\n<% @host.managed_interfaces.each do |interface| -%>\n<%
        interface_subnet = interface.subnet -%>\n<% interface_dhcp = interface_subnet.nil?
        ? true : interface_subnet.dhcp_boot_mode? -%>\n<% interface_subnet6 = interface.subnet6
        -%>\n<% interface_dhcp6 = interface_subnet6.nil? ? true : interface_subnet6.dhcp_boot_mode?
        -%>\n<% next if !interface.managed? || (interface_subnet.nil? && interface_subnet6.nil?)
        || interface.primary -%>\n<% if interface.virtual? -%>\n    real=\"<%= interface.attached_to
        -%>\"\n<% else -%>\n    real=`ip -o link | awk ''/<%= interface.mac -%>/ {print
        $2;}'' | sed s/:$//`\n<% end -%>\n\ncat << EOF >> /etc/network/interfaces\n#<%=
        interface.identifier %>\n<% if interface_subnet %>\nauto $real\niface $real
        inet <%= interface_dhcp ? ''dhcp'' : ''static'' %>\n<% unless interface_dhcp
        -%>\n    address <%= interface.ip %>\n    netmask <%= interface_subnet.mask
        %>\n<% end -%>\n<% end -%>\n<% if interface.ip6 && interface_subnet6 %>\n<%
        unless interface_dhcp6 -%>\niface $real inet6 static\n    address <%= interface.ip6
        %>/<%= interface_subnet6.cidr %>\n<% if interface_subnet6.gateway -%>\n    gateway
        <%= interface_subnet6.gateway %>\n<% end -%>\n<% end -%>\n<% end -%>\nEOF\n<%
        end -%>\n","locked":false,"snippet":true,"description":"This will configure
        your host networking, it configures your primary interface as well\nas other
        configures NICs. It supports physical, VLAN and Alias interfaces. It''s intended
        to be\ncalled in your preseed finish template.","created_at":"2024-06-27 17:28:09
        UTC","updated_at":"2024-07-03 14:59:43 UTC","id":100,"name":"preseed_networking_setup","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '3393'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=36
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/101
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: puppet.conf\nmodel: ProvisioningTemplate\nsnippet:
        true\ndescription: |\n  Generates a puppet.conf file which is required for
        the puppet agent bootstraping.\n  The puppet server and CA is configured based
        on the host configuration. It supports\n  Puppet 5 and newer.\n-%>\n<%\n  os_family
        = @host.operatingsystem.family\n  os_name   = @host.operatingsystem.name\n\n  aio_enabled
        = host_param_true?(''enable-puppetlabs-repo'') ||  host_param_true?(''enable-official-puppet8-repo'')
        || host_param_true?(''enable-official-puppet7-repo'') || host_param_true?(''enable-puppet7'')
        || host_param_true?(''enable-puppetlabs-puppet6-repo'') || host_param_true?(''enable-puppet6'')
        || host_param_true?(''enable-puppetlabs-puppet5-repo'') || host_param_true?(''enable-puppet5'')\n  aio_available
        = os_family == ''Debian'' || os_family == ''Redhat'' || os_name == ''SLES''\n\n  if
        os_family == ''Windows''\n    var_dir = ''C:\\ProgramData\\PuppetLabs\\puppet\\cache''\n    log_dir
        = ''C:\\ProgramData\\PuppetLabs\\puppet\\var\\log''\n    run_dir = ''C:\\ProgramData\\PuppetLabs\\puppet\\var\\run''\n    ssl_dir
        = ''C:\\ProgramData\\PuppetLabs\\puppet\\etc\\ssl''\n  else\n    if @host.operatingsystem.family
        == ''Freebsd''\n      var_dir = ''/var/puppet''\n    else\n      var_dir =
        ''/var/lib/puppet''\n    end\n    log_dir = ''/var/log/puppet''\n    run_dir
        = ''/var/run/puppet''\n    ssl_dir = ''\\$vardir/ssl''\n  end\n-%>\n[main]\n<%-
        unless host_param(''dns_alt_names'').to_s.empty? -%>\ndns_alt_names = <%=
        host_param(''dns_alt_names'') %>\n<%- end -%>\n<% unless aio_enabled && aio_available
        -%>\nvardir = <%= var_dir %>\nlogdir = <%= log_dir %>\nrundir = <%= run_dir
        %>\nssldir = <%= ssl_dir %>\n<% end -%>\n\n[agent]\npluginsync      = true\nreport          =
        true\n<%- if host_puppet_ca_server.present? -%>\nca_server       = <%= host_puppet_ca_server
        %>\n<%- end -%>\ncertname        = <%= @host.certname %>\n<%- if host_puppet_server.present?
        -%>\nserver          = <%= host_puppet_server %>\n<%- end -%>\n<%- if host_puppet_environment.present?
        -%>\nenvironment     = <%= host_puppet_environment %>\n<%- end -%>\n","locked":false,"snippet":true,"description":"Generates
        a puppet.conf file which is required for the puppet agent bootstraping.\nThe
        puppet server and CA is configured based on the host configuration. It supports\nPuppet
        5 and newer.","created_at":"2024-06-27 17:28:09 UTC","updated_at":"2024-07-03
        14:59:43 UTC","id":101,"name":"puppet.conf","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '2872'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=35
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/103
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: puppetlabs_repo\nmodel: ProvisioningTemplate\nsnippet:
        true\ndescription: |\n  Fetches the package that deploys the PuppetLabs repository
        that can be\n  used to install Puppet from. It only performs the installation
        in case\n  one of the enable-puppetlabs*repo parameter is set to true.\n-%>\n<%\nhttp_proxy   =
        host_param(''http-proxy'') ? \" --httpproxy #{host_param(''http-proxy'')}\"
        : nil\nhttp_port    = host_param(''http-proxy-port'') ? \" --httpport #{host_param(''http-proxy-port'')}\"
        : nil\nproxy_uri    = host_param(''http-proxy'') ? \"http://#{host_param(''http-proxy'')}:#{host_param(''http-proxy-port'')}\"
        : nil\nproxy_string = proxy_uri ? \" -e https_proxy=#{proxy_uri}/\" : ''''\nproxy_string_bits
        = proxy_uri ? \" -ProxyUsage Override -ProxyList #{proxy_uri}\" : ''''\nos_family
        = @host.operatingsystem.family\nos_major  = @host.operatingsystem.major.to_i\nos_name   =
        @host.operatingsystem.name\n\nif os_family == ''Redhat''\n  repo_host = ''yum.puppet.com''\n  if
        os_name == ''Fedora''\n    repo_os = ''fedora''\n  else\n    repo_os = ''el''\n  end\nelsif
        os_family == ''Suse''\n  repo_host = ''yum.puppet.com''\n  repo_os = ''sles''
        # PuppetLabs repos only exist for SLES, not OpenSUSE\nelsif os_family == ''Debian''\n  repo_host
        = ''apt.puppet.com''\n  repo_os = @host.operatingsystem.release_name\nelsif
        os_family == ''Windows''\n  repo_host = ''downloads.puppet.com''\n  repo_os
        = ''windows''\nend\n\nif host_param_true?(''enable-puppetlabs-repo'')\n  repo_name
        = ''puppet-release''\nelsif host_param_true?(''enable-official-puppet8-repo'')\n  repo_name
        = ''puppet8-release''\nelsif host_param_true?(''enable-official-puppet7-repo'')\n  repo_name
        = ''puppet7-release''\nelsif host_param_true?(''enable-puppetlabs-puppet6-repo'')\n  repo_name
        = ''puppet6-release''\nelsif host_param_true?(''enable-puppetlabs-puppet5-repo'')\n  repo_name
        = ''puppet5-release''\nend\n-%>\n<% if repo_name -%>\n<% if os_family == ''Redhat''
        || os_name == ''SLES'' -%>\nrpm -Uvh<%= http_proxy %><%= http_port %> https://<%=
        repo_host %>/<%= repo_name %>-<%= repo_os %>-<%= os_major %>.noarch.rpm\n<%
        elsif os_family == ''Debian'' -%>\napt-get update\napt-get -y install ca-certificates\nwget
        -O /tmp/<%= repo_name %>-<%= repo_os %>.deb<%= proxy_string %> https://<%=
        repo_host %>/<%= repo_name %>-<%= repo_os %>.deb\ndpkg -i /tmp/<%= repo_name
        %>-<%= repo_os %>.deb\n<% elsif os_family == ''Windows'' -%>\n$puppet_agent_source
        = ''https://<%= repo_host %>/<%= repo_os %>/puppet-agent-<%= @host.architecture
        %>-latest.msi''\n$puppet_agent_msi = \"${env:TEMP}\\puppet-agent-<%= @host.architecture
        %>.msi\"\nWrite-Host \"Downloading puppet-agent from ${$puppet_agent_source}
        to ${puppet_agent_msi}\"\nStart-BitsTransfer -Source \"${puppet_agent_source}\"
        -Destination \"${puppet_agent_msi}\"<%= proxy_string_bits %>\n<% end -%>\n<%
        end -%>\n","locked":false,"snippet":true,"description":"Fetches the package
        that deploys the PuppetLabs repository that can be\nused to install Puppet
        from. It only performs the installation in case\none of the enable-puppetlabs*repo
        parameter is set to true.","created_at":"2024-06-27 17:28:09 UTC","updated_at":"2024-07-03
        14:59:43 UTC","id":103,"name":"puppetlabs_repo","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '3594'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=34
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/102
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: puppet_setup\nmodel: ProvisioningTemplate\nsnippet:
        true\ndescription: |\n  Bootstraps the Puppet agent and performs one run to
        create a certificate request.\n\n  In more details it installs a Puppet agent,
        creates the necessary configuration files,\n  enables the Puppet agent service
        and performs a single run with a specified tag.\n  By default the tag `no_such_tag`
        is used to generate an empty run.\n  An empty run can be used for the agent
        to detect it''s missing a client certificate\n  and ask for a new one from
        the host''s Puppet CA.\n-%>\n<%\nos_family = @host.operatingsystem.family\nos_major  =
        @host.operatingsystem.major.to_i\nos_name   = @host.operatingsystem.name\n\naio_enabled
        = host_param_true?(''enable-puppetlabs-repo'') || host_param_true?(''enable-official-puppet8-repo'')
        || host_param_true?(''enable-official-puppet7-repo'') || host_param_true?(''enable-puppet7'')
        || host_param_true?(''enable-puppetlabs-puppet6-repo'') || host_param_true?(''enable-puppet6'')
        || host_param_true?(''enable-puppetlabs-puppet5-repo'') || host_param_true?(''enable-puppet5'')\n\nif
        host_param(''run-puppet-in-installer-tags'')\n  puppet_tags = host_param(''run-puppet-in-installer-tags'')\nelse\n  puppet_tags
        = ''no_such_tag''\nend\n\nif os_family == ''Freebsd''\n  freebsd_package =
        host_param_true?(''enable-puppet6'') ? ''puppet6'' : ''puppet5''\n  etc_path
        = ''/usr/local/etc/puppet''\n  bin_path = ''/usr/local/bin''\nelsif os_family
        == ''Windows''\n  windows_package = \"puppet-agent-#{@host.architecture}.msi\"\n  etc_path
        = ''C:\\ProgramData\\PuppetLabs\\puppet\\etc''\n  bin_path = ''C:\\Program
        Files\\Puppet Labs\\Puppet\\bin''\nelsif aio_enabled\n  linux_package = ''puppet-agent''\n  etc_path
        = ''/etc/puppetlabs/puppet''\n  bin_path = ''/opt/puppetlabs/bin''\nelse\n  linux_package
        = os_family == ''Suse'' ? ''rubygem-puppet'' : ''puppet''\n  etc_path = ''/etc/puppet''\n  bin_path
        = ''/usr/bin''\nend\n-%>\n<% if os_family == ''Debian'' -%>\napt-get update\napt-get
        install -y <%= linux_package %>\n<% elsif os_family == ''Freebsd'' -%>\npkg
        install -y <%= freebsd_package %>\n<% elsif os_family == ''Redhat'' -%>\nif
        [ -f /usr/bin/dnf ]; then\n  dnf -y install <%= linux_package %>\nelse\n  yum
        -t -y install <%= linux_package %>\nfi\n<% elsif os_family == ''Suse'' -%>\n<%
        if host_param_true?(''enable-puppetlabs-repo'') || host_param_true?(''enable-official-puppet8-repo'')
        || host_param_true?(''enable-official-puppet7-repo'') || host_param_true?(''enable-puppetlabs-puppet6-repo'')
        || host_param_true?(''enable-puppetlabs-puppet5-repo'') -%>\nrpmkeys --import
        https://yum.puppet.com/RPM-GPG-KEY-puppetlabs\nrpmkeys --import https://yum.puppet.com/RPM-GPG-KEY-puppet\n<%
        end -%>\n<% if @host.provision_method == ''image'' -%>\n/usr/bin/zypper -n
        install <%= linux_package %>\n<% end -%>\n<% elsif os_family == ''Windows''
        -%>\n$puppet_agent_msi = \"${env:TEMP}\\<%= windows_package %>\"\n$puppet_install_args
        = @(\n  ''/qn'',\n  ''/norestart'',\n  ''/i'',\n  \"${puppet_agent_msi}\",\n  <%-
        if host_puppet_ca_server.present? -%>\n  \"PUPPET_CA_SERVER=<%= host_puppet_ca_server
        %>\",\n  <%- end -%>\n  \"PUPPET_MASTER_SERVER=<%= host_puppet_server %>\"\n)\n\nWrite-Host
        \"Installing ${puppet_agent_msi} with args ${puppet_install_args}\"\nStart-Process
        ''msiexec.exe'' -ArgumentList $puppet_install_args -Wait -NoNewWindow\n<%
        end -%>\n\n<% if os_family == ''Windows'' -%>\n$puppet_conf = @(\"<%= snippet
        ''puppet.conf'' %>\".Replace(\"`n\",\"`r`n\"))\nOut-File -FilePath <%= etc_path
        %>\\puppet.conf -InputObject $puppet_conf\n<% else -%>\ncat > <%= etc_path
        %>/puppet.conf << EOF\n<%= snippet ''puppet.conf'' %>\nEOF\n<% end -%>\n\n<%
        if @host.puppetca_token.present? -%>\n<% if os_family == ''Windows'' -%>\n$csr_attributes
        = @(\"<%= snippet ''csr_attributes.yaml'' %>\".Replace(\"`n\",\"`r`n\"))\nOut-File
        -FilePath <%= etc_path %>\\csr_attributes.yaml -InputObject $csr_attributes\n<%
        else -%>\ncat > <%= etc_path %>/csr_attributes.yaml << EOF\n<%= snippet ''csr_attributes.yaml''
        %>\nEOF\n<% end -%>\n<% end -%>\n\n<% if os_family == ''Redhat'' -%>\n<% if
        os_major > 6 -%>\npuppet_unit=puppet\n/usr/bin/systemctl list-unit-files |
        grep -q puppetagent && puppet_unit=puppetagent\n/usr/bin/systemctl enable
        ${puppet_unit}\n<% else -%>\n/sbin/chkconfig --level 345 puppet on\n<% end
        -%>\n<% end -%>\n<% if os_family == ''Freebsd'' -%>\necho ''puppet_enable=\"YES\"''
        >>/etc/rc.conf\n<% end -%>\n<% unless aio_enabled -%>\n<% if os_family ==
        ''Debian'' -%>\nif [ -f \"/etc/default/puppet\" ]\nthen\n/bin/sed -i ''s/^START=no/START=yes/''
        /etc/default/puppet\nfi\n<%= bin_path %>/puppet agent --enable\n<% elsif os_family
        == ''Suse'' -%>\nif [ -f \"/etc/sysconfig/puppet\" ]\nthen\n/usr/bin/sed -ie
        s/^PUPPET_SERVER=.*/PUPPET_SERVER=<%= host_puppet_server %>/ /etc/sysconfig/puppet\nfi\n<%
        end -%>\n<% end -%>\n<%#\nIMPORTANT NOTE: Setting \"run-puppet-in-installer\"
        is UNSUPPORTED!\n\nThe default mode of operation in Foreman is only to set
        up Puppet, but to not run it inside the installer environment.\nRunning Puppet
        inside the installer can cause various hard to diagnose errors, many of them
        resulting from the fact that\nservices are not started inside the installer.\n\nIf
        you are aware of the downsides, you can trigger a Puppet run inside the installer
        by setting the variable\nrun-puppet-in-installer to true.\n\nNote, that this
        is an *unsupported mode of operation* and not supported by Foreman at all.
        You have been warned!\n%>\n<% if host_param_true?(''run-puppet-in-installer'')
        -%>\n<% if (os_name == ''Ubuntu'' && os_major >= 15) || (os_name == ''Debian''
        && os_major >= 8) -%>\n# Puppet tries to detect the init system by checking
        the presence of the directory /run/systemd/system. That detection\n# fails
        in a chroot environment like the one the installer provides. See Puppet tickets
        PA-136 and PUP-5577\n#\n# We work around that here until it gets fixed in
        Puppet (probably never for Puppet 3.x)\nmkdir -p /run/systemd/system\n<% end
        -%>\n<% end -%>\n# export a custom fact called ''is_installer'' to allow detection
        of the installer environment in Puppet modules\n<% if os_family == ''Windows''
        -%>\n$env:FACTER_is_installer = $TRUE\n\n# passing a non-existent tag like
        \"no_such_tag\" to the puppet agent only initializes the node\n# You can select
        specific tag(s) with the \"run-puppet-in-installer-tags\" parameter\n# or
        set a full puppet run by setting \"run-puppet-in-installer\" = true\n$puppet_agent_args
        = @(\n  \"agent\",\n  \"--config\", \"<%= etc_path %>\\puppet.conf\",\n  \"--onetime\",\n  <%=
        host_param_true?(''run-puppet-in-installer'') || @full_puppet_run ? '''' :
        \"\\\"--tags #{puppet_tags}\\\",\" %>\n  <%= host_puppet_server.blank? ? ''''
        : \"\\\"--server #{host_puppet_server}\\\",\" %>\n  \"--no-daemonize\"\n)\nStart-Process
        ''<%= bin_path %>\\puppet'' -ArgumentList $puppet_agent_args -Wait -NoNewWindow\n<%
        else -%>\nexport FACTER_is_installer=true\n# passing a non-existent tag like
        \"no_such_tag\" to the puppet agent only initializes the node\n# You can select
        specific tag(s) with the \"run-puppet-in-installer-tags\" parameter\n# or
        set a full puppet run by setting \"run-puppet-in-installer\" = true\n<% if
        host_param_true?(''run-puppet-in-installer'') || @full_puppet_run -%>\necho
        \"Performing initial full puppet run\"\n<% else -%>\necho \"Performing initial
        puppet run for --tags <%= puppet_tags %>\"\n<% end -%>\n<%= bin_path %>/puppet
        agent --config <%= etc_path %>/puppet.conf --onetime <%= host_param_true?(''run-puppet-in-installer'')
        || @full_puppet_run ? '''' : \"--tags #{puppet_tags}\" %> <%= host_puppet_server.blank?
        ? '''' : \"--server #{host_puppet_server}\" %> --no-daemonize\n<% if os_family
        == ''Suse'' || (os_name == ''Debian'' && os_major > 8) || (os_name == ''Ubuntu''
        && os_major >= 15) -%>\n<% if os_family == ''Suse'' -%>\n<%= bin_path %>/puppet
        resource service puppet enable=true\n<% else -%>\nsystemctl enable puppet\n<%
        end -%>\n<% end -%>\n<% if @host.provision_method == ''image'' -%>\n<%= bin_path
        %>/puppet resource service puppet ensure=running\n<% end -%>\n<% end -%>\n","locked":false,"snippet":true,"description":"Bootstraps
        the Puppet agent and performs one run to create a certificate request.\n\nIn
        more details it installs a Puppet agent, creates the necessary configuration
        files,\nenables the Puppet agent service and performs a single run with a
        specified tag.\nBy default the tag `no_such_tag` is used to generate an empty
        run.\nAn empty run can be used for the agent to detect it''s missing a client
        certificate\nand ask for a new one from the host''s Puppet CA.","created_at":"2024-06-27
        17:28:09 UTC","updated_at":"2024-07-03 14:59:43 UTC","id":102,"name":"puppet_setup","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '9014'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=33
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/104
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: pxegrub2_chainload\nmodel: ProvisioningTemplate\nsnippet:
        true\ndescription: |\n  In Foreman''s typical PXE workflow, managed hosts
        are configured to always boot from network and inventory build flag dictates
        if they should boot into installer (build is on) or boot from local drive
        (build is off). This template is used to chainload from EFI ESP for systems
        which booted from network. It is not as straightforward as in BIOS and EFI
        boot file must be found on an ESP partition.\n\n  This will only be needed
        when provisioned hosts are set to boot from network, typically EFI firmware
        implementations overrides boot order after new OS installation. This behavior
        can be set in EFI, or \"efi_bootentry\" host parameter can be set to \"previous\"
        to override boot order back to previous (network) setting. See efibootmgr_netboot
        snippet for more info.\n-%>\n<%\n  paths = [\n    ''/EFI/fedora/shim.efi'',\n    ''/EFI/fedora/grubx64.efi'',\n    ''/EFI/redhat/shim.efi'',\n    ''/EFI/redhat/grubx64.efi'',\n    ''/EFI/centos/shim.efi'',\n    ''/EFI/centos/grubx64.efi'',\n    ''/EFI/rocky/shim.efi'',\n    ''/EFI/rocky/grubx64.efi'',\n    ''/EFI/almalinux/shim.efi'',\n    ''/EFI/almalinux/grubx64.efi'',\n    ''/EFI/debian/grubx64.efi'',\n    ''/EFI/ubuntu/grubx64.efi'',\n    ''/EFI/sles/grubx64.efi'',\n    ''/EFI/opensuse/grubx64.efi'',\n    ''/EFI/Microsoft/boot/bootmgfw.efi''\n  ]\n-%>\ninsmod
        part_gpt\ninsmod fat\ninsmod chain\n\necho \"VMWare hosts with QuickBoot feature
        enabled may not find the local ESP\"\necho \"partition due to not initializing
        all the EFI devices. To address this,\"\necho \"use an up-to-date grub2 (*)
        version and include the \"connectefi scsi\" statement\"\necho \"as provided
        below. If you''re using an older grub2 version or\"\necho \"the \"connectefi\"
        option isn''t recognized by your grub2, grub2 will print a error\"\necho \"like
        ''can''t find command connectefi'' but the boot process will continue.\"\necho
        \"For hosts, you can omit this by adding a (global) parameter to ''grub2-connectefi=false''.\"\necho
        \"For the default GRUB2 script, you can omit this by setting the\"\necho \"default_connectefi_option
        below to ''false''.\"\necho \"Valid values of ''grub2-connectefi'' parameter:
        false, scsi, pciroot\"\necho\necho \"Virtual or physical hosts using Software
        RAID for the ESP partition may try\"\necho \"booting on the Software RAID,
        which will fail. To workaround, upgrade to the\"\necho \"latest grub2 (*)
        and add \"--efidisk-only\" argument to the \"search\" command in\"\necho \"the
        grub2_chainload template.\"\necho\necho \"(*) grub2-efi-x64-2.02-122.el8 (upstream
        doesn''t have the patches yet)\"\necho\n<%=\n  default_connectefi_option =
        ''scsi''\n  connectefi_option = @host ? host_param(''grub2-connectefi'', default_connectefi_option)
        : default_connectefi_option\n  connectefi_option = nil if connectefi_option
        == ''false''\n  \"connectefi #{connectefi_option}\" if connectefi_option\n%>\n\nif
        [ \"${lockdown}\" == \"y\" ]; then\n  if [ \"${default}\" == \"local\" ];
        then\n    set default=\"next_bootdevice\"\n  fi\n\n  menuentry ''Booting from
        next boot device'' --id next_bootdevice {\n    echo \"SecureBoot is enabled,
        attempting next boot device...\"\n    sleep 2\n    exit 1\n  }\nfi\n\nmenuentry
        ''Chainload Grub2 EFI from ESP'' --id local_chain_hd0 {\n  echo \"Chainloading
        Grub2 EFI from ESP, enabled devices for booting:\"\n  ls\n<%\n  paths.each
        do |path|\n-%>\n  echo \"Trying <%= path %> \"\n  unset chroot\n  # add --efidisk-only
        when using Software RAID\n  search --file --no-floppy --set=chroot <%= path
        %>\n  if [ -f ($chroot)<%= path %> ]; then\n    chainloader ($chroot)<%= path
        %>\n    echo \"Found <%= path %> at $chroot, attempting to chainboot it...\"\n    sleep
        2\n    boot\n  fi\n<%\n  end\n-%>\n  echo \"Partition with known EFI file
        not found, you may want to drop to grub shell\"\n  echo \"and investigate
        available files updating ''pxegrub2_chainload'' template and\"\n  echo \"the
        list of known filepaths for probing. Available devices are:\"\n  echo\n  ls\n  echo\n  echo
        \"If you cannot see the HDD, make sure the drive is marked as bootable in
        EFI and\"\n  echo \"not hidden. Boot order must be the following:\"\n  echo
        \"1) NETWORK\"\n  echo \"2) HDD\"\n  echo\n  echo \"The system will poweroff
        in 2 minutes or press ESC to poweroff immediately.\"\n  sleep -i 120\n  halt\n}\n\nmenuentry
        ''Chainload into BIOS bootloader on first disk'' --id local_chain_legacy_hd0
        {\n  set root=(hd0,0)\n  chainloader +1\n  boot\n}\n\nmenuentry ''Chainload
        into BIOS bootloader on second disk'' --id local_chain_legacy_hd1 {\n  set
        root=(hd1,0)\n  chainloader +1\n  boot\n}\n","locked":false,"snippet":true,"description":"In
        Foreman''s typical PXE workflow, managed hosts are configured to always boot
        from network and inventory build flag dictates if they should boot into installer
        (build is on) or boot from local drive (build is off). This template is used
        to chainload from EFI ESP for systems which booted from network. It is not
        as straightforward as in BIOS and EFI boot file must be found on an ESP partition.\n\nThis
        will only be needed when provisioned hosts are set to boot from network, typically
        EFI firmware implementations overrides boot order after new OS installation.
        This behavior can be set in EFI, or \"efi_bootentry\" host parameter can be
        set to \"previous\" to override boot order back to previous (network) setting.
        See efibootmgr_netboot snippet for more info.","created_at":"2024-06-27 17:28:09
        UTC","updated_at":"2024-07-03 14:59:43 UTC","id":104,"name":"pxegrub2_chainload","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '5981'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=32
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/11
  response:
    body:
      string: '{"template":"<%#\nkind: PXEGrub2\nname: PXEGrub2 default local boot\nmodel:
        ProvisioningTemplate\ndescription: |\n  The template to render Grub2 bootloader
        configuration for provisioned hosts,\n  that still boot from the network.\n  Hosts
        are instructed to boot from the first local medium.\n  Do not associate or
        change the name.\n-%>\nset default=<%= global_setting(\"default_pxe_item_local\",
        \"local\") %>\nset timeout=20\necho Default PXE local template entry is set
        to ''<%= global_setting(\"default_pxe_item_local\", \"local\") %>''\n\n<%=
        snippet \"pxegrub2_chainload\" %>\n<%= snippet \"pxegrub2_discovery\" %>\n","locked":false,"snippet":false,"description":"The
        template to render Grub2 bootloader configuration for provisioned hosts,\nthat
        still boot from the network.\nHosts are instructed to boot from the first
        local medium.\nDo not associate or change the name.","created_at":"2024-06-27
        17:28:07 UTC","updated_at":"2024-07-03 14:59:43 UTC","id":11,"name":"PXEGrub2
        default local boot","template_kind_id":5,"template_kind_name":"PXEGrub2","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1426'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=31
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/105
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: pxegrub2_discovery\nmodel: ProvisioningTemplate\nsnippet:
        true\ndescription: |\n  Snippet with grub2 menu items for discovery plugin.
        It is included in PXEGrub2 Default templates to boot unknown hosts into discovery
        image.\n\n  RHEL 7 virtio driver does not have persistent naming scheme, causing
        interfaces\n  to be named eth0, eth1, etc.. If you want to enable the new
        persistent naming\n  scheme and get inteface names like ens3, add net.ifnames=1
        to the linuxefi line\n  below. This will not be fixed until RHEL8 due to prevent
        breaking changes for\n  existing systems. See RHBZ#1259015 for more details.\n-%>\ncommon=\"rootflags=loop
        root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0
        rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nokaslr nomodeset proxy.url=<%=
        foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\"\n\nif
        [ ${grub_platform} == \"pc\" ]; then\n  menuentry ''Foreman Discovery Image''
        --id discovery {\n    linux boot/fdi-image/vmlinuz0 ${common}\n    initrd
        boot/fdi-image/initrd0.img\n  }\nelse\n  menuentry ''Foreman Discovery Image
        EFI'' --id discovery {\n    linuxefi boot/fdi-image/vmlinuz0 ${common}\n    initrdefi
        boot/fdi-image/initrd0.img\n  }\nfi\n","locked":false,"snippet":true,"description":"Snippet
        with grub2 menu items for discovery plugin. It is included in PXEGrub2 Default
        templates to boot unknown hosts into discovery image.\n\nRHEL 7 virtio driver
        does not have persistent naming scheme, causing interfaces\nto be named eth0,
        eth1, etc.. If you want to enable the new persistent naming\nscheme and get
        inteface names like ens3, add net.ifnames=1 to the linuxefi line\nbelow. This
        will not be fixed until RHEL8 due to prevent breaking changes for\nexisting
        systems. See RHBZ#1259015 for more details.","created_at":"2024-06-27 17:28:09
        UTC","updated_at":"2024-07-03 14:59:43 UTC","id":105,"name":"pxegrub2_discovery","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '2360'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=30
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/12
  response:
    body:
      string: '{"template":"<%#\nkind: PXEGrub2\nname: PXEGrub2 global default\nmodel:
        ProvisioningTemplate\ndescription: |\n  The template to render Grub2 bootloader
        configuration for unknown hosts.\n  The output is deployed on the host''s
        subnet TFTP proxy.\n  Do not associate or change the name.\n-%>\ndefault=<%=
        global_setting(\"default_pxe_item_global\", \"local\") %>\ntimeout=20\necho
        Default PXE global template entry is set to ''<%= global_setting(\"default_pxe_item_global\",
        \"local\") %>''\n\n<%= snippet \"pxegrub2_mac\" %>\n<%= snippet \"pxegrub2_chainload\"
        %>\n<%= snippet \"pxegrub2_discovery\" %>\n\n<% unless @profiles.nil? -%>\n<%
        for profile in @profiles\n  url = default_template_url(profile[:template],
        profile[:hostgroup])\n  case profile[:pxe_type]\n  when ''kickstart''\n    append
        = \"inst.ks=#{url} ksdevice=bootif network inst.ks.sendmac\"\n  when ''preseed''\n    locale
        = profile[:hostgroup].params[''lang''] || ''en_US''\n    append = \"interface=auto
        url=#{url} ramdisk_size=10800 root=/dev/rd/0 rw auto hostname=unassigned-hostname
        locale=#{locale} console-setup/ask_detect=false console-setup/layout=USA console-setup/variant=USA\"\n  else\n    raise(\"PXE
        type #{profile[:pxe_type]} not supported by template #{template_name}\")\n  end
        %>\nmenuentry ''<%= \"#{profile[:hostgroup]} - #{profile[:template]}\" %>''
        {\n  linuxefi <%= profile[:kernel] %> <%= append %>\n  initrdefi <%= profile[:initrd]
        %>\n}\n<% end %>\n<% end -%>\n","locked":false,"snippet":false,"description":"The
        template to render Grub2 bootloader configuration for unknown hosts.\nThe
        output is deployed on the host''s subnet TFTP proxy.\nDo not associate or
        change the name.","created_at":"2024-06-27 17:28:07 UTC","updated_at":"2024-07-03
        14:59:43 UTC","id":12,"name":"PXEGrub2 global default","template_kind_id":5,"template_kind_name":"PXEGrub2","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '2200'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=29
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/106
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: pxegrub2_mac\nmodel: ProvisioningTemplate\nsnippet:
        true\ndescription: |\n  Snippet that is included in all PXEGrub2 templates
        in order to find MAC-based configuration on TFTP/HTTPBoot. Grub2 in Red Hat
        is patched with this feature, however, Debian/Ubuntu or other distributions
        do not have this patch.\n-%>\necho \"Trying /httpboot/grub2/grub.cfg-$net_default_mac\"\nconfigfile
        \"/httpboot/grub2/grub.cfg-$net_default_mac\"\n\necho \"Trying /grub2/grub.cfg-$net_default_mac\"\nconfigfile
        \"/grub2/grub.cfg-$net_default_mac\"\n\n# The following four statements breaks
        grub2 and it''s no\n# longer able to load any file from the base URL.\n# Comment
        them out to be able to use (UEFI/iPXE) HTTP Boot:\n# https://bugzilla.redhat.com/show_bug.cgi?id=1763216\necho
        \"Trying grub2/grub.cfg-$net_default_mac\"\nconfigfile \"grub2/grub.cfg-$net_default_mac\"\n\necho
        \"Trying grub.cfg-$net_default_mac\"\nconfigfile \"grub.cfg-$net_default_mac\"\n","locked":false,"snippet":true,"description":"Snippet
        that is included in all PXEGrub2 templates in order to find MAC-based configuration
        on TFTP/HTTPBoot. Grub2 in Red Hat is patched with this feature, however,
        Debian/Ubuntu or other distributions do not have this patch.","created_at":"2024-06-27
        17:28:09 UTC","updated_at":"2024-07-03 14:59:43 UTC","id":106,"name":"pxegrub2_mac","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1784'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=28
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/107
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: pxegrub_chainload\nmodel: ProvisioningTemplate\nsnippet:
        true\ndescription: |\n  Snippet used to chainload BIOS HDD when booted from
        network. Used in PXEGrub global and local templates.\n-%>\n<%\n  # paths variable
        must be passed into the snippet, otherwise no EFI items are rendered\n  if
        !@paths.nil? && @paths.size > 1\n-%>\nfallback=<%= (1..@paths.size).to_a.join(''
        '') %>\n  <% @paths.each do |path| %>\ntitle Chainload Grub from /EFI/<%=
        path %> or try next\n  rootnoverify (hd0,0)\n  chainloader /EFI/<%= path %>/grubx64.efi\n  <%
        end -%>\n<% else -%>\ntitle Update your PXEGrub local template to get EFI
        options\n  root (hd0,0)\n  chainloader +1\n<% end -%>\n\ntitle Chainload into
        bootloader on first disk\n  root (hd0,0)\n  chainloader +1\n","locked":false,"snippet":true,"description":"Snippet
        used to chainload BIOS HDD when booted from network. Used in PXEGrub global
        and local templates.","created_at":"2024-06-27 17:28:09 UTC","updated_at":"2024-07-03
        14:59:43 UTC","id":107,"name":"pxegrub_chainload","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1478'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=27
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/5
  response:
    body:
      string: '{"template":"<%#\nkind: PXEGrub\nname: PXEGrub default local boot\nmodel:
        ProvisioningTemplate\ndescription: |\n  The template to render Grub bootloader
        configuration for provisioned hosts,\n  that still boot from the network.\n  Hosts
        are instructed to boot from the first local medium.\n  Do not associate or
        change the name.\n  This template is for legacy Grub 1.x, you are probably
        looking for Grub2.\n-%>\n<%\n  # Grub1 only supports numeric default statement,
        this allows conversion to number. First define\n  # array of directories we
        will search for EFI booloaders:\n  paths = [\"fedora\", \"redhat\", \"centos\",
        \"rocky\", \"almalinux\", \"debian\", \"ubuntu\", \"sles\", \"opensuse\",
        \"Microsoft\", \"EFI\"]\n  # Add remaining entries to it and use this to convert
        to number:\n  items = paths.push(\"local_chain_hd0\")\n  # Read default setting
        but since \"local\" is missing, use the first path available.\n  default_setting
        = global_setting(\"default_pxe_item_local\", paths.first)\n  default_setting
        = paths.first if default_setting == ''local''\n  default_item = items.index(default_setting)
        || 0\n%>\ndefault=<%= default_item %>\ntimeout=20\n\n<%= snippet \"pxegrub_chainload\",
        variables: {paths: paths} %>\n","locked":false,"snippet":false,"description":"The
        template to render Grub bootloader configuration for provisioned hosts,\nthat
        still boot from the network.\nHosts are instructed to boot from the first
        local medium.\nDo not associate or change the name.\nThis template is for
        legacy Grub 1.x, you are probably looking for Grub2.","created_at":"2024-06-27
        17:28:07 UTC","updated_at":"2024-07-03 14:59:43 UTC","id":5,"name":"PXEGrub
        default local boot","template_kind_id":4,"template_kind_name":"PXEGrub","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '2102'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=26
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/108
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: pxegrub_discovery\nmodel: ProvisioningTemplate\nsnippet:
        true\ndescription: |\n  Snippet with Grub menu items for discovery plugin.
        It is included in PXEGrub Default templates to boot unknown hosts into discovery
        image.\n\n  RHEL 7 virtio driver does not have persistent naming scheme, causing
        interfaces\n  to be named eth0, eth1, etc.. If you want to enable the new
        persistent naming\n  scheme and get inteface names like ens3, add net.ifnames=1
        to the linuxefi line\n  below. This will not be fixed until RHEL8 due to prevent
        breaking changes for\n  existing systems. See RHBZ#1259015 for more details.\n-%>\n#
        http://projects.theforeman.org/issues/15997\ntitle Foreman Discovery Image
        - not supported with Grub 1.x\n  kernel boot/fdi-image/vmlinuz0 rootflags=loop
        root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force rd.luks=0 rd.md=0
        rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nokaslr nomodeset proxy.url=<%=
        foreman_server_url %> proxy.type=foreman BOOTIF=01-$net_default_mac\n  initrd
        boot/fdi-image/initrd0.img\n","locked":false,"snippet":true,"description":"Snippet
        with Grub menu items for discovery plugin. It is included in PXEGrub Default
        templates to boot unknown hosts into discovery image.\n\nRHEL 7 virtio driver
        does not have persistent naming scheme, causing interfaces\nto be named eth0,
        eth1, etc.. If you want to enable the new persistent naming\nscheme and get
        inteface names like ens3, add net.ifnames=1 to the linuxefi line\nbelow. This
        will not be fixed until RHEL8 due to prevent breaking changes for\nexisting
        systems. See RHBZ#1259015 for more details.","created_at":"2024-06-27 17:28:09
        UTC","updated_at":"2024-07-03 14:59:43 UTC","id":108,"name":"pxegrub_discovery","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '2168'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=25
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/6
  response:
    body:
      string: '{"template":"<%#\nkind: PXEGrub\nname: PXEGrub global default\nmodel:
        ProvisioningTemplate\ndescription: |\n  The template to render Grub bootloader
        configuration for unknown hosts.\n  The output is deployed on the host''s
        subnet TFTP proxy.\n  Do not associate or change the name.\n  This template
        is for legacy Grub 1.x, you are probably looking for Grub2.\n-%>\n<%\n  #
        Grub1 only supports numeric default statement, this allows conversion to number.
        First define\n  # array of directories we will search for EFI booloaders:\n  paths
        = [\"fedora\", \"redhat\", \"centos\", \"rocky\", \"almalinux\", \"debian\",
        \"ubuntu\", \"sles\", \"opensuse\", \"Microsoft\", \"EFI\"]\n  # Add remaining
        entries to it and use this to convert to number:\n  items = paths.push(\"local_chain_hd0\",
        \"discovery\")\n  # Read default setting but since \"local\" is missing, use
        the first path available.\n  default_setting = global_setting(\"default_pxe_item_global\",
        paths.first)\n  default_setting = paths.first if default_setting == ''local''\n  default_item
        = items.index(default_setting) || 0\n%>\ndefault=<%= default_item %>\ntimeout=20\n\n<%=
        snippet \"pxegrub_chainload\", variables: {paths: paths} %>\n\n<%= snippet
        \"pxegrub_discovery\" %>\n\n<% unless @profiles.nil? -%>\n<% for profile in
        @profiles\n  url = default_template_url(profile[:template], profile[:hostgroup])\n  case
        profile[:pxe_type]\n  when ''kickstart''\n    append = \"inst.ks=#{url} ksdevice=bootif
        network inst.ks.sendmac\"\n  when ''preseed''\n    locale = profile[:hostgroup].params[''lang'']
        || ''en_US''\n    append = \"interface=auto url=#{url} ramdisk_size=10800
        root=/dev/rd/0 rw auto hostname=unassigned-hostname locale=#{locale} console-setup/ask_detect=false
        console-setup/layout=USA console-setup/variant=USA\"\n  else\n    raise(\"PXE
        type #{profile[:pxe_type]} not supported by template #{template_name}\")\n  end
        %>\ntitle <%= \"#{profile[:hostgroup]} - #{profile[:template]}\" %>\n  kernel
        <%= profile[:kernel] %> <%= append %>\n  initrd <%= profile[:initrd] %>\n<%
        end %>\n<% end -%>\n","locked":false,"snippet":false,"description":"The template
        to render Grub bootloader configuration for unknown hosts.\nThe output is
        deployed on the host''s subnet TFTP proxy.\nDo not associate or change the
        name.\nThis template is for legacy Grub 1.x, you are probably looking for
        Grub2.","created_at":"2024-06-27 17:28:07 UTC","updated_at":"2024-07-03 14:59:43
        UTC","id":6,"name":"PXEGrub global default","template_kind_id":4,"template_kind_name":"PXEGrub","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '2888'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=24
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/21
  response:
    body:
      string: '{"template":"<%#\nkind: PXELinux\nname: PXELinux chain iPXE\nmodel:
        ProvisioningTemplate\ndescription: |\n  Chainboots iPXE/gPXE from PXELinux.
        Make sure the OS has iPXE template\n  associated and file ipxe.lkrn was copied
        in the TFTP directory (e.g. from\n  /usr/share/ipxe/ipxe.lkrn or iPXE project
        web site).\n\n  For more info visit:\n  https://docs.theforeman.org/nightly/Provisioning_Guide/index-foreman-el.html#Configuring_Networking-Configuring_gPXE_to_Reduce_Provisioning_Times\n-%>\nDEFAULT
        linux\nLABEL linux\nKERNEL ipxe.lkrn\nAPPEND dhcp && chain <%= foreman_url(''iPXE'')
        %>\nIPAPPEND 2\n","locked":false,"snippet":false,"description":"Chainboots
        iPXE/gPXE from PXELinux. Make sure the OS has iPXE template\nassociated and
        file ipxe.lkrn was copied in the TFTP directory (e.g. from\n/usr/share/ipxe/ipxe.lkrn
        or iPXE project web site).\n\nFor more info visit:\nhttps://docs.theforeman.org/nightly/Provisioning_Guide/index-foreman-el.html#Configuring_Networking-Configuring_gPXE_to_Reduce_Provisioning_Times","created_at":"2024-06-27
        17:28:07 UTC","updated_at":"2024-07-03 14:59:43 UTC","id":21,"name":"PXELinux
        chain iPXE","template_kind_id":3,"template_kind_name":"PXELinux","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1561'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=23
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/22
  response:
    body:
      string: '{"template":"<%#\nkind: PXELinux\nname: PXELinux chain iPXE UNDI\nmodel:
        ProvisioningTemplate\ndescription: |\n  Chainboots iPXE/gPXE from PXELinux
        via UNDI. Make sure the OS has an iPXE\n  template associated and the file
        undionly.kpxe was copied into the TFTP\n  directory as undionly-ipxe.0 (e.g.
        from /usr/share/ipxe/undionly.kpxe or\n  the iPXE project web site). Changes
        need to be made in the DHCP\n  configuration to prevent an endless loop to
        happen.\n\n  For more info visit:\n  https://docs.theforeman.org/nightly/Provisioning_Guide/index-foreman-el.html#Configuring_Networking-Configuring_gPXE_to_Reduce_Provisioning_Times\n-%>\nDEFAULT
        linux\nLABEL linux\nKERNEL undionly-ipxe.0\nIPAPPEND 2\n","locked":false,"snippet":false,"description":"Chainboots
        iPXE/gPXE from PXELinux via UNDI. Make sure the OS has an iPXE\ntemplate associated
        and the file undionly.kpxe was copied into the TFTP\ndirectory as undionly-ipxe.0
        (e.g. from /usr/share/ipxe/undionly.kpxe or\nthe iPXE project web site). Changes
        need to be made in the DHCP\nconfiguration to prevent an endless loop to happen.\n\nFor
        more info visit:\nhttps://docs.theforeman.org/nightly/Provisioning_Guide/index-foreman-el.html#Configuring_Networking-Configuring_gPXE_to_Reduce_Provisioning_Times","created_at":"2024-06-27
        17:28:07 UTC","updated_at":"2024-07-03 14:59:44 UTC","id":22,"name":"PXELinux
        chain iPXE UNDI","template_kind_id":3,"template_kind_name":"PXELinux","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1810'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=22
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/109
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: pxelinux_chainload\nmodel: ProvisioningTemplate\nsnippet:
        true\ndescription: |\n  Snippet used to chainload BIOS HDD when booted from
        network. Used in PXELinux global and local templates.\n-%>\nLABEL local\n  MENU
        LABEL Default local boot\n  LOCALBOOT 0\n\nLABEL local_primary\n  MENU LABEL
        Default local boot from primary hard drive\n  LOCALBOOT 0x80\n\nLABEL local_skip\n  MENU
        LABEL Boot from the next BIOS device\n  LOCALBOOT -1\n\nLABEL local_chain_hd0\n  MENU
        LABEL Chainload the first hard drive (hd0)\n  COM32 chain.c32\n  APPEND hd0\n\nLABEL
        local_chain_hd1\n  MENU LABEL Chainload the second hard drive (hd1)\n  COM32
        chain.c32\n  APPEND hd1\n","locked":false,"snippet":true,"description":"Snippet
        used to chainload BIOS HDD when booted from network. Used in PXELinux global
        and local templates.","created_at":"2024-06-27 17:28:09 UTC","updated_at":"2024-07-03
        14:59:44 UTC","id":109,"name":"pxelinux_chainload","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1384'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=21
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/23
  response:
    body:
      string: '{"template":"<%#\nkind: PXELinux\nname: PXELinux default local boot\nmodel:
        ProvisioningTemplate\ndescription: |\n  The template to render PXELinux bootloader
        configuration for provisioned hosts,\n  that still boot from the network.\n  Hosts
        are instructed to boot from the first local medium.\n  Do not associate or
        change the name.\n-%>\n<% if @host.architecture.to_s.match(/s390x?/i) -%>\n#
        pxelinux\n# Reboot dracut image must be manually built and copied over to
        the TFTP\n# https://github.com/lzap/dracut-reboot-s390x\ndefault reboot\nlabel
        reboot\nkernel kernel-reboot.img\ninitrd initrd-reboot.img\n# Uncomment to
        customize chreipl arguments\n#append rd.shell rd.chreipl=ccw rd.chreipl=0.0.0000XXX\n<%
        else -%>\nUI menu.c32\nMENU TITLE Booting local disk (ESC to stop)\nTIMEOUT
        200\nONTIMEOUT <%= global_setting(\"default_pxe_item_local\", \"local_chain_hd0\")
        %>\nDEFAULT <%= global_setting(\"default_pxe_item_local\", \"local_chain_hd0\")
        %>\n\n<%= snippet \"pxelinux_chainload\" %>\n<% end -%>\n","locked":false,"snippet":false,"description":"The
        template to render PXELinux bootloader configuration for provisioned hosts,\nthat
        still boot from the network.\nHosts are instructed to boot from the first
        local medium.\nDo not associate or change the name.","created_at":"2024-06-27
        17:28:07 UTC","updated_at":"2024-07-03 14:59:44 UTC","id":23,"name":"PXELinux
        default local boot","template_kind_id":3,"template_kind_name":"PXELinux","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1816'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=20
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/24
  response:
    body:
      string: '{"template":"<%#\nkind: PXELinux\nname: PXELinux default memdisk\nmodel:
        ProvisioningTemplate\noses:\n- FreeBSD (memdisk image)\ndescription: |\n  The
        template to render PXELinux bootloader configuration for FreeBSD.\n  The output
        is deployed on the host''s subnet TFTP proxy. It boots the memdisk.\n  Memdisk
        is meant to allow booting legacy operating systems. Memdisk can boot\n  floppy
        images, hard disk images and some ISO images.\n\n  This template does not
        store the foreman_url in the comment (see freebsd (mfsbsd) pxelinux\n  template)\n-%>\nDEFAULT
        memdisk\n\nLABEL memdisk\n    KERNEL memdisk\n    APPEND initrd=<%= @initrd
        %> harddisk raw\n","locked":false,"snippet":false,"description":"The template
        to render PXELinux bootloader configuration for FreeBSD.\nThe output is deployed
        on the host''s subnet TFTP proxy. It boots the memdisk.\nMemdisk is meant
        to allow booting legacy operating systems. Memdisk can boot\nfloppy images,
        hard disk images and some ISO images.\n\nThis template does not store the
        foreman_url in the comment (see freebsd (mfsbsd) pxelinux\ntemplate)","created_at":"2024-06-27
        17:28:08 UTC","updated_at":"2024-07-03 14:59:44 UTC","id":24,"name":"PXELinux
        default memdisk","template_kind_id":3,"template_kind_name":"PXELinux","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1631'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=19
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/110
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: pxelinux_discovery\nmodel: ProvisioningTemplate\nsnippet:
        true\ndescription: |\n  Snippet with PXELinux menu items for discovery plugin.
        It is included in PXELinux Default templates to boot unknown hosts into discovery
        image.\n\n  discovery image is based on CentOS/RHEL and therefore it is affected
        by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\n  In short, before
        RHEL 7.2 virtio driver didn''t have the new persistent naming scheme, causing
        interfaces to be named eth0, eth1, etc..\n  If you want to enable the new
        persistent naming scheme and get inteface names like ens3, add net.ifnames=1
        to the APPEND line below.\n-%>\nLABEL discovery\n  MENU LABEL Foreman Discovery
        Image\n  KERNEL boot/fdi-image/vmlinuz0\n  APPEND initrd=boot/fdi-image/initrd0.img
        rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force
        rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nokaslr nomodeset
        proxy.url=<%= foreman_server_url %> proxy.type=foreman\n  IPAPPEND 2\n\n<%#\nChainbooting
        via iPXE requires an extra script published via HTTP:\n\n#!ipxe\nkernel http://foreman_url/pub/vmlinuz0
        rootflags=loop root=live:/fdi.iso rootfstype=auto ro rd.live.image acpi=force
        rd.luks=0 rd.md=0 rd.dm=0 rd.lvm=0 rd.bootif=0 rd.neednet=0 nokaslr nomodeset
        proxy.url=https://foreman_url proxy.type=foreman BOOTIF=01-${net0/mac}\ninitrd
        http://foreman_url/pub/initrd0.img\nboot\n-%>\nLABEL discovery_ipxe\n  MENU
        LABEL Foreman Discovery Image - iPXE\n  KERNEL ipxe.lkrn\n  APPEND dhcp &&
        chain <%= foreman_server_url %>/pub/discovery.ipxe\n","locked":false,"snippet":true,"description":"Snippet
        with PXELinux menu items for discovery plugin. It is included in PXELinux
        Default templates to boot unknown hosts into discovery image.\n\ndiscovery
        image is based on CentOS/RHEL and therefore it is affected by https://bugzilla.redhat.com/show_bug.cgi?id=1259015.\nIn
        short, before RHEL 7.2 virtio driver didn''t have the new persistent naming
        scheme, causing interfaces to be named eth0, eth1, etc..\nIf you want to enable
        the new persistent naming scheme and get inteface names like ens3, add net.ifnames=1
        to the APPEND line below.","created_at":"2024-06-27 17:28:09 UTC","updated_at":"2024-07-03
        14:59:44 UTC","id":110,"name":"pxelinux_discovery","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '2723'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=18
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/25
  response:
    body:
      string: '{"template":"<%#\nkind: PXELinux\nname: PXELinux global default\nmodel:
        ProvisioningTemplate\ndescription: |\n  The template to render PXELinux bootloader
        configuration for unknown hosts.\n  The output is deployed on the host''s
        subnet TFTP proxy.\n  Do not associate or change the name.\n-%>\n\nUI menu.c32\nMENU
        TITLE Booting unknown host (ESC to stop)\nTIMEOUT 200\nONTIMEOUT <%= global_setting(\"default_pxe_item_global\",
        \"local\") %>\nDEFAULT <%= global_setting(\"default_pxe_item_global\", \"local\")
        %>\n\n<%= snippet \"pxelinux_chainload\" %>\n\n<%= snippet \"pxelinux_discovery\"
        %>\n\n<% unless @profiles.nil? -%>\n<% for profile in @profiles\n  url = default_template_url(profile[:template],
        profile[:hostgroup])\n  case profile[:pxe_type]\n  when ''kickstart''\n    append
        = \"inst.ks=#{url} ksdevice=bootif network inst.ks.sendmac\"\n  when ''preseed''\n    locale
        = profile[:hostgroup].params[''lang''] || ''en_US''\n    append = \"interface=auto
        url=#{url} ramdisk_size=10800 root=/dev/rd/0 rw auto hostname=unassigned-hostname
        locale=#{locale} console-setup/ask_detect=false console-setup/layout=USA console-setup/variant=USA\"\n  else\n    raise(\"PXE
        type #{profile[:pxe_type]} not supported by template #{template_name}\")\n  end
        %>\nLABEL <%= \"#{profile[:hostgroup]} - #{profile[:template]}\" %>\n  KERNEL
        <%= profile[:kernel] %>\n  APPEND initrd=<%= profile[:initrd] %> <%= append
        %>\n<% end %>\n<% end -%>\n","locked":false,"snippet":false,"description":"The
        template to render PXELinux bootloader configuration for unknown hosts.\nThe
        output is deployed on the host''s subnet TFTP proxy.\nDo not associate or
        change the name.","created_at":"2024-06-27 17:28:08 UTC","updated_at":"2024-07-03
        14:59:44 UTC","id":25,"name":"PXELinux global default","template_kind_id":3,"template_kind_name":"PXELinux","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '2188'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=17
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/111
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: rancheros_cloudconfig\nmodel:
        ProvisioningTemplate\nsnippet: true\ndescription: |\n    The cloud config
        used for the RancherOS installation\n-%>\n#cloud-config\nhostname: <%= @host.shortname
        %>\nrancher:\n  network:\n    dns:\n<% unless @host.subnet.dns_servers.empty?
        -%>\n      nameservers:\n<% @host.subnet.dns_servers.each do |nameserver|
        -%>\n        - <%= nameserver %>\n<% end -%>\n<% end -%>\n      search:\n        -
        <%= @host.domain %>\n    interfaces:\n      eth*:\n        dhcp: true\n<%
        unless @host.subnet.respond_to?(:dhcp_boot_mode?) -%>\n      eth0:\n        address:
        <%= @host.ip -%>/<%= @host.subnet.cidr %>\n        gateway: <%= @host.subnet.gateway
        %>\n<% end -%>\n  console: debian\nssh_authorized_keys:\n<%-\nusers = @host.owner_type
        == ''Usergroup'' ? @host.owner.all_users : [@host.owner]\nusers.each do |user|\n  if
        user.respond_to?(:ssh_authorized_keys) && user.ssh_authorized_keys.any?\n    index
        = 0\n    user.ssh_keys.each do |key|\n      if index == 0\n-%>\n<%=\"  - #{key.type}
        #{key.ssh_key} #{key.comment}\"%>\n<%-\n      else\n-%>\n<%=\"  - #{key.type}
        #{key.ssh_key} #{key.comment} - #{index}\"%>\n<%-\n      end\n      index
        += 1\n    end\n  end\nend\n-%>\n","locked":false,"snippet":true,"description":"The
        cloud config used for the RancherOS installation","created_at":"2024-06-27
        17:28:09 UTC","updated_at":"2024-07-03 14:59:44 UTC","id":111,"name":"rancheros_cloudconfig","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1873'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=16
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/67
  response:
    body:
      string: '{"template":"<%#\nkind: provision\nname: RancherOS provision\nmodel:
        ProvisioningTemplate\noses:\n- RancherOS\ndescription: |\n  The provisioning
        template for the RancherOS. The output is the cloud config data.\n  This does
        not work with k3os, a successor of the RancherOS 1.x and 2.x\n-%>\n<%= snippet
        ''rancheros_cloudconfig'' -%>\n","locked":false,"snippet":false,"description":"The
        provisioning template for the RancherOS. The output is the cloud config data.\nThis
        does not work with k3os, a successor of the RancherOS 1.x and 2.x","created_at":"2024-06-27
        17:28:08 UTC","updated_at":"2024-07-03 14:59:44 UTC","id":67,"name":"RancherOS
        provision","template_kind_id":7,"template_kind_name":"provision","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1077'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=15
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/26
  response:
    body:
      string: '{"template":"<%#\nkind: PXELinux\nname: RancherOS PXELinux\nmodel:
        ProvisioningTemplate\noses:\n- RancherOS\ndescription: |\n  The template to
        render PXELinux bootloader configuration for RancherOS.\n  This does not work
        with k3os, a successor of the RancherOS 1.x and 2.x\n  The output is deployed
        on the host''s subnet TFTP proxy.\n-%>\nDEFAULT rancheros\n\nLABEL rancheros\n    KERNEL
        <%= @kernel %>\n    APPEND rancher.state.dev=LABEL=RANCHER_STATE rancher.state.autoformat=[<%=
        host_param(''install-disk'') || ''/dev/sda'' %>] rancher.cloud_init.datasources=[''url:<%=
        foreman_url(''provision'')-%>'']\n    INITRD <%= @initrd -%>\n","locked":false,"snippet":false,"description":"The
        template to render PXELinux bootloader configuration for RancherOS.\nThis
        does not work with k3os, a successor of the RancherOS 1.x and 2.x\nThe output
        is deployed on the host''s subnet TFTP proxy.","created_at":"2024-06-27 17:28:08
        UTC","updated_at":"2024-07-03 14:59:44 UTC","id":26,"name":"RancherOS PXELinux","template_kind_id":3,"template_kind_name":"PXELinux","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1417'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=14
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/112
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: redhat_register\nmodel: ProvisioningTemplate\nsnippet:
        true\ndescription: |\n  Red Hat Registration Snippet\n\n  General parameters:\n\n    redhat_install_host_tools
        = [true|false]    Install the katello-host-tools yum/dnf plugins.\n\n    redhat_install_host_tracer_tools
        = [true|false]  Install the katello-host-tools Tracer yum/dnf plugin.\n\n    activation_key
        = <key>                      Activation key string, not needed if using\n                                                subscription-manager
        with username/password\n\n  Parameters for use with subscription-manager (Red
        Hat CDN, Satellite, or Katello)\n\n    subscription_manager = ''true''               You''re
        going to use subscription-manager\n\n    subscription_manager_auto_attach
        = ''false''  Run attach --auto after registering.\n\n    subscription_manager_username
        = <username>  Username for subscription-manager\n\n    subscription_manager_password
        = <password>  Password for subscription-manager\n\n    subscription_manager_certpkg_url
        = <url>    Custom certificate package URL\n\n    subscription_manager_org
        = <org name>       Organization name, if required\n\n    subscription_manager_repos
        = <repos>        Additional repositories to enable\n                                                after
        registration.\n                                                Seperate multiple
        repositories with commas.\n\n    subscription_manager_override_repos_cost
        = <cost>  Override repository cost\n\n    subscription_manager_pool = <pool>          Specific
        subscription pool to use\n\n    only_subscription_manager_repos = ''true''    dnf/yum
        should only use repos managed by sub-man\n\n    http-proxy = <host>                         Proxy
        hostname to be used for registration\n\n    http-proxy-port = <port>                    Proxy
        port to be used for registration\n\n    http-proxy-user = <user>                    Proxy
        user to be used for registration\n\n    http-proxy-password = <password>            Proxy
        password to be used for registration\n\n    syspurpose_role                             Sets
        the system purpose role\n\n    syspurpose_usage                            Sets
        the system purpose usage\n\n    syspurpose_sla                              Sets
        the system purpose SLA\n\n    syspurpose_addons                           Sets
        the system purpose add-ons. Separate multiple\n                                                values
        with commas.\n\n  Set these parameters if you''re using rhnreg_ks:\n\n    spacewalk_host
        = <hostname>                 Hostname of Spacewalk server\n-%>\n<%\n  # Katello
        or subscription-manager:\n  if host_param_true?(''subscription_manager'')
        || host_param(''kt_activation_keys'')\n    registration_type = ''subscription_manager''\n  #
        Spacewalk:\n  elsif host_param(''spacewalk_host'')\n    registration_type
        = ''spacewalk''\n  else\n    registration_type = nil\n  end\n-%>\n# registration_type
        = ''<%= registration_type %>''\n<% if registration_type == ''subscription_manager''
        -%>\n  <%\n    if host_param(''kt_activation_keys'')\n      subscription_manager_certpkg_url
        = subscription_manager_configuration_url(@host)\n      subscription_manager_org
        = @host.rhsm_organization_label\n      activation_key = host_param(''kt_activation_keys'')\n      redhat_install_host_tools
        = host_param_true?(''redhat_install_host_tools'', true)\n      redhat_install_host_tracer_tools
        = host_param_true?(''redhat_install_host_tracer_tools'')\n    else\n      subscription_manager_certpkg_url
        = host_param(''subscription_manager_certpkg_url'')\n      subscription_manager_org
        = host_param(''subscription_manager_org'')\n      activation_key = host_param(''activation_key'')\n      redhat_install_host_tools
        = host_param_true?(''redhat_install_host_tools'')\n      redhat_install_host_tracer_tools
        = host_param_true?(''redhat_install_host_tracer_tools'')\n    end\n  -%>\n\n  echo
        \"##############################################################\"\n  echo
        \"################# SUBSCRIPTION MANAGER #######################\"\n  echo
        \"##############################################################\"\n  echo\n  echo
        \"Starting the subscription-manager registration process\"\n\n  # Set up subscription-manager\n  <%=
        snippet(\"subscription_manager_setup\", variables: { subman_setup_scenario:
        ''provisioning'' }).strip -%>\n\n  <%- if (host_param(''syspurpose_role'')
        || host_param(''syspurpose_usage'') || host_param(''syspurpose_sla'') || host_param(''syspurpose_addons''))
        -%>\n    # Avoid timeout accessing unreachable repo on air gapped infrastructure,\n    #  assuming
        subscription-manager-syspurpose is installed in custom packages section.\n    if
        ! rpm --query --quiet subscription-manager-syspurpose ; then\n      $PKG_MANAGER_INSTALL
        subscription-manager-syspurpose\n    fi\n\n    if [ -f /usr/sbin/syspurpose
        ]; then\n      <%- if host_param(''syspurpose_role'') -%>\n        syspurpose
        set-role \"<%= host_param(''syspurpose_role'') %>\"\n      <%- end -%>\n      <%-
        if host_param(''syspurpose_usage'') -%>\n        syspurpose set-usage \"<%=
        host_param(''syspurpose_usage'') %>\"\n      <%- end -%>\n      <%- if host_param(''syspurpose_sla'')
        -%>\n        syspurpose set-sla \"<%= host_param(''syspurpose_sla'') %>\"\n      <%-
        end -%>\n      <%- if host_param(''syspurpose_addons'') -%>\n        <%- addons
        = host_param(''syspurpose_addons'').split('','')\n              .map { |add_on|
        \"''#{add_on.strip}''\" }.join(\" \") %>\n        syspurpose add-addons <%=
        addons %>\n      <%- end -%>\n    else\n      echo \"Syspurpose CLI not found.\"\n    fi\n  <%
        end -%>\n\n  <% if host_param(''http-proxy'') -%>\n    subscription-manager
        config --server.proxy_hostname=''<%= host_param(\"http-proxy\") %>''\n    <%
        if host_param(''http-proxy-user'') -%>\n      subscription-manager config
        --server.proxy_user=''<%= host_param(\"http-proxy-user\") %>''\n    <% end
        -%>\n    <% if host_param(''http-proxy-password'') -%>\n      subscription-manager
        config --server.proxy_password=''<%= host_param(\"http-proxy-password\") %>''\n    <%
        end -%>\n    <% if host_param(''http-proxy-port'') -%>\n      subscription-manager
        config --server.proxy_port=''<%= host_param(\"http-proxy-port\") %>''\n    <%
        end -%>\n  <% end -%>\n  \n  <% if host_param(''subscription_manager_username'')
        && host_param(''subscription_manager_password'') -%>\n    <% if host_param(''subscription_manager_pool'')
        -%>\n      subscription-manager register --name=\"<%= @host.name %>\" --username=''<%=
        host_param(\"subscription_manager_username\") %>'' --password=''<%= host_param(\"subscription_manager_password\")
        %>''\n      subscription-manager attach --pool=''<%= host_param(''subscription_manager_pool'')
        %>''\n    <% else -%>\n      subscription-manager register --name=\"<%= @host.name
        %>\" --username=''<%= host_param(\"subscription_manager_username\") %>'' --password=''<%=
        host_param(\"subscription_manager_password\") %>'' --auto-attach\n    <% end
        -%>\n\n  <% elsif activation_key -%>\n    subscription-manager register --name=\"<%=
        @host.name %>\" --org=''<%= subscription_manager_org %>'' --activationkey=''<%=
        activation_key %>''\n  <% else -%>\n    echo \"No activation key found: Not
        registering to subscription manager\"\n  <% end -%>\n\n  <% if host_param_true?(''only_subscription_manager_repos'')
        -%>\n    for subman_config_file in /etc/yum/pluginconf.d/subscription-manager.conf
        /etc/dnf/plugins/subscription-manager.conf; do\n      if [ -f $subman_config_file
        ]; then\n        egrep -q \"^disable_system_repos=\" $subman_config_file\n        if
        [ \"$?\" -eq 0 ]; then\n          sed s/^disable_system_repos=.*/disable_system_repos=1/
        $subman_config_file >\"${subman_config_file}.new\"\n          mv -f \"${subman_config_file}.new\"
        $subman_config_file\n        else\n          echo \"disable_system_repos=1\"
        >>$subman_config_file\n        fi\n      fi\n    done\n  <% end -%>\n\n  <%
        if host_param_true?(''subscription_manager_auto_attach'', false) -%>\n    subscription-manager
        attach --auto\n\n  <% end -%>\n  <% if host_param(''subscription_manager_repos'')
        -%>\n    # workaround for RHEL 6.4 bug https://bugzilla.redhat.com/show_bug.cgi?id=1008016\n    subscription-manager
        repos --list > /dev/null\n    <%= \"subscription-manager repos --enable #{host_param(''subscription_manager_repos'').gsub(/,\\s*/,
        '' --enable '')}\" %>\n  <% end -%>\n\n  <% if host_param(''subscription_manager_override_repos_cost'')
        -%>\n    for repo in $(subscription-manager repos --list-enabled | grep \"Repo
        ID:\" | awk -F'' '' ''{ print $3 }''); do\n      <%= \"subscription-manager
        repo-override --list --repo $repo | grep ''cost:'' &>/dev/null || subscription-manager
        repo-override --repo $repo --add=cost:#{host_param(''subscription_manager_override_repos_cost'')}\"
        %>\n    done\n  <% end -%>\n\n  <% if redhat_install_host_tools -%>\n    $PKG_MANAGER_INSTALL
        katello-host-tools\n  <% end -%>\n\n  <% if redhat_install_host_tracer_tools
        -%>\n    $PKG_MANAGER_INSTALL katello-host-tools-tracer\n  <% end -%>\n<%
        end -%>\n\n<% if registration_type == ''spacewalk'' -%>\n  echo \"##############################################################\"\n  echo
        \"################ SPACEWALK REGISTRATION ######################\"\n  echo
        \"##############################################################\"\n\n  <%
        if host_param(''activation_key'') -%>\n    rhn_activation_key=\"<%= host_param(''activation_key'')
        -%>\"\n    satellite_hostname=\"<%= host_param(''spacewalk_host'') -%>\"\n    rhn_cert_file=\"RHN-ORG-TRUSTED-SSL-CERT\"\n\n    echo
        \"Registering to RHN Satellite at [$satellite_hostname]\"\n    echo \"Using
        Registration Key [$rhn_activation_key]\"\n\n    # Obtain our RHN Satellite
        Certificate\n    echo \"Obtaining RHN SSL certificate\"\n    curl -o /usr/share/rhn/$rhn_cert_file
        -k https://$satellite_hostname/pub/$rhn_cert_file\n\n    <% if @host.operatingsystem.name
        == ''SLES'' -%>\n      # If SLES then add CA Cert to CA Certs for curl\n      cp
        /usr/share/rhn/$rhn_cert_file /etc/ssl/certs/\n      ln -s /etc/ssl/certs/$rhn_cert_file
        /etc/ssl/certs/`openssl x509 -hash -noout -in /etc/ssl/certs/$rhn_cert_file`.0\n    <%
        end -%>\n\n    # Update our up2date configuration file\n    echo \"Updating
        SSL CA Certificate to /usr/share/rhn/$rhn_cert_file\"\n    sed -i -e \"s|^sslCACert=.*$|sslCACert=/usr/share/rhn/$rhn_cert_file|\"
        /etc/sysconfig/rhn/up2date\n\n    # Update our Satellite Hostname\n    echo
        \"Updating Satellite Hostname to [$satellite_hostname]\"\n    sed -i -e \"s|^serverURL=.*$|serverURL=https://$satellite_hostname/XMLRPC|\"
        /etc/sysconfig/rhn/up2date\n    sed -i -e \"s|^noSSLServerURL=.*$|noSSLServerURL=https://$satellite_hostname/XMLRPC|\"
        /etc/sysconfig/rhn/up2date\n\n    # Restart messagebus/HAL to try and prevent
        hardware detection errors in rhnreg_ks\n    echo \"Restarting services...\"\n    <%
        if @host.operatingsystem.name == ''SLES'' && @host.operatingsystem.major.to_i
        < 12 -%>\n      service haldaemon restart\n    <% else -%>\n      service
        messagebus restart\n      service hald restart\n    <% end -%>\n\n    # Now,
        perform our registration\n    #  (might get hardware errors here, due to dbus/messagebus
        lameness. These are safe to ignore.)\n    echo -n \"Performing RHN Registration...
        \"\n    rhnreg_ks --activationkey=$rhn_activation_key\n    echo \"done.\"\n\n    #
        Check we registered\n    echo -n \"Checking System Registration... \"\n    if
        ! rhn_check; then\n        echo \"FAILED\"\n        echo \" >> RHN Registration
        FAILED. Please Investigate. <<\"\n    else\n        echo \"registration successful.\"\n    fi\n\n  <%
        else -%>\n    echo \"No activation key found: Not registering\"\n  <% end
        -%>\n<% end -%>\n","locked":false,"snippet":true,"description":"Red Hat Registration
        Snippet\n\nGeneral parameters:\n\n  redhat_install_host_tools = [true|false]    Install
        the katello-host-tools yum/dnf plugins.\n\n  redhat_install_host_tracer_tools
        = [true|false]  Install the katello-host-tools Tracer yum/dnf plugin.\n\n  activation_key
        = <key>                      Activation key string, not needed if using\n                                              subscription-manager
        with username/password\n\nParameters for use with subscription-manager (Red
        Hat CDN, Satellite, or Katello)\n\n  subscription_manager = ''true''               You''re
        going to use subscription-manager\n\n  subscription_manager_auto_attach =
        ''false''  Run attach --auto after registering.\n\n  subscription_manager_username
        = <username>  Username for subscription-manager\n\n  subscription_manager_password
        = <password>  Password for subscription-manager\n\n  subscription_manager_certpkg_url
        = <url>    Custom certificate package URL\n\n  subscription_manager_org =
        <org name>       Organization name, if required\n\n  subscription_manager_repos
        = <repos>        Additional repositories to enable\n                                              after
        registration.\n                                              Seperate multiple
        repositories with commas.\n\n  subscription_manager_override_repos_cost =
        <cost>  Override repository cost\n\n  subscription_manager_pool = <pool>          Specific
        subscription pool to use\n\n  only_subscription_manager_repos = ''true''    dnf/yum
        should only use repos managed by sub-man\n\n  http-proxy = <host>                         Proxy
        hostname to be used for registration\n\n  http-proxy-port = <port>                    Proxy
        port to be used for registration\n\n  http-proxy-user = <user>                    Proxy
        user to be used for registration\n\n  http-proxy-password = <password>            Proxy
        password to be used for registration\n\n  syspurpose_role                             Sets
        the system purpose role\n\n  syspurpose_usage                            Sets
        the system purpose usage\n\n  syspurpose_sla                              Sets
        the system purpose SLA\n\n  syspurpose_addons                           Sets
        the system purpose add-ons. Separate multiple\n                                              values
        with commas.\n\nSet these parameters if you''re using rhnreg_ks:\n\n  spacewalk_host
        = <hostname>                 Hostname of Spacewalk server","created_at":"2024-06-27
        17:28:09 UTC","updated_at":"2024-07-03 14:59:44 UTC","id":112,"name":"redhat_register","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '14564'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=13
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/71
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: remote_execution_pull_setup\nmodel:
        ProvisioningTemplate\nsnippet: true\ndescription: |\n  Snippet for installing
        and setting up a client to be reachable by remote execution in pull mode\n-%>\n\necho
        \"Starting deployment of REX pull provider\"\n# check if system is registered\nsubscription-manager
        identity > /dev/null\nif [ $? -ne 0 ]; then\n    echo \"Please register with
        subscription-manager first, then re-run ''$0''.\"\n    exit 1\nfi\n\nset -e\n\n<%=
        install_packages(''foreman_ygg_worker'') %>\n\necho \"Getting configuration
        from subscription-manager...\"\nKPPTEMPFILE=$(mktemp kpp_tempfile_XXXXXXXX)\ntrap
        \"rm -f $KPPTEMPFILE\" EXIT\nsubscription-manager config --list > $KPPTEMPFILE\nCONSUMER_CERT_DIR=$(grep
        ''consumercertdir'' $KPPTEMPFILE | cut -d= -f2 | xargs | sed ''s/[][]//g'')\nCERT_FILE=$CONSUMER_CERT_DIR/cert.pem\nKEY_FILE=$CONSUMER_CERT_DIR/key.pem\nCA_FILE=$(grep
        ''repo_ca_cert = '' $KPPTEMPFILE | cut -d= -f2 | xargs | cut -d '' '' -f1)\nSERVER_NAME=$(grep
        ''hostname = '' $KPPTEMPFILE | cut -d= -f2 | xargs | cut -d '' '' -f1)\n\n#
        fail if no server name, cert dir, or ca file\nif [ -z \"$SERVER_NAME\" ] ||
        [ -z \"$CONSUMER_CERT_DIR\" ] || [ -z \"$CA_FILE\" ]; then\n    echo \"Unable
        to determine config from ''subscription-manager config --list''; exiting\"\n    exit
        1\nfi\n\n# fail if client is not registered to a Katello\nif ! grep -q ''prefix
        = \\/rhsm'' $KPPTEMPFILE; then\n    echo \"Client is registered to RHSM; exiting\"\n    exit
        1\nfi\n\n# set SYSCONFDIR to /etc if it is not set\nif [ -z \"$SYSCONFDIR\"
        ]; then\n    SYSCONFDIR=/etc\nfi\n\n# see if /etc/yggdrasil/config.toml exists\nCONFIGTOML=$SYSCONFDIR/yggdrasil/config.toml\nif
        [ -f $CONFIGTOML ]; then\n    # make a backup of CONFIGTOML\n    cp $CONFIGTOML
        $CONFIGTOML.bak\n    cat <<EOF > $CONFIGTOML\n# yggdrasil global configuration
        settings written by katello-pull-transport-migrate\nbroker = [\"mqtts://$SERVER_NAME:1883\"]\ncert-file
        = \"$CERT_FILE\"\nkey-file = \"$KEY_FILE\"\nca-root = [\"$CA_FILE\"]\nlog-level
        = \"error\"\nEOF\n\nelse\n    echo \"$SYSCONFDIR/yggdrasil/config.toml not
        found! Did ''yum install yggdrasil'' succeed?\"\n    exit 1\nfi\n\n# start
        the yggdrasild service\nif systemctl is-enabled yggdrasild 2>/dev/null &&
        [ -n \"$YGGDRASIL_RESTART_DELAY\" ] && [ \"$YGGDRASIL_RESTART_DELAY\" -gt
        0 ]; then\n    systemd-run --on-active=\"$YGGDRASIL_RESTART_DELAY\" --collect
        --no-block systemctl restart yggdrasild\nelse\n    echo \"Starting yggdrasild...\"\n    systemctl
        try-restart yggdrasild\n    systemctl enable --now yggdrasild\n\n    # check
        status of yggdrasild and fail if it is not running\n    # possible failure
        reason: incorrect protocol (should be tcp:// or mqtt://) or port (should be
        1883)\n    # also, cert-file and key-file must be valid\n    # and broker
        must be running on the server\n    yggdrasil status\n\n    if ! systemctl
        is-active --quiet yggdrasild; then\n        echo \"\"\n        echo \"yggdrasild
        failed to start! Check configuration in $CONFIGTOML and make sure the broker
        is running on the server.\"\n        exit $?\n    fi\nfi\n\necho \"Remote
        execution pull provider successfully configured!\"\n","locked":false,"snippet":true,"description":"Snippet
        for installing and setting up a client to be reachable by remote execution
        in pull mode","created_at":"2024-06-27 17:28:08 UTC","updated_at":"2024-07-03
        14:59:44 UTC","id":71,"name":"remote_execution_pull_setup","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '3863'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=12
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/113
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: remote_execution_ssh_keys\nmodel:
        ProvisioningTemplate\nsnippet: true\ndescription: |\n  SSH keys setup snippet
        for Remote Execution plugin\n\n  Parameters:\n\n  remote_execution_ssh_keys:
        public keys to be put in ~/.ssh/authorized_keys\n\n  remote_execution_ssh_user:
        user for which remote_execution_ssh_keys will be\n                             authorized\n\n  remote_execution_create_user:
        create user if it not already existing\n\n  remote_execution_effective_user_method:
        method to switch from ssh user to\n                                          effective
        user\n\n  This template sets up SSH keys in any host so that as long as your
        public\n  SSH key is in remote_execution_ssh_keys, you can SSH into a host.
        This\n  works in combination with Remote Execution plugin by querying smart
        proxies\n  to build an array.\n\n  To use this snippet without the plugin
        provide the SSH keys as host parameter\n  remote_execution_ssh_keys. It expects
        the same format like the authorized_keys\n  file.\n-%>\n\n<% if !host_param(''remote_execution_ssh_keys'').blank?
        %>\n<% ssh_user = host_param(''remote_execution_ssh_user'') || ''root'' %>\n\nuser_exists=false\ngetent
        passwd <%= ssh_user %> >/dev/null 2>&1 && user_exists=true\n\n<% if ssh_user
        != ''root'' && host_param_true?(''remote_execution_create_user'') -%>\nif
        ! $user_exists; then\n  useradd -m <%= ssh_user %> && user_exists=true\nfi\n<%
        end -%>\n\nif $user_exists; then\n<% ssh_path = \"~#{ssh_user}/.ssh\" %>\n\n  mkdir
        -p <%= ssh_path %>\n\n  cat << EOF >> <%= ssh_path %>/authorized_keys\n<%=
        host_param(''remote_execution_ssh_keys'').is_a?(String) ? host_param(''remote_execution_ssh_keys'')
        : host_param(''remote_execution_ssh_keys'').join(\"\\n\") %>\nEOF\n\n  chmod
        0700 <%= ssh_path %>\n  chmod 0600 <%= ssh_path %>/authorized_keys\n  chown
        -R <%= \"#{ssh_user}:\" %> <%= ssh_path %>\n  chown -R <%= \"#{ssh_user}:\"
        %> <%= \"~#{ssh_user}\" %>\n\n  # Restore SELinux context with restorecon,
        if it''s available:\n  command -v restorecon && restorecon -RvF <%= ssh_path
        %> || true\n\n<% if ssh_user != ''root'' && host_param(''remote_execution_effective_user_method'')
        == ''sudo'' -%>\n<% if @host.operatingsystem.family == ''Redhat'' || @host.operatingsystem.family
        == ''Debian'' -%>\necho \"<%= ssh_user %> ALL = (root) NOPASSWD : ALL\" >
        /etc/sudoers.d/<%= ssh_user %>\necho \"Defaults:<%= ssh_user %> !requiretty\"
        >> /etc/sudoers.d/<%= ssh_user %>\n<% elsif @host.operatingsystem.family ==
        ''Suse'' -%>\necho \"<%= ssh_user %> ALL = (root) NOPASSWD : ALL\" >> /etc/sudoers\necho
        \"Defaults:<%= ssh_user %> !targetpw\" >> /etc/sudoers\n<% end -%>\n<% end
        -%>\nelse\n  echo ''The remote_execution_ssh_user does not exist and remote_execution_create_user
        is not set to true.  remote_execution_ssh_keys snippet will not install keys''\nfi\n<%
        end -%>\n","locked":false,"snippet":true,"description":"SSH keys setup snippet
        for Remote Execution plugin\n\nParameters:\n\nremote_execution_ssh_keys: public
        keys to be put in ~/.ssh/authorized_keys\n\nremote_execution_ssh_user: user
        for which remote_execution_ssh_keys will be\n                           authorized\n\nremote_execution_create_user:
        create user if it not already existing\n\nremote_execution_effective_user_method:
        method to switch from ssh user to\n                                        effective
        user\n\nThis template sets up SSH keys in any host so that as long as your
        public\nSSH key is in remote_execution_ssh_keys, you can SSH into a host.
        This\nworks in combination with Remote Execution plugin by querying smart
        proxies\nto build an array.\n\nTo use this snippet without the plugin provide
        the SSH keys as host parameter\nremote_execution_ssh_keys. It expects the
        same format like the authorized_keys\nfile.","created_at":"2024-06-27 17:28:09
        UTC","updated_at":"2024-07-03 14:59:44 UTC","id":113,"name":"remote_execution_ssh_keys","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '4301'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=11
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/114
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: saltstack_minion\nmodel: ProvisioningTemplate\nsnippet:
        true\ndescription: |\n  Generates a Salt minion configuration file which is
        required for the Salt bootstraping.\n  The Salt master is configured based
        on the host parameter called \"salt_master\".\n  It can also statically assign
        grains based on the \"salt_grains\" host parameter.\n-%>\nmaster: <%= host_param(''salt_master'')
        %>\nlog_level: warning\n\nautosign_grains:\n  - autosign_key\n\n<%#\n# Grains
        (http://docs.saltstack.com/en/latest/topics/targeting/grains.html#grains-in-the-minion-config)\n#\n#
        Possible parameters are:\n#\n# * {''cluster'': ''alpha''}\n# * {''roles'':
        [''webserver'', ''frontend'']}\n#\n-%>\n<% if plugin_present?(''foreman_salt'')
        -%>\ngrains: <%= to_json(@host.derive_salt_grains(use_autosign: true)) %>\n<%
        else -%>\ngrains: <%= host_param(''salt_grains'') ? to_json(host_param(''salt_grains''))
        : ''{}'' %>\n<% end -%>\n","locked":false,"snippet":true,"description":"Generates
        a Salt minion configuration file which is required for the Salt bootstraping.\nThe
        Salt master is configured based on the host parameter called \"salt_master\".\nIt
        can also statically assign grains based on the \"salt_grains\" host parameter.","created_at":"2024-06-27
        17:28:09 UTC","updated_at":"2024-07-03 14:59:44 UTC","id":114,"name":"saltstack_minion","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1767'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=10
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/115
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: saltstack_setup\nmodel: ProvisioningTemplate\nsnippet:
        true\ndescription: this snippet will configure the Saltstack Minion\n-%>\n<%\netc_path
        = (@host.operatingsystem.family == ''Freebsd'') ? ''/usr/local/etc/salt''
        : ''/etc/salt''\nbin_path = (@host.operatingsystem.family == ''Freebsd'')
        ? ''/usr/local/bin'' : ''/usr/bin''\n%>\n\n<% if @host.operatingsystem.family
        == ''Debian'' -%>\napt-get update\napt-get install -y salt-minion\n<% elsif
        @host.operatingsystem.family == ''Freebsd'' -%>\npkg install -y py27-salt\n<%
        elsif @host.operatingsystem.family == ''Redhat'' -%>\nif [ -f /usr/bin/dnf
        ]; then\n  dnf -y install salt-minion\nelse\n  yum -t -y install salt-minion\nfi\n<%
        elsif @host.operatingsystem.family == ''Suse'' -%>\n  /usr/bin/zypper -n install
        salt-minion\n<% end -%>\n\ncat > <%= etc_path %>/minion.d/minion.conf << EOF\n<%=
        snippet ''saltstack_minion'' %>\nEOF\n\necho <%= @host.name %> > <%= etc_path
        %>/minion_id\n\n<% if @host.operatingsystem.family == ''Freebsd'' -%>\necho
        ''salt_minion_enable=\"YES\"'' >>/etc/rc.conf\necho ''salt_minion_paths=\"/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin\"''
        >>/etc/rc.conf\n<% elsif @host.operatingsystem.family == ''Redhat'' -%>\n/sbin/chkconfig
        --level 345 salt-minion on\n<% elsif @host.operatingsystem.family == ''Suse''
        -%>\n/sbin/chkconfig salt-minion on -f\n<% end -%>\n\n<%= bin_path %>/salt-call
        --no-color --grains >/dev/null\n","locked":false,"snippet":true,"description":"this
        snippet will configure the Saltstack Minion","created_at":"2024-06-27 17:28:09
        UTC","updated_at":"2024-07-03 14:59:44 UTC","id":115,"name":"saltstack_setup","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '2056'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=9
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/116
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: schedule_reboot\nmodel: ProvisioningTemplate\nsnippet:
        true\ndescription: |\n  In image based provisioning using finish templates,
        reboot can''t be performed\n  immediatelly, because it would interrupt the
        ongoing SSH connection. Instead\n  this snippet should be used. It schedules
        reboot correctly a minute after,\n  which gives SSH enough time to properly
        disconnect. To active this behavior\n  schedule_reboot host parameter must
        be set to true.\n-%>\n<% if host_param_true?(''schedule_reboot'') -%>\nPATH=/usr/bin:/usr/sbin:/bin:/sbin:$PATH
        shutdown -r +1\n<% end -%>\n","locked":false,"snippet":true,"description":"In
        image based provisioning using finish templates, reboot can''t be performed\nimmediatelly,
        because it would interrupt the ongoing SSH connection. Instead\nthis snippet
        should be used. It schedules reboot correctly a minute after,\nwhich gives
        SSH enough time to properly disconnect. To active this behavior\nschedule_reboot
        host parameter must be set to true.","created_at":"2024-06-27 17:28:09 UTC","updated_at":"2024-07-03
        14:59:44 UTC","id":116,"name":"schedule_reboot","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1555'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=8
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/117
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: subscription_manager_setup\nmodel:
        ProvisioningTemplate\nsnippet: true\ndescription: |\n  This snippet installs
        and configures subscription-manager that is required for host registration.\n  The
        snippet is included in the \"global_registration\" template and in the \"redhat_register\"
        snippet.\n  The latter ensures host registration during the provisioning process.\n-%>\n#
        Select package manager for the OS (sets the $PKG_MANAGER* variables)\nif [
        -z \"$PKG_MANAGER\" ]; then\n<%= indent(2) { snippet ''pkg_manager'' } -%>\nfi\n\n#
        Define the path to rhsm.conf\nRHSM_CFG=/etc/rhsm/rhsm.conf\n\n<% if @subman_setup_scenario
        == ''registration'' -%>\n  # Backup the original rhsm.conf file\n  if [ -f
        $RHSM_CFG ] ; then\n    test -f $RHSM_CFG.bak || cp $RHSM_CFG $RHSM_CFG.bak\n  fi\n<%
        end -%>\n\n<% if plugin_present?(''katello'') -%>\n  # Define the path to
        the Katello server CA certificate\n  KATELLO_SERVER_CA_CERT=/etc/rhsm/ca/katello-server-ca.pem\n\n  #
        If SSL_CA_CERT is not set, create a temporary file for it\n  if [ -z \"$SSL_CA_CERT\"
        ]; then\n    SSL_CA_CERT=$(mktemp)\n    cat << EOF > \"$SSL_CA_CERT\"\n<%=
        foreman_server_ca_cert %>\nEOF\n  fi\n\n  <% if @subman_setup_scenario ==
        ''registration'' -%>\n    # rhn-client-tools conflicts with subscription-manager
        package\n    # since rhn tools replaces subscription-manager, we need to explicitly\n    #
        install subscription-manager after the rhn tools cleanup\n    if [ x$ID =
        xol ]; then\n      $PKG_MANAGER_REMOVE rhn-client-tools\n      $PKG_MANAGER_INSTALL
        --setopt=obsoletes=0 subscription-manager\n    elif [ -f /etc/debian_version
        ]; then\n      $PKG_MANAGER_INSTALL subscription-manager\n    fi\n\n    <%
        if truthy?(@force) -%>\n      # Unregister host and remove all local system
        and subscription data\n      if [ -x \"$(command -v subscription-manager)\"
        ] ; then\n        subscription-manager unregister || true\n        subscription-manager
        clean\n      fi\n\n      if ! [ -f /etc/debian_version ]; then\n        $PKG_MANAGER_REMOVE
        katello-ca-consumer\\* > /dev/null 2>&1\n      fi\n    <% end -%>\n  <% end
        -%>\n\n  # Prepare the SSL certificate\n  mkdir -p /etc/rhsm/ca\n  cp -f $SSL_CA_CERT
        $KATELLO_SERVER_CA_CERT\n  chmod 644 $KATELLO_SERVER_CA_CERT\n<% end -%>\n\n#
        Prepare subscription-manager\nif ! [ -x \"$(command -v subscription-manager)\"
        ] ; then\n  $PKG_MANAGER_INSTALL subscription-manager\nelse\n  echo \"subscription-manager
        is already installed!\"\n  <% if @subman_setup_scenario == ''registration''
        -%>\n    $PKG_MANAGER_UPGRADE subscription-manager > /dev/null 2>&1\n  <%
        end %>\nfi\n\n# Check if rhsm.conf exists\nif ! [ -f $RHSM_CFG ] ; then\n  echo
        \"''$RHSM_CFG'' not found, cannot configure subscription-manager\"\n  <% if
        plugin_present?(''katello'') -%>\n    rm -f $SSL_CA_CERT\n  <% end -%>\n  exit
        1\nfi\n\n<% if @subman_setup_scenario == ''registration''\n     if plugin_present?(''katello'')\n       server_hostname
        = @rhsm_url.host if @rhsm_url\n       server_port = @rhsm_url.port if @rhsm_url\n       server_prefix
        = @rhsm_url.path if @rhsm_url\n       repo_ca_cert = \"$KATELLO_SERVER_CA_CERT\"\n       rhsm_baseurl
        = @pulp_content_url\n     end\n   elsif @subman_setup_scenario == ''provisioning''\n     if
        plugin_present?(''katello'')\n       server_hostname = @host.content_source\n       server_port
        = @host.content_source.rhsm_url.port\n       server_prefix = @host.content_source.rhsm_url.path\n       repo_ca_cert
        = \"$KATELLO_SERVER_CA_CERT\"\n       rhsm_baseurl = @host.content_source.pulp_content_url\n     else\n       server_hostname
        = \"subscription.rhsm.redhat.com\"\n       server_port = \"443\"\n       server_prefix
        = \"/subscription\"\n       repo_ca_cert = \"/etc/rhsm/ca/redhat-uep.pem\"\n       rhsm_baseurl
        = \"https://cdn.redhat.com\"\n     end\n   end\n-%>\n\n# Configure subscription-manager\ntest
        -f $RHSM_CFG.bak || cp $RHSM_CFG $RHSM_CFG.bak\nsubscription-manager config
        \\\n  --server.hostname=\"<%= server_hostname %>\" \\\n  --server.port=\"<%=
        server_port %>\" \\\n  --server.prefix=\"<%= server_prefix %>\" \\\n  --rhsm.repo_ca_cert=\"<%=
        repo_ca_cert %>\" \\\n  --rhsm.baseurl=\"<%= rhsm_baseurl %>\"\n\n# Older
        versions of subscription manager may not recognize\n# report_package_profile
        and package_profile_on_trans options.\n# So set them separately and redirect
        out & error to /dev/null\n# to fail silently.\nsubscription-manager config
        --rhsm.package_profile_on_trans=1 > /dev/null 2>&1 || true\nsubscription-manager
        config --rhsm.report_package_profile=1 > /dev/null 2>&1 || true\n\n# Configuration
        for EL6\nif grep --quiet full_refresh_on_yum $RHSM_CFG; then\n  sed -i \"s/full_refresh_on_yum\\s*=.*$/full_refresh_on_yum
        = 1/g\" $RHSM_CFG\nelse\n  full_refresh_config=\"#config for on-premise management\\nfull_refresh_on_yum
        = 1\"\n  sed -i \"/baseurl/a $full_refresh_config\" $RHSM_CFG\nfi\n\n<% if
        @subman_setup_scenario == ''provisioning'' && plugin_present?(''katello'')
        -%>\n  if [ -f /etc/debian_version ]; then\n    CA_TRUST_ANCHORS=/usr/local/share/ca-certificates/\n  else\n    CA_TRUST_ANCHORS=/etc/pki/ca-trust/source/anchors\n  fi\n\n  #
        Add the Katello CA certificate to the system-wide CA certificate store\n  if
        [ -d $CA_TRUST_ANCHORS ]; then\n    if [ -f /etc/debian_version ]; then\n      cp
        $KATELLO_SERVER_CA_CERT $CA_TRUST_ANCHORS\n      update-ca-certificates\n    else\n      update-ca-trust
        enable\n      cp $KATELLO_SERVER_CA_CERT $CA_TRUST_ANCHORS\n      update-ca-trust\n    fi\n  fi\n<%
        end -%>\n\n# Restart yggdrasild if installed and running\nsystemctl try-restart
        yggdrasil >/dev/null 2>&1 || true\n","locked":false,"snippet":true,"description":"This
        snippet installs and configures subscription-manager that is required for
        host registration.\nThe snippet is included in the \"global_registration\"
        template and in the \"redhat_register\" snippet.\nThe latter ensures host
        registration during the provisioning process.","created_at":"2024-06-27 17:28:09
        UTC","updated_at":"2024-07-03 14:59:44 UTC","id":117,"name":"subscription_manager_setup","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '6468'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=7
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/133
  response:
    body:
      string: '{"template":"<%#\nkind: user_data\nname: UserData default\nmodel: ProvisioningTemplate\noses:\n-
        AlmaLinux\n- CentOS\n- CentOS_Stream\n- Fedora\n- Rocky\n- Debian\n- Ubuntu\ndescription:
        |\n  This template is used during image based provisioning, when the image
        is configured to use user-data.\n  The output is a list of cloud-init directives
        that cloud-init parses to configures the VM\n  booted from the image. The
        image must have cloud-init installed in order for this to work.\n\n  This
        template accepts the following parameters:\n  - ssh_pwauth: boolean (default=true
        unless ssh_authorized_keys)\n  - ssh_authorized_keys: string w newline seperated
        keys (default=\"\")\n  - package_upgrade: boolean (default=false)\n  - reboot:
        boolean (default=false)\n  - skip-puppet-setup: boolean (default=false)\n-%>\n<%\n  ssh_pwauth
        = host_param(''ssh_pwauth'') ? host_param_true?(''ssh_pwauth'') : !host_param(''ssh_authorized_keys'')\n  rhel_compatible
        = @host.operatingsystem.family == ''Redhat'' && @host.operatingsystem.name
        != ''Fedora''\n  # safemode renderer does not support unary negation\n  puppet_enabled
        = !host_param_true?(''skip-puppet-setup'') && (host_puppet_server.present?
        || host_param_true?(''force-puppet''))\n  salt_enabled = host_param(''salt_master'')
        ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy) && @host.chef_proxy\n-%>\n#cloud-config\nhostname:
        <%= @host.shortname %>\nfqdn: <%= @host %>\nmanage_etc_hosts: true\n<% if
        ssh_pwauth -%>\n<%# Don''t enable this in production. It is very insecure!
        Use ssh_authorized_keys instead...\n    http://cloudinit.readthedocs.io/en/latest/topics/examples.html#including-users-and-groups
        -%>\nssh_pwauth: true\ngroups:\n- admin\nusers:\n- default\n- name: admin\n  primary-group:
        admin\n  groups: users\n  shell: /bin/bash\n  sudo: [''ALL=(ALL) ALL'']\n  lock-passwd:
        false\n  passwd: <%= @host.root_pass %>\n<% end -%>\n<% if host_param(''ssh_authorized_keys'')
        -%>\nssh_authorized_keys:\n<% host_param(''ssh_authorized_keys'').split(\"\\n\").each
        do |ssh_key| -%>\n- <%= ssh_key %>\n<% end -%>\n<% end -%>\n\n<% if host_param_true?(''package_upgrade'')
        -%>\npackage_upgrade: true\n<% end -%>\n\nruncmd:\n<% if rhel_compatible -%>\n-
        |\n<%= indent(2) { snippet(''epel'') } %>\n<% end -%>\n- |\n<%= indent(2)
        { snippet(''remote_execution_ssh_keys'') } %>\n<% if chef_enabled -%>\n- |\n<%=
        indent(2) { snippet(''chef_client'') } %>\n<% end -%>\n<% if puppet_enabled
        -%>\n- |\n<%= indent(2) { snippet(''puppetlabs_repo'') } %>\n- |\n<%= indent(2)
        { snippet(''puppet_setup'') } %>\n<% end -%>\n<% if salt_enabled -%>\n- |\n<%=
        indent(2) { snippet(''saltstack_setup'') } %>\n<% end -%>\n\n<%# Contact Foreman
        to confirm instance is built -%>\nphone_home:\n  url: <%= foreman_url(''built'')
        %>\n  post: []\n  tries: 10\n\n<% if host_param_true?(''reboot'') -%>\npower_state:\n  mode:
        reboot\n  timeout: 30\n  condition: true\n<% end -%>\n","locked":false,"snippet":false,"description":"This
        template is used during image based provisioning, when the image is configured
        to use user-data.\nThe output is a list of cloud-init directives that cloud-init
        parses to configures the VM\nbooted from the image. The image must have cloud-init
        installed in order for this to work.\n\nThis template accepts the following
        parameters:\n- ssh_pwauth: boolean (default=true unless ssh_authorized_keys)\n-
        ssh_authorized_keys: string w newline seperated keys (default=\"\")\n- package_upgrade:
        boolean (default=false)\n- reboot: boolean (default=false)\n- skip-puppet-setup:
        boolean (default=false)","created_at":"2024-06-27 17:28:09 UTC","updated_at":"2024-07-03
        14:59:44 UTC","id":133,"name":"UserData default","template_kind_id":10,"template_kind_name":"user_data","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '4057'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=6
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/134
  response:
    body:
      string: '{"template":"<%#\nkind: user_data\nname: UserData open-vm-tools\nmodel:
        ProvisioningTemplate\noses:\n- AlmaLinux\n- CentOS\n- CentOS_Stream\n- Fedora\n-
        Rocky\n- Debian\n- Ubuntu\ndescription: |\n  Template for VMWare customization
        via open-vm-tools during user-data image based provisioning.\n\n  Comparing
        to other user-data templates, e.g. those based on cloud-init, this template
        defines a Customization Specifications that is evaluated by vSphere while
        cloning a VM from a Template. When the Template that should be cloned has
        open-vm-tools installed, this allows to configure certain aspects, e.g. networking
        of the VM, prior boot, so no DHCP configuration is required.\n  Cloud-init
        is typically used for a stage 2 configuration. In order for this to work,
        the VMware\n  template must have open-vm-tools installed.\n  The example below
        is for Linux only, Windows is supported by this mechanism via Sysprep as well,
        though.\n  \n  This needs to he a hash in YAML format with these keys:\n  -
        encryptionKey (array)\n  - globalIPSettings (hash), REQUIRED\n  - identity
        (hash), REQUIRED\n  - nicSettingMap (array)\n  - options (hash)\n  - extraConfig
        (hash)\n  \n  See https://docs.theforeman.org/nightly/Provisioning_Guide/index-foreman-el.html#Provisioning_Virtual_Machines_in_VMware_vSphere-Provisioning_with_cloudinit_and_userdata_templates\n-%>\n\nidentity:\n  LinuxPrep:\n    domain:
        <%= @host.domain %>\n    hostName: <%= @host.shortname %>\n    hwClockUTC:
        true\n    timeZone: <%= host_param(''time-zone'') || ''UTC'' %>\n\nglobalIPSettings:\n  dnsSuffixList:
        [<%= @host.domain %>]\n  <%- @host.interfaces.each do |interface| -%>\n  <%-
        next unless interface.subnet -%>\n  dnsServerList: [<%= interface.subnet.dns_servers.join('',
        '') %>]\n  <%- end -%>\n\nnicSettingMap:\n<%- @host.interfaces.each do |interface|
        -%>\n<%- next unless interface.subnet -%>\n  - adapter:\n      dnsDomain:
        <%= interface.domain %>\n      dnsServerList: [<%= interface.subnet.dns_servers.join('',
        '') %>]\n      gateway: [<%= interface.subnet.gateway %>]\n      ip: <%= interface.ip
        %>\n      subnetMask: <%= interface.subnet.mask %>\n<%- end -%>\n","locked":false,"snippet":false,"description":"Template
        for VMWare customization via open-vm-tools during user-data image based provisioning.\n\nComparing
        to other user-data templates, e.g. those based on cloud-init, this template
        defines a Customization Specifications that is evaluated by vSphere while
        cloning a VM from a Template. When the Template that should be cloned has
        open-vm-tools installed, this allows to configure certain aspects, e.g. networking
        of the VM, prior boot, so no DHCP configuration is required.\nCloud-init is
        typically used for a stage 2 configuration. In order for this to work, the
        VMware\ntemplate must have open-vm-tools installed.\nThe example below is
        for Linux only, Windows is supported by this mechanism via Sysprep as well,
        though.\n\nThis needs to he a hash in YAML format with these keys:\n- encryptionKey
        (array)\n- globalIPSettings (hash), REQUIRED\n- identity (hash), REQUIRED\n-
        nicSettingMap (array)\n- options (hash)\n- extraConfig (hash)\n\nSee https://docs.theforeman.org/nightly/Provisioning_Guide/index-foreman-el.html#Provisioning_Virtual_Machines_in_VMware_vSphere-Provisioning_with_cloudinit_and_userdata_templates","created_at":"2024-06-27
        17:28:09 UTC","updated_at":"2024-07-03 14:59:44 UTC","id":134,"name":"UserData
        open-vm-tools","template_kind_id":10,"template_kind_name":"user_data","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '3849'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=5
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/27
  response:
    body:
      string: '{"template":"<%#\nkind: PXELinux\nname: WAIK default PXELinux\nmodel:
        ProvisioningTemplate\noses:\n- Windows\ndescription: |\n  The template to
        render PXELinux bootloader configuration for Windows.\n  It is used to boot
        the Windows PE that is then used to install Windows.\n  The output is deployed
        on the host''s subnet TFTP proxy.\n-%>\nDEFAULT winPE\n\nLABEL winPE\n    KERNEL
        /Boot/startrom.0\n","locked":false,"snippet":false,"description":"The template
        to render PXELinux bootloader configuration for Windows.\nIt is used to boot
        the Windows PE that is then used to install Windows.\nThe output is deployed
        on the host''s subnet TFTP proxy.","created_at":"2024-06-27 17:28:08 UTC","updated_at":"2024-07-03
        14:59:44 UTC","id":27,"name":"WAIK default PXELinux","template_kind_id":3,"template_kind_name":"PXELinux","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1189'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=4
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/45
  response:
    body:
      string: '{"template":"<%#\nkind: finish\nname: Windows default finish\nmodel:
        ProvisioningTemplate\noses:\n- Windows Server 2008\n- Windows Server 2008
        R2\n- Windows Server 2012\n- Windows Server 2012 R2\n- Windows\ndescription:
        |\n  A finish template executed at the end of Windows provisioning. For more
        information, please\n  see https://community.theforeman.org/t/windows-provisioning-made-easy/16756\n\n  This
        template accepts the following parameters:\n  - windowsLicenseKey: ABCDE-ABCDE-ABCDE-ABCDE-ABCDE
        # Valid Windows license key\n  - windowsLicenseOwner: Company, INC # Legal
        owner of the Windows license key\n  - localAdminAccountDisabled: false\n  -
        ntpServer: time.windows.com,other.time.server\n  - domainAdminAccount: joinuser@domain.com
        # please do not use the domain administrator\n  - domainAdminAccountPasswd:
        Password for the domain Admin account\n  - computerOU: OU=Computers,CN=domain,CN=com
        # Place the computer account in specified Organizational Unit\n  - computerDomain:
        domain.com # domain to join\n  - machinePassword: used for unsecure domain
        join. needs precrated computer object (New-ADComputer)\n  - foremanDebug:
        false\n  - skip-puppet-setup: boolean (default=false)\n\n  Information about
        unsecure domain join\n  https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/add-computer?view=powershell-5.1#example-9--add-a-computer-to-a-domain-using-predefined-computer-credentials\n-%>\n<%\n  #
        safemode renderer does not support unary negation\n  puppet_enabled = !host_param_true?(''skip-puppet-setup'')
        && (host_puppet_server.present? || host_param_true?(''force-puppet''))\n  salt_enabled
        = host_param(''salt_master'') ? true : false\n  chef_enabled = @host.respond_to?(:chef_proxy)
        && @host.chef_proxy\n%>\n\n@echo off\n<% unless host_param(''localAdminAccountDisabled'')
        -%>\n  echo Activating administrator\n  net user administrator /active:yes\n<%
        end -%>\n\n<% if @host.pxe_build? %>\n  set ctr=0\n  set nettimeout=10\n\n  (echo
        Updating time)\n  (sc config w32time start= auto)\n  sc start w32time\n  ::ipconfig
        /renew\n\n  <% if host_param(''ntpServer'') %>\n    echo setting time server\n    w32tm
        /config /manualpeerlist:<%= host_param(''ntpServer'') %> /syncfromflags:manual
        /update\n  <% end %>\n\n  echo sync time\n  w32tm /resync\n  w32tm /resync\n\n  <%
        if host_param(''computerDomain'') -%>\n    <% if host_param(''domainAdminAccount'').present?
        && host_param(''domainAdminAccountPasswd'').present? -%>\n      echo performing
        secure domain join\n      powershell.exe -OutputFormat text -command Add-Computer
        -DomainName ''<%= host_param(''computerDomain'') -%>'' -Credential (New-Object
        -TypeName System.Management.Automation.PSCredential ''<%= host_param(''domainAdminAccount'')
        -%>'', (ConvertTo-SecureString -String ''<%= host_param(''domainAdminAccountPasswd'')
        -%>'' -AsPlainText -Force)) <% if host_param(''computerOU'').present? -%>-OUPath
        ''<%= host_param(''computerOU'') -%>''<% end -%>\n    <% else %>\n      <%
        if host_param(''machinePassword'').present? %>\n        echo performing unsecure
        domain join\n        powershell.exe -OutputFormat text -command Add-Computer
        -Domain ''<%= host_param(''computerDomain'') -%>'' -Options UnsecuredJoin,PasswordPass
        -Credential (New-Object -TypeName System.Management.Automation.PSCredential
        $null, (ConvertTo-SecureString -String ''<%= host_param(''machinePassword'')
        -%>'' -AsPlainText -Force))\n      <% end %>\n    <% end %>\n  <% end %>\n\n  <%
        if host_param(''localAdminAccountDisabled'') %>\n    echo Disabling %tempAdminUser%\n    net
        user %tempAdminUser% %tempAdminUser% /active:no\n  <% end %>\n\n  <% if host_param(''ansible_port'')
        == 5985 or host_param(''ansible_winrm_scheme'') == ''http'' %>\n    cmd /c
        winrm set winrm/config/service @{AllowUnencrypted=\"true\"}\n  <% end %>\n\n  <%
        if host_param(''ansible_winrm_transport'') == ''basic'' %>\n    cmd /c winrm
        set winrm/config/client/auth @{Basic=\"true\"}\n    cmd /c winrm set winrm/config/service/auth
        @{Basic=\"true\"}\n  <% end %>\n\n  <% if host_param(''ansible_winrm_transport'')
        == ''credssp'' %>\n    cmd /c winrm set winrm/config/client/auth @{CredSSP=\"true\"}\n    cmd
        /c winrm set winrm/config/service/auth @{CredSSP=\"true\"}\n  <% end %>\n\n  <%
        if host_param(''ansible_winrm_transport'') == ''certificate'' %>\n    cmd
        /c winrm set winrm/config/client/auth @{Certificate=\"true\"}\n    cmd /c
        winrm set winrm/config/service/auth @{Certificate=\"true\"}\n  <% end %>\n\n  <%=
        snippet ''Windows network'' %>\n\n  <% if foreman_url(''user_data'') %>\n    echo
        execute user data script\n    IF EXIST c:\\deploy\\user_data.ps1 powershell.exe
        -OutputFormat text -command c:\\deploy\\user_data.ps1\n  <% end -%>\n\n  <%
        if puppet_enabled %>\n    echo Installing puppet\n    start /w \"\" msiexec
        /qn /i C:\\extras\\puppet.msi PUPPET_AGENT_STARTUP_MODE=Manual PUPPET_MASTER_SERVER=<%=
        host_puppet_server -%> PUPPET_AGENT_ACCOUNT_DOMAIN=<%= @host.domain -%> PUPPET_AGENT_ACCOUNT_USER=administrator
        PUPPET_AGENT_ACCOUNT_PASSWORD=\"<%= host_param(''domainAdminAccountPasswd'')
        -%>\"\n    echo set puppet to auto start\n    sc config puppet start= auto\n    sc
        query puppet\n  <% end%>\n\n  <% if host_param(''foremanDebug'') != true %>\n\n    echo
        reboot in 15sec\n    start /b shutdown /r /t 15\n\n    echo Safely remove
        wimaging files\n    sdelete.exe -accepteula -p 2 -r c:\\wimaging\n    sdelete.exe
        -accepteula -p 2 -r c:\\minint\n    sdelete.exe -accepteula -p 2 c:\\Windows\\Panther\\unattend.xml\n    sdelete.exe
        -accepteula -p 2 C:\\Windows\\Setup\\Scripts\\SetupComplete.cmd\n\n    echo
        Safely remove leftover directories\n    sdelete.exe -accepteula -p 2 -r c:\\drivers\n    sdelete.exe
        -accepteula -p 2 -r c:\\updates\n\n    echo Safely removing c:\\deploy\n    cd
        /\n    sdelete.exe -accepteula -p 2 -r c:\\deploy\n  <% end -%>\n<% end -%>\n","locked":false,"snippet":false,"description":"A
        finish template executed at the end of Windows provisioning. For more information,
        please\nsee https://community.theforeman.org/t/windows-provisioning-made-easy/16756\n\nThis
        template accepts the following parameters:\n- windowsLicenseKey: ABCDE-ABCDE-ABCDE-ABCDE-ABCDE
        # Valid Windows license key\n- windowsLicenseOwner: Company, INC # Legal owner
        of the Windows license key\n- localAdminAccountDisabled: false\n- ntpServer:
        time.windows.com,other.time.server\n- domainAdminAccount: joinuser@domain.com
        # please do not use the domain administrator\n- domainAdminAccountPasswd:
        Password for the domain Admin account\n- computerOU: OU=Computers,CN=domain,CN=com
        # Place the computer account in specified Organizational Unit\n- computerDomain:
        domain.com # domain to join\n- machinePassword: used for unsecure domain join.
        needs precrated computer object (New-ADComputer)\n- foremanDebug: false\n-
        skip-puppet-setup: boolean (default=false)\n\nInformation about unsecure domain
        join\nhttps://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/add-computer?view=powershell-5.1#example-9--add-a-computer-to-a-domain-using-predefined-computer-credentials","created_at":"2024-06-27
        17:28:08 UTC","updated_at":"2024-07-03 14:59:44 UTC","id":45,"name":"Windows
        default finish","template_kind_id":8,"template_kind_name":"finish","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '7539'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=3
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/55
  response:
    body:
      string: '{"template":"<%#\nkind: iPXE\nname: Windows default iPXE\nmodel: ProvisioningTemplate\noses:\n-
        Windows\ndescription: |\n  The template to render iPXE installation script
        for Windows\n  The output is deployed on the host''s subnet TFTP proxy.\n  See
        https://ipxe.org/scripting for more details\n-%>\n#!ipxe\n\necho Trying to
        ping Gateway: ${netX/gateway}\nping --count 1 ${netX/gateway} || echo Ping
        to Gateway failed or ping command not available.\necho Trying to ping DNS:
        ${netX/dns}\nping --count 1 ${netX/dns} || echo Ping to DNS failed or ping
        command not available.\n\nset boot-url tftp://<%= foreman_request_addr %>/\nkernel
        ${boot-url}<%= @host.operatingsystem.bootfile(medium_provider,:kernel) %>\n\ninitrd
        <%= foreman_url(''script'') %> peSetup.cmd\n\ninitrd ${boot-url}<%= @host.operatingsystem.bootfile(medium_provider,:bcd)
        %> BCD\ninitrd ${boot-url}<%= @host.operatingsystem.bootfile(medium_provider,:bootsdi)
        %> boot.sdi\ninitrd ${boot-url}<%= @host.operatingsystem.bootfile(medium_provider,:bootwim)
        %> boot.wim\n\nboot\n","locked":false,"snippet":false,"description":"The template
        to render iPXE installation script for Windows\nThe output is deployed on
        the host''s subnet TFTP proxy.\nSee https://ipxe.org/scripting for more details","created_at":"2024-06-27
        17:28:08 UTC","updated_at":"2024-07-03 14:59:44 UTC","id":55,"name":"Windows
        default iPXE","template_kind_id":6,"template_kind_name":"iPXE","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1788'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=2
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/56
  response:
    body:
      string: '{"template":"<%#\nkind: iPXE\nname: Windows default iPXE httpboot\nmodel:
        ProvisioningTemplate\noses:\n- Windows\ndescription: |\n  The template to
        render iPXE installation script for Windows\n  The output is deployed on the
        host''s subnet TFTP proxy.\n  See https://ipxe.org/scripting for more details\n-%>\n#!ipxe\n\nset
        boot-url http://<%= foreman_request_addr %>/httpboot/\nkernel ${boot-url}<%=
        @host.operatingsystem.bootfile(medium_provider,:kernel) %>\n\ninitrd <%= foreman_url(''script'')
        %> peSetup.cmd\n\ninitrd ${boot-url}<%= @host.operatingsystem.bootfile(medium_provider,:bcd)
        %> BCD\ninitrd ${boot-url}<%= @host.operatingsystem.bootfile(medium_provider,:bootsdi)
        %> boot.sdi\ninitrd ${boot-url}<%= @host.operatingsystem.bootfile(medium_provider,:bootwim)
        %> boot.wim\n\nboot\n","locked":false,"snippet":false,"description":"The template
        to render iPXE installation script for Windows\nThe output is deployed on
        the host''s subnet TFTP proxy.\nSee https://ipxe.org/scripting for more details","created_at":"2024-06-27
        17:28:08 UTC","updated_at":"2024-07-03 14:59:44 UTC","id":56,"name":"Windows
        default iPXE httpboot","template_kind_id":6,"template_kind_name":"iPXE","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1549'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=1
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/68
  response:
    body:
      string: '{"template":"<%#\nkind: provision\nname: Windows default provision\nmodel:
        ProvisioningTemplate\noses:\n- Windows\ndescription: |\n  A templated answers.xml
        file for windows installations. This provides all answers to the questions
        an interactive installation would ask.\n  It supports the following parameters:\n  -
        windowsLicenseKey: ABCDE-ABCDE-ABCDE-ABCDE-ABCDE # Valid Windows license key\n  -
        windowsLicenseOwner: Company, INC # Legal owner of the Windows license key\n  -
        systemLocale: en-US\n  - systemUILanguage: en-US\n  - systemTimeZone: GMT
        Standard Time #see https://msdn.microsoft.com/en-us/library/ms912391(v=winembedded.11).aspx\n  -
        wimImageName = Windows 8.1 Pro # Image name seems only necessary if the WIM
        contains more than one image\n-%>\n<%\n  system_locale = host_param(''systemLocale'')
        ? host_param(''systemLocale'') : ''en-US''\n  system_ui_lang = host_param(''systemUILanguage'')
        ? host_param(''systemUILanguage'') : ''en-US''\n  setup_ui_lang = ''en-US''\n  system_timezone
        = host_param(''systemTimeZone'') ? host_param(''systemTimeZone'') : ''GMT
        Standard Time''\n-%>\n<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<unattend
        xmlns=\"urn:schemas-microsoft-com:unattend\">\n    <servicing></servicing>\n    <settings
        pass=\"offlineServicing\">\n        <component name=\"Microsoft-Windows-LUA-Settings\"
        processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\"
        versionScope=\"nonSxS\" xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\"
        xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n            <EnableLUA>false</EnableLUA>\n        </component>\n    </settings>\n    <settings
        pass=\"windowsPE\">\n        <component name=\"Microsoft-Windows-Setup\" processorArchitecture=\"amd64\"
        publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\"
        xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n            <EnableFirewall><%=
        host_param(''EnableFirewall'') || ''true'' %></EnableFirewall>\n            <EnableNetwork>true</EnableNetwork>\n            <Restart>Restart</Restart>\n            <ImageInstall>\n                <OSImage>\n                    <InstallFrom>\n                        <MetaData
        wcm:action=\"add\">\n                                <Value><%= host_param(''wimImageName'')
        -%></Value>\n                        </MetaData>\n                    </InstallFrom>\n                    <InstallToAvailablePartition>true</InstallToAvailablePartition>\n                    <WillShowUI>OnError</WillShowUI>\n                </OSImage>\n            </ImageInstall>\n            <UserData>\n                <AcceptEula>true</AcceptEula>\n            </UserData>\n        </component>\n        <component
        name=\"Microsoft-Windows-International-Core-WinPE\" processorArchitecture=\"amd64\"
        publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\"
        xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n            <SetupUILanguage>\n                <UILanguage><%=
        setup_ui_lang %></UILanguage>\n            </SetupUILanguage>\n              <InputLocale><%=
        system_locale %></InputLocale>\n              <SystemLocale><%= system_locale
        %></SystemLocale>\n              <UILanguageFallback><%= setup_ui_lang %></UILanguageFallback>\n              <UILanguage><%=
        system_ui_lang %></UILanguage>\n              <UserLocale><%= system_locale
        %></UserLocale>\n        </component>\n    </settings>\n    <settings pass=\"oobeSystem\">\n        <component
        name=\"Microsoft-Windows-International-Core\" processorArchitecture=\"amd64\"
        publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\"
        xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n              <InputLocale><%=
        system_locale %></InputLocale>\n              <SystemLocale><%= system_locale
        %></SystemLocale>\n              <UILanguageFallback><%= setup_ui_lang %></UILanguageFallback>\n              <UILanguage><%=
        system_ui_lang %></UILanguage>\n              <UserLocale><%= system_locale
        %></UserLocale>\n        </component>\n        <component name=\"Microsoft-Windows-Shell-Setup\"
        processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\"
        versionScope=\"nonSxS\" xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\"
        xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n            <UserAccounts>\n                <AdministratorPassword>\n                    <PlainText>false</PlainText>\n                    <Value><%=
        root_pass %></Value>\n                </AdministratorPassword>\n            </UserAccounts>\n            <TimeZone><%=
        system_timezone -%></TimeZone>\n            <% if host_param(''windowsLicenseOwner'')
        -%>\n              <RegisteredOrganization><%= host_param(''windowsLicenseOwner'')
        -%></RegisteredOrganization>\n              <RegisteredOwner><%= host_param(''windowsLicenseOwner'')
        -%></RegisteredOwner>\n            <% end -%>\n            <OOBE>\n                <HideEULAPage>true</HideEULAPage>\n                <NetworkLocation>Work</NetworkLocation>\n                <ProtectYourPC>1</ProtectYourPC>\n                <SkipUserOOBE>true</SkipUserOOBE>\n                <SkipMachineOOBE>true</SkipMachineOOBE>\n                <HideLocalAccountScreen>true</HideLocalAccountScreen>\n                <HideOEMRegistrationScreen>true</HideOEMRegistrationScreen>\n                <HideOnlineAccountScreens>true</HideOnlineAccountScreens>\n                <HideWirelessSetupInOOBE>true</HideWirelessSetupInOOBE>\n            </OOBE>\n            <ShowWindowsLive>false</ShowWindowsLive>\n            <%
        if host_param(''windowsLicenseKey'') -%>\n              <ProductKey><%= host_param(''windowsLicenseKey'').to_s
        -%></ProductKey>\n            <% end -%>\n        </component>\n    </settings>\n    <settings
        pass=\"specialize\">\n        <component name=\"Microsoft-Windows-International-Core\"
        processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\"
        versionScope=\"nonSxS\" xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\"
        xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n              <InputLocale><%=
        system_locale %></InputLocale>\n              <SystemLocale><%= system_locale
        %></SystemLocale>\n              <UILanguageFallback><%= setup_ui_lang %></UILanguageFallback>\n              <UILanguage><%=
        system_ui_lang %></UILanguage>\n              <UserLocale><%= system_locale
        %></UserLocale>\n        </component>\n        <component name=\"Microsoft-Windows-IE-ESC\"
        processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\"
        versionScope=\"nonSxS\" xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\"
        xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n            <IEHardenAdmin>false</IEHardenAdmin>\n        </component>\n        <component
        name=\"Microsoft-Windows-Shell-Setup\" processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\"
        language=\"neutral\" versionScope=\"nonSxS\" xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\"
        xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n            <ComputerName><%=
        @host.shortname -%></ComputerName>\n            <% if host_param(''windowsLicenseOwner'')
        -%>\n              <RegisteredOrganization><%= host_param(''windowsLicenseOwner'')
        -%></RegisteredOrganization>\n              <RegisteredOwner><%= host_param(''windowsLicenseOwner'')
        -%></RegisteredOwner>\n            <% end -%>\n              <TimeZone><%=
        system_timezone -%></TimeZone>\n        </component>\n        <component name=\"Networking-MPSSVC-Svc\"
        processorArchitecture=\"amd64\" publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\"
        versionScope=\"nonSxS\" xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\"
        xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n            <DomainProfile_EnableFirewall><%=
        host_param(''EnableFirewall'') || ''true'' %></DomainProfile_EnableFirewall>\n            <PrivateProfile_EnableFirewall><%=
        host_param(''EnableFirewall'') || ''true'' %></PrivateProfile_EnableFirewall>\n            <PublicProfile_EnableFirewall><%=
        host_param(''EnableFirewall'') || ''true'' %></PublicProfile_EnableFirewall>\n        </component>\n        <component
        name=\"Microsoft-Windows-ServerManager-SvrMgrNc\" processorArchitecture=\"amd64\"
        publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\"
        xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n            <DoNotOpenServerManagerAtLogon>true</DoNotOpenServerManagerAtLogon>\n        </component>\n        <component
        name=\"Microsoft-Windows-TerminalServices-LocalSessionManager\" processorArchitecture=\"amd64\"
        publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\"
        xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n            <fDenyTSConnections>false</fDenyTSConnections>\n        </component>\n        <component
        name=\"Microsoft-Windows-TerminalServices-RDP-WinStationExtensions\" processorArchitecture=\"amd64\"
        publicKeyToken=\"31bf3856ad364e35\" language=\"neutral\" versionScope=\"nonSxS\"
        xmlns:wcm=\"http://schemas.microsoft.com/WMIConfig/2002/State\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n            <SecurityLayer>1</SecurityLayer>\n            <UserAuthentication>0</UserAuthentication>\n        </component>\n    </settings>\n    <cpi:offlineImage
        cpi:source=\"catalog:c:/deploy/wimaging/sources/win81x64/sources/install_windows
        8.1 pro.clg\" xmlns:cpi=\"urn:schemas-microsoft-com:cpi\" />\n</unattend>\n","locked":false,"snippet":false,"description":"A
        templated answers.xml file for windows installations. This provides all answers
        to the questions an interactive installation would ask.\nIt supports the following
        parameters:\n- windowsLicenseKey: ABCDE-ABCDE-ABCDE-ABCDE-ABCDE # Valid Windows
        license key\n- windowsLicenseOwner: Company, INC # Legal owner of the Windows
        license key\n- systemLocale: en-US\n- systemUILanguage: en-US\n- systemTimeZone:
        GMT Standard Time #see https://msdn.microsoft.com/en-us/library/ms912391(v=winembedded.11).aspx\n-
        wimImageName = Windows 8.1 Pro # Image name seems only necessary if the WIM
        contains more than one image","created_at":"2024-06-27 17:28:08 UTC","updated_at":"2024-07-03
        14:59:45 UTC","id":68,"name":"Windows default provision","template_kind_id":7,"template_kind_name":"provision","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - close
      Content-Length:
      - '11051'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/28
  response:
    body:
      string: '{"template":"<%#\nkind: PXELinux\nname: Windows default PXELinux\nmodel:
        ProvisioningTemplate\noses:\n- Windows\ndescription: |\n  A template to render
        a PXELinux configuration for Windows installations.\n  It injects the actual
        installation script from Foreman to give a highly customizable installation.\n  Note
        that this does rely on HTTP support inside your PXE environment. If this is
        not supported, please chain this using iPXE instead.\n  After this has been
        injected, it starts wimboot which in turn starts the actual WinPE image\n-%>\nDEFAULT
        menu\nLABEL menu\n     COM32 linux.c32 <%= @host.operatingsystem.bootfile(medium_provider,:kernel)
        %>\n     APPEND initrdfile=<%= foreman_url(''script'') %>@peSetup.cmd,<%=
        @host.operatingsystem.bootfile(medium_provider,:bcd) %>,<%= @host.operatingsystem.bootfile(medium_provider,:bootsdi)
        %>,<%= @host.operatingsystem.bootfile(medium_provider,:bootwim) %>\n","locked":false,"snippet":false,"description":"A
        template to render a PXELinux configuration for Windows installations.\nIt
        injects the actual installation script from Foreman to give a highly customizable
        installation.\nNote that this does rely on HTTP support inside your PXE environment.
        If this is not supported, please chain this using iPXE instead.\nAfter this
        has been injected, it starts wimboot which in turn starts the actual WinPE
        image","created_at":"2024-06-27 17:28:08 UTC","updated_at":"2024-07-03 14:59:45
        UTC","id":28,"name":"Windows default PXELinux","template_kind_id":3,"template_kind_name":"PXELinux","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1904'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=100
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/135
  response:
    body:
      string: '{"template":"<%#\nkind: user_data\nname: Windows default user data\nmodel:
        ProvisioningTemplate\noses:\n- Windows Server 2016\n- Windows Server 2019\n-
        Windows 10 Pro\n-%>\n<%-\n  pm_set = @host.puppet_server.present?\n  puppet_enabled
        = pm_set || host_param_true?(''force-puppet'')\n  network_location = host_param(''networklocation'')
        ? host_param(''networklocation'') : ''private''\n  powershell = ''%SystemRoot%\\\\\\\\System32\\\\\\\\WindowsPowerShell\\\\\\\\v1.0\\\\\\\\powershell.exe
        -ExecutionPolicy Unrestricted -NoLogo -NoProfile''\n-%>\n---\nidentity:\n  Sysprep:\n    guiRunOnce:\n      commandList:\n        -
        \"<%= powershell %> -NonInteractive -Command \\\"invoke-webrequest -Uri <%=
        foreman_url(\"built\") %>\\\"\"\n        <% if host_param(''remote_desktop'')
        %>\n        - \"<%= powershell %> -NonInteractive -Command \\\"netsh advfirewall
        firewall set rule group=\\\"remote desktop\\\" new enable=Yes\\\"\"\n        -
        \"<%= powershell %> -NonInteractive -Command \\\"netsh advfirewall firewall
        set rule group=\\\"remotedesktop\\\" new enable=Yes\\\"\"\n        <% end
        %>\n        <% if host_param(''ping'') %>\n        - \"<%= powershell %> -NonInteractive
        -Command \\\"netsh advfirewall firewall add rule name=\\\"Enable IPv4 ICMP\\\"
        dir=in protocol=icmpv4 action=allow\\\"\"\n        <% end %>\n        <% if
        host_param(''ansible_port'') == 5985 or host_param(''ansible_winrm_scheme'')
        == ''http'' or host_param(''ansible_winrm_transport'') == ''basic'' or host_param(''ansible_winrm_transport'')
        == ''credssp'' or host_param(''ansible_winrm_transport'') == ''certificate''
        %>\n        - \"<%= powershell %> -NonInteractive -Command \\\"Set-NetConnectionProfile
        -InterfaceAlias Ethernet0 -NetworkCategory \\\"<%= network_location %>\\\"\\\"\"\n        -
        \"<%= powershell %> -NonInteractive -Command \\\"Enable-PSRemoting\\\"\"\n        <%
        end %>\n        <% if host_param(''ansible_port'') == 5985 or host_param(''ansible_winrm_scheme'')
        == ''http'' %>\n        - \"<%= powershell %> -NonInteractive -Command \\\"netsh
        advfirewall firewall add rule name=\\\\\\\"WinRM-HTTP\\\\\\\" dir=in localport=5985
        protocol=TCP action=allow\\\"\"\n        - \"<%= powershell %> -NonInteractive
        -Command \\\"winrm set winrm/config/service ''@{AllowUnencrypted=\\\\\\\"true\\\\\\\"}''\\\"\"\n        <%
        end %>\n        <% if host_param(''ansible_winrm_transport'') == ''basic''
        %>\n        - \"<%= powershell %> -NonInteractive -Command \\\"winrm set winrm/config/client/auth
        ''@{Basic=\\\\\\\"true\\\\\\\"}''\\\"\"\n        - \"<%= powershell %> -NonInteractive
        -Command \\\"winrm set winrm/config/service/auth ''@{Basic=\\\\\\\"true\\\\\\\"}''\\\"\"\n        <%
        end %>\n        <% if host_param(''ansible_winrm_transport'') == ''credssp''
        %>\n        - \"<%= powershell %> -NonInteractive -Command \\\"winrm set winrm/config/client/auth
        ''@{CredSSP=\\\\\\\"true\\\\\\\"}''\\\"\"\n        - \"<%= powershell %> -NonInteractive
        -Command \\\"winrm set winrm/config/service/auth ''@{CredSSP=\\\\\\\"true\\\\\\\"}''\\\"\"\n        <%
        end %>\n        <% if host_param(''ansible_winrm_transport'') == ''certificate''
        %>\n        - \"<%= powershell %> -NonInteractive -Command \\\"winrm set winrm/config/client/auth
        ''@{Certificate=\\\\\\\"true\\\\\\\"}''\\\"\"\n        - \"<%= powershell
        %> -NonInteractive -Command \\\"winrm set winrm/config/service/auth ''@{Certificate=\\\\\\\"true\\\\\\\"}''\\\"\"\n        <%
        end %>\n        <% if puppet_enabled %>\n        - \"<%= powershell %> -Command
        \\\"invoke-webrequest -Uri <%= host_param(''win_puppet_source'') %> -OutFile
        C:\\\\puppet-agent-x64-latest.msi\\\"\"\n        - \"<%= powershell %> -Command
        \\\"md C:\\\\ProgramData\\\\PuppetLabs\\\\puppet\\\\etc\\\"\"\n        - \"<%=
        powershell %> -Command \\\"echo \\\"[main]\\\" | out-file C:\\\\ProgramData\\\\PuppetLabs\\\\puppet\\\\etc\\\\puppet.conf
        -encoding utf8\\\"\"\n        - \"<%= powershell %> -Command \\\"echo \\\"server=http://<%=
        foreman_server_fqdn %>:8000/unattended/built?token=cae2cc74-1394-4acb-ad16-1011020b9bbe\\\"
        | add-content C:\\\\ProgramData\\\\PuppetLabs\\\\puppet\\\\etc\\\\puppet.conf
        -encoding utf8\\\"\"\n        - \"<%= powershell %> -Command \\\"echo \\\"autoflush=true\\\"
        | add-content C:\\\\ProgramData\\\\PuppetLabs\\\\puppet\\\\etc\\\\puppet.conf
        -encoding utf8\\\"\"\n        - \"<%= powershell %> -Command \\\"start /wait
        \\\"\\\" msiexec /qn /norestart /i C:\\\\puppet-agent-x64-latest.msi PUPPET_MASTER_SERVER=<%=
        @host.puppet_server %>\\\"\"\n        - \"<%= powershell %> -Command \\\"sdelete.exe
        -accepteula -p 2 C:\\\\puppet-agent-x64-latest.msi\\\"\"\n        <% end %>\n    guiUnattended:\n      autoLogon:
        true\n      autoLogonCount: 1\n      password:\n        plainText: true\n        value:
        <%= host_param(''win_password'') %>\n      timeZone: 110\n    identification:\n      joinWorkgroup:
        ''WORKGROUP''\n    licenseFilePrintData:\n      autoMode: ''perSeat''\n    userData:\n      computerName:
        <%= @host.shortname %>\n      fullName: ''IT''\n      orgName: <%= @host.organization
        %>\n      productId: \"<%= host_param(''windowsLicenseKey'').to_s %>\"\nnicSettingMap:\n  -
        adapter:\n      dnsDomain: <%= @host.domain %>\n      dnsServerList:\n        -
        <%= @host.subnet.dns_primary %>\n      gateway:\n        - <%= @host.subnet.gateway
        %>\n      ip: <%= @host.ip %>\n      subnetMask: <%= @host.subnet.mask %>\nglobalIPSettings:\n  dnsServerList:\n    -
        <%= @host.subnet.dns_primary %>\n  dnsSuffixList:\n    - <%= @host.domain
        %>\noptions:\n  changeSID: true\n  deleteAccounts: false\n","locked":false,"snippet":false,"description":null,"created_at":"2024-06-27
        17:28:09 UTC","updated_at":"2024-07-03 14:59:45 UTC","id":135,"name":"Windows
        default user data","template_kind_id":10,"template_kind_name":"user_data","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '6071'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=99
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/118
  response:
    body:
      string: '{"template":"<%#\nname: Windows network\nmodel: ProvisioningTemplate\nsnippet:
        true\nkind: snippet\ndescription: |\n  Configures networking using netsh command
        on Windows hosts.\n-%>\n@echo off\nsetlocal enableDelayedExpansion\n\nfor
        /f \"delims=\" %%a in (''ipconfig /all'') do (\n    set line=%%a\n    if not
        \"!line:~0,1!\"==\" \" if not \"!line:adapter=!\"==\"!line!\" (\n        set
        name=!line:*adapter =!\n        set name=!name::=!\n    )\n\n    for /f \"tokens=1,2,*\"
        %%b in (\"%%a\") do (\n        if \"%%b %%c\"==\"Physical Address.\" (\n            set
        mac=%%d\n            set mac=!mac:*: =!\n            set mac=!mac:-=:!\n            call
        :tolower mac\n\n<% @host.managed_interfaces.each do |interface| -%>\n            if
        \"<%= interface.mac %>\"==\"!mac!\" (\n                <% if !interface.identifier.empty?
        %>\n                    netsh interface set interface name=\"!name!\" newname=\"<%=
        interface.identifier %>\"\n                    <% if (interface.subnet.nil?
        ? false : !interface.subnet.dhcp_boot_mode?) %>\n                    netsh
        interface ip set address \"<%= interface.identifier %>\" static <%= interface.ip
        %> <%= interface.subnet.mask %> <%= interface.subnet.gateway %>\n                        <%
        if (interface.subnet.nil? ? false : interface.subnet.dns_primary.present?)
        %>\n                        netsh interface ip add dnsserver \"<%= interface.identifier
        %>\" address=\"<%= interface.subnet.dns_primary %>\" index=1\n                        <%
        end %>\n                        <% if (interface.subnet.nil? ? false : interface.subnet.dns_secondary.present?)
        %>\n                        netsh interface ip add dnsserver \"<%= interface.identifier
        %>\" address=\"<%= interface.subnet.dns_secondary %>\" index=2\n                        <%
        end %>\n                    <% end %>\n                    <% if interface.subnet6
        %>\n                    netsh interface ipv6 add address \"<%= interface.identifier
        %>\" <%= interface.ip6 %>/<%= interface.subnet6.cidr %>\n                    <%
        if interface.subnet6.gateway %>\n                    netsh interface ipv6
        add route ::/0 \"<%= interface.identifier %>\" <%= interface.subnet6.gateway
        %>\n                    <% end %>\n                    <% end %>\n                <%
        else %>\n                    <% if !(interface.subnet.nil? ? false : interface.subnet.dhcp_boot_mode?)
        %>\n                    netsh interface ip set address \"!name!\" static <%=
        interface.ip %> <%= interface.subnet.mask %> <%= interface.subnet.gateway
        %>\n                        <% if (interface.subnet.nil? ? false : interface.subnet.dns_primary.present?)
        %>\n                        netsh interface ip add dnsserver \"!name!\" address=\"<%=
        interface.subnet.dns_primary %>\" index=1\n                        <% end
        %>\n                        <% if (interface.subnet.nil? ? false : interface.subnet.dns_secondary.present?)
        %>\n                        netsh interface ip add dnsserver \"!name!\" address=\"<%=
        interface.subnet.dns_secondary %>\" index=2\n                        <% end
        %>\n                    <% end %>\n                    <% if interface.subnet6
        %>\n                    netsh interface ipv6 add address \"!name!\" <%= interface.ip6
        %>/<%= interface.subnet6.cidr %>\n                    <% if interface.subnet6.gateway
        %>\n                    netsh interface ipv6 add route ::/0 \"!name!\" <%=
        interface.subnet6.gateway %>\n                    <% end %>\n                    <%
        end %>\n                <% end %>\n            )\n<% end -%>\n        )\n    )\n)\ncall
        :done\n\n:tolower\nfor %%L IN (a b c d e f g h i j k l m n o p q r s t u v
        w x y z) DO SET %1=!%1:%%L=%%L!\ngoto :EOF\n\n:done\n","locked":false,"snippet":true,"description":"Configures
        networking using netsh command on Windows hosts.","created_at":"2024-06-27
        17:28:09 UTC","updated_at":"2024-07-03 14:59:45 UTC","id":118,"name":"Windows
        network","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '4319'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=98
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/73
  response:
    body:
      string: '{"template":"<%#\nkind: script\nname: Windows peSetup.cmd\nmodel: ProvisioningTemplate\noses:\n-
        Windows\ndescription: |\n  The provisioning template used for Windows\n  You
        can create and assign a \"user_data\" ProvisioningTemplate as powershell to
        execute some custom code\n  See https://community.theforeman.org/t/windows-provisioning-made-easy/16756/\n  params:\n  -
        wimImageName: Windows 8.1 Pro # name of wim image to apply\n-%>\n<%\n  proxy_uri
        = host_param(''http-proxy'') ? \"http://#{host_param(''http-proxy'')}:#{host_param(''http-proxy-port'')
        || 3128}\" : nil\n  proxy_string = proxy_uri ? \"-e http_proxy=#{proxy_uri}\"
        : ''''\n%>\n@setlocal enableextensions enabledelayedexpansion\n@echo off\nset
        WGET=wget64.exe\n\n<%= @host.diskLayout %>\n\necho Started downloading main
        WIM\n\n%WGET% <%= proxy_string %> \"<%= medium_uri %>/sources/images.ini\"
        -O X:\\images.ini\nif %ERRORLEVEL% == 0 goto :lookup_image\n\necho WARNING:
        Couldn''t download the images.ini, falling back to legacy mode!\n%WGET% <%=
        proxy_string %> \"<%= medium_uri %>/sources/install.wim\" -O C:\\install.wim\ngoto
        :install\n\n:lookup_image\nset file=X:\\images.ini\nset key=<%= host_param(''wimImageName'')
        %>\nfor /f \"usebackq delims=\" %%a in (\"!file!\") do (\n\tset ln=%%a\n        for
        /f \"tokens=1,2 delims==\" %%b in (\"!ln!\") do (\n            set currkey=%%b\n            set
        currval=%%c\n            if \"x!key!\"==\"x!currkey!\" (\n                %WGET%
        <%= proxy_string %> \"<%= medium_uri %>/sources/!currval!\" -O C:\\install.wim\n            )\n        )\n    )\n)\n\n:install\necho
        Writing install image to partition while downloading additional files\n\n(\n   start
        /min cmd /C \"echo Write the install image to the partition\n                dism.exe
        /apply-image /imagefile:C:\\install.wim /Name:\"<%= host_param(''wimImageName'')
        %>\" /ApplyDir:C:\\\n                echo removing install.wim\n                del
        /q /s C:\\install.wim\"\n   start /min cmd /C \"echo Downloading the drivers\n                md
        c:\\drivers\n                %WGET% <%= proxy_string %> -P c:\\drivers -r
        -np -nH --cut-dirs=3 -R index.html -q --level=0 <%= medium_uri %>/drivers/\"\n   start
        /min cmd /C \"echo Downloading additional updates\n                md c:\\updates\n                %WGET%
        <%= proxy_string %> -P c:\\updates\\ -r -np -nH --cut-dirs=3 -R index.html
        -q --level=0 <%= medium_uri %>/updates/\"\n   start /min cmd /C \"echo Downloading
        finsh script and activating SetupComplete.cmd\n                md c:\\deploy\n                %WGET%
        --no-verbose <%= foreman_url(\"finish\") -%> -O C:\\deploy\\foreman-finish.bat\"\n)
        | pause\n\necho Creating a temp staging folder for DISM\nmd c:\\MININT\\Scratch\n\necho
        Creating the Panther directory if needed\nset PantherDirectory=C:\\Windows\\Panther\\\nIF
        not exist %PantherDirectory% (mkdir %PantherDirectory%)\n\necho Finalizing
        installation...\n\necho Downloading custom theme\n%WGET%  -P C:\\Windows\\Web\\
        -r -np -nH --cut-dirs=3 -R index.html -q --level=0 <%= medium_uri %>/theme/\n\necho
        Stage the Unattend.xml file for dism to apply\necho Downloading unattend.xml\n%WGET%
        --no-verbose <%= foreman_url(\"provision\") -%> -O c:\\Windows\\Panther\\unattend.xml\necho
        Apply Unattend.xml\ndism.exe /Image:C:\\ /Apply-Unattend:C:\\Windows\\Panther\\unattend.xml
        /ScratchDir:C:\\MININT\\Scratch/\n\necho copy tools\ncopy x:\\windows\\system32\\wget64.exe
        C:\\deploy\\\ncopy x:\\windows\\system32\\wget64.exe C:\\Windows\\wget.exe\ncopy
        x:\\windows\\system32\\sdelete.exe C:\\Windows\\\nIF not exist C:\\Windows\\Setup\\Scripts
        (md C:\\Windows\\Setup\\Scripts)\necho call C:\\deploy\\foreman-finish.bat
        ^> c:\\foreman.log 2^>^&1 > C:\\Windows\\Setup\\Scripts\\SetupComplete.cmd\n\n<%
        if foreman_url(''user_data'') %>\necho Downloading user data script\n%WGET%
        <%= foreman_url(''user_data'') %> -O c:\\deploy\\user_data.ps1\n<% end -%>\n\necho
        Apply Drivers\ndism.exe /Image:C:\\ /Add-Driver /Driver:C:\\drivers\\ /Recurse
        /ForceUnsigned\n\necho Apply Updates\nfor /f %%u in (''dir /s/b C:\\updates\\*.msu'')
        do dism.exe /Image:C:\\ /Add-Package /PackagePath:%%u /ScratchDir:C:\\MININT\\Scratch/\n\necho
        Setting the boot sector\nbootsect.exe /nt60 C:\nC:\\Windows\\System32\\bcdboot
        C:\\Windows /l en-US\n\necho Tell foreman build has finished\n%WGET% <%= foreman_url(''built'')
        %>\n\nexit 0\n","locked":false,"snippet":false,"description":"The provisioning
        template used for Windows\nYou can create and assign a \"user_data\" ProvisioningTemplate
        as powershell to execute some custom code\nSee https://community.theforeman.org/t/windows-provisioning-made-easy/16756/\nparams:\n-
        wimImageName: Windows 8.1 Pro # name of wim image to apply","created_at":"2024-06-27
        17:28:08 UTC","updated_at":"2024-07-03 14:59:45 UTC","id":73,"name":"Windows
        peSetup.cmd","template_kind_id":9,"template_kind_name":"script","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '5207'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=97
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/69
  response:
    body:
      string: '{"template":"<%#\nkind: provision\nname: XenServer default answerfile\nmodel:
        ProvisioningTemplate\noses:\n- XenServer\ndescription: |\n    The provisioning
        template for the XenServer or Citrix Hypervisor.\n-%>\n<%\n  subnet = @host.subnet\n  dhcp
        = subnet.dhcp_boot_mode?\n  interface_name = @host.primary_interface.identifier.blank?
        ? ''eth0'' : @host.primary_interface.identifier\n-%>\n<?xml version=\"1.0\"?>\n<installation
        mode=\"fresh\" srtype=\"lvm\">\n<%= @host.diskLayout -%>\n  <keymap><%= host_param(''keyboard'')
        || ''us'' %></keymap>\n  <hostname><%= @host.shortname %></hostname>\n  <root-password
        type=\"hash\"><%= root_pass %></root-password>\n  <source type=\"url\"><%=
        @mediapath %></source>\n  <admin-interface name=\"<%= interface_name %>\"
        proto=\"<%= dhcp ? ''dhcp'' : ''static'' %>\">\n<% unless dhcp -%>\n    <ip><%=
        @host.ip %></ip>\n    <subnet-mask><%= subnet.mask %></subnet-mask>\n<% if
        subnet.gateway.present? -%>\n    <gateway><%= subnet.gateway %></gateway>\n<%
        end -%>\n<% end -%>\n  </admin-interface>\n<% subnet.dns_servers.each do |nameserver|
        -%>\n  <name-server><%= nameserver %></name-server>\n<% end -%>\n  <ntp-server><%=
        host_param(''ntp-server'') || ''pool.ntp.org'' %></ntp-server>\n  <timezone><%=
        host_param(''time-zone'') || ''UTC'' %></timezone>\n  <time-config-method>ntp</time-config-method>\n  <script
        stage=\"installation-complete\" type=\"url\">\n    <%= foreman_url(''finish'')
        %>\n  </script>\n</installation>\n","locked":false,"snippet":false,"description":"The
        provisioning template for the XenServer or Citrix Hypervisor.","created_at":"2024-06-27
        17:28:08 UTC","updated_at":"2024-07-03 14:59:45 UTC","id":69,"name":"XenServer
        default answerfile","template_kind_id":7,"template_kind_name":"provision","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '2112'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=96
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/46
  response:
    body:
      string: '{"template":"<%#\nkind: finish\nname: XenServer default finish\nmodel:
        ProvisioningTemplate\noses:\n- XenServer\ndescription: |\n  The finish template
        executed at the end of XenServer provisioning informing Foreman, that provisioning\n  is
        complete. It reboots the machine afterwards. Meant for use with XenServer
        or Citrix Hypervisor\n-%>\n#!/bin/bash\n<%= snippet ''built'' %>\n<%= snippet
        ''schedule_reboot'' -%>\n","locked":false,"snippet":false,"description":"The
        finish template executed at the end of XenServer provisioning informing Foreman,
        that provisioning\nis complete. It reboots the machine afterwards. Meant for
        use with XenServer or Citrix Hypervisor","created_at":"2024-06-27 17:28:08
        UTC","updated_at":"2024-07-03 14:59:45 UTC","id":46,"name":"XenServer default
        finish","template_kind_id":8,"template_kind_name":"finish","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1208'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=95
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/29
  response:
    body:
      string: '{"template":"<%#\nkind: PXELinux\nname: XenServer default PXELinux\nmodel:
        ProvisioningTemplate\noses:\n- XenServer\ndescription: |\n  The template to
        render PXELinux bootloader configuration for XenServer or Citrix Hypervisor.\n  The
        output is deployed on the host''s subnet TFTP proxy.\n-%>\ndefault xenserver\nlabel
        xenserver\nkernel mboot.c32\nappend <%= @xen %> dom0_max_vcpus=1-2 dom0_mem=752M,max:752M
        com1=115200,8n1 console=com1,vga --- <%= @kernel -%> xencons=hvc console=hvc0
        console=tty0 answerfile=<%= foreman_url(''provision'')%> install --- <%= @initrd
        %>\nIPAPPEND 2\n","locked":false,"snippet":false,"description":"The template
        to render PXELinux bootloader configuration for XenServer or Citrix Hypervisor.\nThe
        output is deployed on the host''s subnet TFTP proxy.","created_at":"2024-06-27
        17:28:08 UTC","updated_at":"2024-07-03 14:59:45 UTC","id":29,"name":"XenServer
        default PXELinux","template_kind_id":3,"template_kind_name":"PXELinux","template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1328'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=94
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/provisioning_templates/119
  response:
    body:
      string: '{"template":"<%#\nkind: snippet\nname: yum_proxy\nmodel: ProvisioningTemplate\nsnippet:
        true\ndescription: |\n  Configures HTTP proxy in /etc/yum.conf based on the
        http-proxy and http-proxy-port\n  host parameters.\n-%>\n<%\nproxy_uri = host_param(''http-proxy'')
        ? \"http://#{host_param(''http-proxy'')}:#{host_param(''http-proxy-port'')}\"
        : nil\n-%>\n\n<% if proxy_uri -%>\n  echo ''proxy = <%= proxy_uri %>'' >>
        /etc/yum.conf\n<% end -%>\n","locked":false,"snippet":true,"description":"Configures
        HTTP proxy in /etc/yum.conf based on the http-proxy and http-proxy-port\nhost
        parameters.","created_at":"2024-06-27 17:28:09 UTC","updated_at":"2024-07-03
        14:59:45 UTC","id":119,"name":"yum_proxy","template_kind_id":null,"template_kind_name":null,"template_combinations":[],"operatingsystems":[],"os_default_templates":[],"locations":[{"id":12,"name":"Test
        Location","title":"Test Location","description":null}],"organizations":[{"id":1,"name":"Default
        Organization","title":"Default Organization","description":null},{"id":11,"name":"Test
        Organization","title":"Test Organization","description":"A test organization"}]}'
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '1113'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=93
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
- request:
    body: null
    headers:
      Accept:
      - application/json;version=2
      Accept-Encoding:
      - gzip, deflate
      Connection:
      - keep-alive
      User-Agent:
      - apypie (https://github.com/Apipie/apypie)
    method: GET
    uri: https://foreman.example.org/api/locations?search=title%3D%22Test+Location%22&per_page=4294967296
  response:
    body:
      string: "{\n  \"total\": 2,\n  \"subtotal\": 1,\n  \"page\": 1,\n  \"per_page\":
        4294967296,\n  \"search\": \"title=\\\"Test Location\\\"\",\n  \"sort\": {\n
        \   \"by\": null,\n    \"order\": null\n  },\n  \"results\": [{\"ancestry\":null,\"parent_id\":null,\"parent_name\":null,\"created_at\":\"2024-07-03
        15:23:48 UTC\",\"updated_at\":\"2024-07-03 15:23:48 UTC\",\"id\":12,\"name\":\"Test
        Location\",\"title\":\"Test Location\",\"description\":null}]\n}\n"
    headers:
      Cache-Control:
      - max-age=0, private, must-revalidate
      Connection:
      - Keep-Alive
      Content-Length:
      - '385'
      Content-Security-Policy:
      - 'default-src ''self''; child-src ''self''; connect-src ''self'' ws: wss:;
        img-src ''self'' data:; script-src ''unsafe-eval'' ''unsafe-inline'' ''self'';
        style-src ''unsafe-inline'' ''self'''
      Content-Type:
      - application/json; charset=utf-8
      Foreman_api_version:
      - '2'
      Foreman_current_location:
      - ; ANY
      Foreman_current_organization:
      - ; ANY
      Foreman_version:
      - 3.12.0-develop
      Keep-Alive:
      - timeout=15, max=92
      Strict-Transport-Security:
      - max-age=631139040; includeSubdomains
      X-Content-Type-Options:
      - nosniff
      X-Download-Options:
      - noopen
      X-Frame-Options:
      - sameorigin
      X-Permitted-Cross-Domain-Policies:
      - none
      X-XSS-Protection:
      - 1; mode=block
    status:
      code: 200
      message: OK
version: 1
